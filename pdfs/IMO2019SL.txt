Shortlisted
Problems
(with solutions)

60th International Mathematical Olympiad
Bath — UK, 11th–22nd July 2019

Note of Confidentiality

The Shortlist has to be kept strictly confidential
until the conclusion of the following
International Mathematical Olympiad.
IMO General Regulations §6.6

Contributing Countries
The Organising Committee and the Problem Selection Committee of IMO 2019 thank the
following 58 countries for contributing 204 problem proposals:

Albania, Armenia, Australia, Austria, Belarus, Belgium, Brazil, Bulgaria,
Canada, China, Croatia, Cuba, Cyprus, Czech Republic, Denmark,
Ecuador, El Salvador, Estonia, Finland, France, Georgia, Germany,
Greece, Hong Kong, Hungary, India, Indonesia, Iran, Ireland, Israel,
Italy, Japan, Kazakhstan, Kosovo, Luxembourg, Mexico, Netherlands,
New Zealand, Nicaragua, Nigeria, North Macedonia, Philippines, Poland,
Russia, Serbia, Singapore, Slovakia, Slovenia, South Africa, South Korea,
Sweden, Switzerland, Taiwan, Tanzania, Thailand, Ukraine, USA, Vietnam.
Problem Selection Committee

Tony Gardiner, Edward Crane, Alexander Betts, James Cranch, Joseph Myers (chair),
James Aaronson, Andrew Carlotti, Géza Kós, Ilya I. Bogdanov, Jack Shotton

4

Bath — UK, 11th–22nd July 2019

Problems
Algebra
A1.

Let Z be the set of integers. Determine all functions f : Z Ñ Z such that, for all
integers a and b,
f p2aq ` 2f pbq “ f pf pa ` bqq.
(South Africa)

A2.

Let u1 , u2 , . . . , u2019 be real numbers satisfying
u1 ` u2 ` ¨ ¨ ¨ ` u2019 “ 0 and u21 ` u22 ` ¨ ¨ ¨ ` u22019 “ 1.

Let a “ minpu1 , u2 , . . . , u2019 q and b “ maxpu1 , u2 , . . . , u2019 q. Prove that
ab ď ´

1
.
2019
(Germany)

A3.

Let n ě 3 be a positive integer and let pa1 , a2 , . . . , an q be a strictly increasing
sequence of n positive real numbers with sum equal to 2. Let X be a subset of t1, 2, . . . , nu
such that the value of
ˇ
ˇ
ˇ
ˇ
ÿ
ˇ
ˇ
ai ˇ
ˇ1 ´
ˇ
ˇ
iPX

is minimised. Prove that there exists a strictly increasing sequence of n positive real numbers
pb1 , b2 , . . . , bn q with sum equal to 2 such that
ÿ
bi “ 1.
iPX

(New Zealand)

A4.

Let n ě 2 be a positive integer and a1 , a2 , . . . , an be real numbers such that
a1 ` a2 ` ¨ ¨ ¨ ` an “ 0.

Deﬁne the set A by

ˇ
(
A “ pi, jq ˇ 1 ď i ă j ď n, |ai ´ aj | ě 1 .

Prove that, if A is not empty, then

ÿ

pi,jqPA

ai aj ă 0.

(China)

A5.

Let x1 , x2 , . . . , xn be diﬀerent real numbers. Prove that
#
ÿ ź 1 ´ xi xj
0, if n is even;
“
xi ´ xj
1, if n is odd.
1ďiďn j‰i
(Kazakhstan)

Shortlisted problems

A6.

5

A polynomial P px, y, zq in three variables with real coeﬃcients satisﬁes the identities
P px, y, zq “ P px, y, xy ´ zq “ P px, zx ´ y, zq “ P pyz ´ x, y, zq.

Prove that there exists a polynomial F ptq in one variable such that
P px, y, zq “ F px2 ` y 2 ` z 2 ´ xyzq.
(Russia)

A7.

Let Z be the set of integers. We consider functions f : Z Ñ Z satisfying
`
˘
`
˘
f f px ` yq ` y “ f f pxq ` y

for all integers x and y. For such a function, we say that an integer v is f -rare if the set
Xv “ tx P Z : f pxq “ vu
is ﬁnite and nonempty.
(a) Prove that there exists such a function f for which there is an f -rare integer.
(b) Prove that no such function f can have more than one f -rare integer.
(Netherlands)

6

Bath — UK, 11th–22nd July 2019

Combinatorics
C1.

The inﬁnite sequence a0 , a1 , a2 , . . . of (not necessarily diﬀerent) integers has the
following properties: 0 ď ai ď i for all integers i ě 0, and
ˆ ˙
ˆ ˙ ˆ ˙
k
k
k
“ 2k
` ¨¨¨`
`
ak
a1
a0

for all integers k ě 0.
Prove that all integers N ě 0 occur in the sequence (that is, for all N ě 0, there exists i ě 0
with ai “ N).
(Netherlands)

C2.

You are given a set of n blocks, each weighing at least 1; their total weight is 2n.
Prove that for every real number r with 0 ď r ď 2n ´ 2 you can choose a subset of the blocks
whose total weight is at least r but at most r ` 2.
(Thailand)

C3.

Let n be a positive integer. Harry has n coins lined up on his desk, each showing
heads or tails. He repeatedly does the following operation: if there are k coins showing heads
and k ą 0, then he ﬂips the k th coin over; otherwise he stops the process. (For example, the
process starting with T HT would be T HT Ñ HHT Ñ HT T Ñ T T T , which takes three
steps.)
Letting C denote the initial conﬁguration (a sequence of n H’s and T ’s), write ℓpCq for the
number of steps needed before all coins show T . Show that this number ℓpCq is ﬁnite, and
determine its average value over all 2n possible initial conﬁgurations C.
(USA)

C4.

On a ﬂat plane in Camelot, King Arthur builds a labyrinth L consisting of n walls,
each of which is an inﬁnite straight line. No two walls are parallel, and no three walls have a
common point. Merlin then paints one side of each wall entirely red and the other side entirely
blue.
At the intersection of two walls there are four corners: two diagonally opposite corners
where a red side and a blue side meet, one corner where two red sides meet, and one corner
where two blue sides meet. At each such intersection, there is a two-way door connecting the
two diagonally opposite corners at which sides of diﬀerent colours meet.
After Merlin paints the walls, Morgana then places some knights in the labyrinth. The
knights can walk through doors, but cannot walk through walls.
Let kpLq be the largest number k such that, no matter how Merlin paints the labyrinth L,
Morgana can always place at least k knights such that no two of them can ever meet. For
each n, what are all possible values for kpLq, where L is a labyrinth with n walls?
(Canada)

C5.

On a certain social network, there are 2019 users, some pairs of which are friends,
where friendship is a symmetric relation. Initially, there are 1010 people with 1009 friends each
and 1009 people with 1010 friends each. However, the friendships are rather unstable, so events
of the following kind may happen repeatedly, one at a time:
Let A, B, and C be people such that A is friends with both B and C, but B and C
are not friends; then B and C become friends, but A is no longer friends with them.
Prove that, regardless of the initial friendships, there exists a sequence of such events after
which each user is friends with at most one other user.
(Croatia)

Shortlisted problems

7

C6.

Let n ą 1 be an integer. Suppose we are given 2n points in a plane such that
no three of them are collinear. The points are to be labelled A1 , A2 , . . . , A2n in some order.
We then consider the 2n angles =A1 A2 A3 , =A2 A3 A4 , . . . , =A2n´2 A2n´1 A2n , =A2n´1 A2n A1 ,
=A2n A1 A2 . We measure each angle in the way that gives the smallest positive value (i.e.
between 0˝ and 180˝). Prove that there exists an ordering of the given points such that the
resulting 2n angles can be separated into two groups with the sum of one group of angles equal
to the sum of the other group.
(USA)

C7.

There are 60 empty boxes B1 , . . . , B60 in a row on a table and an unlimited supply
of pebbles. Given a positive integer n, Alice and Bob play the following game.
In the ﬁrst round, Alice takes n pebbles and distributes them into the 60 boxes as she
wishes. Each subsequent round consists of two steps:
(a) Bob chooses an integer k with 1 ď k ď 59 and splits the boxes into the two groups
B1 , . . . , Bk and Bk`1, . . . , B60 .
(b) Alice picks one of these two groups, adds one pebble to each box in that group, and removes
one pebble from each box in the other group.
Bob wins if, at the end of any round, some box contains no pebbles. Find the smallest n
such that Alice can prevent Bob from winning.
(Czech Republic)

C8.

Alice has a map of Wonderland, a country consisting of n ě 2 towns. For every
pair of towns, there is a narrow road going from one town to the other. One day, all the roads
are declared to be “one way” only. Alice has no information on the direction of the roads, but
the King of Hearts has oﬀered to help her. She is allowed to ask him a number of questions.
For each question in turn, Alice chooses a pair of towns and the King of Hearts tells her the
direction of the road connecting those two towns.
Alice wants to know whether there is at least one town in Wonderland with at most one
outgoing road. Prove that she can always ﬁnd out by asking at most 4n questions.
Comment. This problem could be posed with an explicit statement about points being awarded for
weaker bounds cn for some c ą 4, in the style of IMO 2014 Problem 6.

(Thailand)

C9.

For any two diﬀerent real numbers x and y, we deﬁne Dpx, yq to be the unique
integer d satisfying 2d ď |x ´ y| ă 2d`1 . Given a set of reals F , and an element x P F , we say
that the scales of x in F are the values of Dpx, yq for y P F with x ‰ y.
Let k be a given positive integer. Suppose that each member x of F has at most k diﬀerent
scales in F (note that these scales may depend on x). What is the maximum possible size of F ?
(Italy)

8

Bath — UK, 11th–22nd July 2019

Geometry
G1.

Let ABC be a triangle. Circle Γ passes through A, meets segments AB and AC
again at points D and E respectively, and intersects segment BC at F and G such that F lies
between B and G. The tangent to circle BDF at F and the tangent to circle CEG at G meet
at point T . Suppose that points A and T are distinct. Prove that line AT is parallel to BC.
(Nigeria)

G2.

Let ABC be an acute-angled triangle and let D, E, and F be the feet of altitudes
from A, B, and C to sides BC, CA, and AB, respectively. Denote by ωB and ωC the incircles
of triangles BDF and CDE, and let these circles be tangent to segments DF and DE at M
and N, respectively. Let line MN meet circles ωB and ωC again at P ‰ M and Q ‰ N,
respectively. Prove that MP “ NQ.
(Vietnam)

G3.

In triangle ABC, let A1 and B1 be two points on sides BC and AC, and let P and Q
be two points on segments AA1 and BB1 , respectively, so that line P Q is parallel to AB. On
ray P B1 , beyond B1 , let P1 be a point so that =P P1 C “ =BAC. Similarly, on ray QA1 ,
beyond A1 , let Q1 be a point so that =CQ1 Q “ =CBA. Show that points P , Q, P1 , and Q1
are concyclic.
(Ukraine)

G4.

Let P be a point inside triangle ABC. Let AP meet BC at A1 , let BP meet CA
at B1 , and let CP meet AB at C1 . Let A2 be the point such that A1 is the midpoint of P A2 ,
let B2 be the point such that B1 is the midpoint of P B2 , and let C2 be the point such that
C1 is the midpoint of P C2 . Prove that points A2 , B2 , and C2 cannot all lie strictly inside the
circumcircle of triangle ABC.
(Australia)

G5.

Let ABCDE be a convex pentagon with CD “ DE and =EDC ‰ 2 ¨ =ADB.
Suppose that a point P is located in the interior of the pentagon such that AP “ AE and
BP “ BC. Prove that P lies on the diagonal CE if and only if areapBCDq ` areapADEq “
areapABDq ` areapABP q.
(Hungary)

G6.

Let I be the incentre of acute-angled triangle ABC. Let the incircle meet BC, CA,
and AB at D, E, and F , respectively. Let line EF intersect the circumcircle of the triangle
at P and Q, such that F lies between E and P . Prove that =DP A ` =AQD “ =QIP .
(Slovakia)

G7.

The incircle ω of acute-angled scalene triangle ABC has centre I and meets sides BC,
CA, and AB at D, E, and F , respectively. The line through D perpendicular to EF meets ω
again at R. Line AR meets ω again at P . The circumcircles of triangles P CE and P BF meet
again at Q ‰ P . Prove that lines DI and P Q meet on the external bisector of angle BAC.
(India)

G8.

Let L be the set of all lines in the plane and let f be a function that assigns to each
line ℓ P L a point f pℓq on ℓ. Suppose that for any point X, and for any three lines ℓ1 , ℓ2 , ℓ3
passing through X, the points f pℓ1 q, f pℓ2 q, f pℓ3 q and X lie on a circle.
Prove that there is a unique point P such that f pℓq “ P for any line ℓ passing through P .
(Australia)

Shortlisted problems

9

Number Theory
N1.

Find all pairs pm, nq of positive integers satisfying the equation
p2n ´ 1qp2n ´ 2qp2n ´ 4q ¨ ¨ ¨ p2n ´ 2n´1 q “ m!
(El Salvador)

N2.

Find all triples pa, b, cq of positive integers such that a3 ` b3 ` c3 “ pabcq2 .
(Nigeria)

N3.

We say that a set S of integers is rootiful if, for any positive integer n and any
a0 , a1 , . . . , an P S, all integer roots of the polynomial a0 ` a1 x ` ¨ ¨ ¨ ` an xn are also in S. Find
all rootiful sets of integers that contain all numbers of the form 2a ´ 2b for positive integers
a and b.
(Czech Republic)

N4.

Let Zą0 be the set of positive integers. A positive integer constant C is given. Find
all functions f : Zą0 Ñ Zą0 such that, for all positive integers a and b satisfying a ` b ą C,
a ` f pbq | a2 ` b f paq.
(Croatia)
N5. Let a be a positive integer. We say that a positive integer b is a-good if `anb˘ ´ 1 is
divisible by an ` 1 for all positive integers n with an ě b. Suppose b is a positive integer such
that b is a-good, but b ` 2 is not a-good. Prove that b ` 1 is prime.
(Netherlands)
N6. Let H “ Xi?2\ : i P Zą0 ( “ t1, 2, 4, 5, 7, . . .u, and let n be a positive integer. Prove
?
that there exists a constant C such that, if A Ă t1, 2, . . . , nu satisﬁes |A| ě C n, then there
exist a, b P A such that a ´ b P H. (Here Zą0 is the set of positive integers, and tzu denotes the
greatest integer less than or equal to z.)
(Brazil)

N7.

Prove that there is a constant c ą 0 and inﬁnitely many positive integers n with the
following property: there are inﬁnitely many positive integers that cannot be expressed as the
sum of fewer than cn logpnq pairwise coprime nth powers.
(Canada)

N8.

Let a and b be two positive integers. Prove that the integer
R 2V
4a
2
a `
b

is not a square. (Here rzs denotes the least integer greater than or equal to z.)
(Russia)

10

Bath — UK, 11th–22nd July 2019

Solutions
Algebra
A1.

Let Z be the set of integers. Determine all functions f : Z Ñ Z such that, for all
integers a and b,
f p2aq ` 2f pbq “ f pf pa ` bqq.
(1)
(South Africa)

Answer: The solutions are f pnq “ 0 and f pnq “ 2n ` K for any constant K P Z.
Common remarks. Most solutions to this problem ﬁrst prove that f must be linear, before
determining all linear functions satisfying (1).
Solution 1. Substituting a “ 0, b “ n ` 1 gives f pf pn ` 1qq “ f p0q ` 2f pn ` 1q. Substituting
a “ 1, b “ n gives f pf pn ` 1qq “ f p2q ` 2f pnq.
In particular, f p0q ` 2f pn ` 1q “ f p2q ` 2f pnq, and so f pn ` 1q ´ f pnq “ 21 pf p2q ´ f p0qq.
Thus f pn ` 1q ´ f pnq must be constant. Since f is deﬁned only on Z, this tells us that f must
be a linear function; write f pnq “ Mn ` K for arbitrary constants M and K, and we need only
determine which choices of M and K work.
Now, (1) becomes
2Ma ` K ` 2pMb ` Kq “ MpMpa ` bq ` Kq ` K
which we may rearrange to form
`
˘
pM ´ 2q Mpa ` bq ` K “ 0.

Thus, either M “ 2, or Mpa ` bq ` K “ 0 for all values of a ` b. In particular, the only possible
solutions are f pnq “ 0 and f pnq “ 2n ` K for any constant K P Z, and these are easily seen to
work.
Solution 2. Let K “ f p0q.
First, put a “ 0 in (1); this gives
f pf pbqq “ 2f pbq ` K

(2)

for all b P Z.
Now put b “ 0 in (1); this gives
f p2aq ` 2K “ f pf paqq “ 2f paq ` K,
where the second equality follows from (2). Consequently,
f p2aq “ 2f paq ´ K
for all a P Z.
Substituting (2) and (3) into (1), we obtain
f p2aq ` 2f pbq “ f pf pa ` bqq
2f paq ´ K ` 2f pbq “ 2f pa ` bq ` K
f paq ` f pbq “ f pa ` bq ` K.

(3)

Shortlisted problems – solutions

11

Thus, if we set gpnq “ f pnq ´ K we see that g satisﬁes the Cauchy equation gpa ` bq “
gpaq`gpbq. The solution to the Cauchy equation over Z is well-known; indeed, it may be proven
by an easy induction that gpnq “ Mn for each n P Z, where M “ gp1q is a constant.
Therefore, f pnq “ Mn ` K, and we may proceed as in Solution 1.
Comment 1. Instead of deriving (3) by substituting b “ 0 into (1), we could instead have observed
that the right hand side of (1) is symmetric in a and b, and thus
f p2aq ` 2f pbq “ f p2bq ` 2f paq.
Thus, f p2aq ´ 2f paq “ f p2bq ´ 2f pbq for any a, b P Z, and in particular f p2aq ´ 2f paq is constant.
Setting a “ 0 shows that this constant is equal to ´K, and so we obtain (3).
Comment 2. Some solutions initially prove that f pf pnqq is linear (sometimes via proving that
f pf pnqq ´ 3K satisfies the Cauchy equation). However, one can immediately prove that f is linear by
substituting something of the form f pf pnqq “ M 1 n ` K 1 into (2).

12

Bath — UK, 11th–22nd July 2019

A2.

Let u1 , u2 , . . . , u2019 be real numbers satisfying
u1 ` u2 ` ¨ ¨ ¨ ` u2019 “ 0 and u21 ` u22 ` ¨ ¨ ¨ ` u22019 “ 1.

Let a “ minpu1 , u2 , . . . , u2019 q and b “ maxpu1 , u2 , . . . , u2019 q. Prove that
ab ď ´

1
.
2019
(Germany)

Notice ﬁrst that b ą 0 and a ă 0. Indeed, since

Solution 1.

cannot be all zero, and, since

2019
ř
i“1

2019
ř
i“1

u2i “ 1, the variables ui

ui “ 0, the nonzero elements cannot be all positive or all

negative.
Let P “ ti : ui ą 0u and N “ ti : ui ď 0u be the indices of positive and nonpositive elements
in the sequence, and let p “ |P | and n “ |N| be the sizes of these sets; then p ` n “ 2019. By
2019
2019
ř
ř
ř
ř
the condition
ui “ 0 we have 0 “
ui “
ui ´
|ui |, so
i“1

i“1

iPP

ÿ

iPP

ui “

iPN

ÿ

iPN

|ui |.

p1q

After this preparation, estimate the sum of squares of the positive and nonpositive elements
as follows:
ÿ
ÿ
ÿ
ÿ
ÿ
u2i ď
bui “ b ui “ b
|ui | ď b
|a| “ ´nab;
(2)
iPP
ÿ

iPN

iPP

u2i ď

ÿ

iPN

iPP

ÿ iPN
ÿiPN
ÿ
|a| ¨ |ui | “ |a|
|ui | “ |a| ui ď |a| b “ ´pab.
iPN

iPP

(3)

iPP

The sum of these estimates is
1“
´1
that proves ab ď 2019
.

2019
ÿ
i“1

u2i “

Comment 1. After observing

ř

iPP

continuation is

ř

ř
|ab| ě iPP

iPP

ÿ

iPP

u2i `

u2i ď b
u2i
ui

ř

ÿ

iPN

u2i ď ´pp ` nqab “ ´2019ab;

ui and

iPN

iPP

ř

ř
¨ iPN
iPN

ř

u2i

|ui |

ř

“ ´ iPP
ř

u2i ď |a|
u2i

ui

iPP

¯2

ÿ

iPN

ř

iPP

|ui |, instead of p2, 3q an alternative

u2i ě

1 ÿ 2
u
p iPN i

(by the AM-QM or the Cauchy–Schwarz inequality) and similarly |ab| ě n1

ř

iPP

u2i .

Solution 2. As in the previous solution we conclude that a ă 0 and b ą 0.
For every index i, the number ui is a convex combination of a and b, so
ui “ xi a ` yi b with some weights 0 ď xi , yi ď 1, with xi ` yi “ 1.
Let X “

2019
ř
i“1

xi and Y “

2019
ř
i“1

yi . From 0 “

2019
ř
i“1

ui “

|a|X “ bY.

2019
ř
i“1

pxi a ` yi bq “ ´|a|X ` bY , we get
p4q

Shortlisted problems – solutions

From

2019
ř
i“1

13

pxi ` yi q “ 2019 we have
X ` Y “ 2019.

p5q

The system of linear equations p4, 5q has a unique solution:
X“

2019b
,
|a| ` b

Y “

2019|a|
.
|a| ` b

Now apply the following estimate to every u2i in their sum:
u2i “ x2i a2 ` 2xi yi ab ` yi2 b2 ď xi a2 ` yi b2 ;
we obtain that
1“

2019
ÿ
i“1

u2i ď

Hence, ab ď

2019
ÿ
i“1

pxi a2 ` yi b2 q “ Xa2 ` Y b2 “

2019b 2 2019|a| 2
|a| `
b “ 2019|a|b “ ´2019ab.
|a| ` b
|a| ` b

´1
.
2019

Comment
2. The idea behind Solution 2 is the following thought.
ř
ř 2 Suppose we fix a ă 0 and b ą 0,
fix ui “ 0 and vary the ui to achieve the maximum value
of
ui . Considering varying any two of
ř
the ui while preserving their sum: the maximum value of u2i is achieved when those two are as far
apart as possible, so all but at most one of the ui are equal to a or b. Considering a weighted version of
the problem, we see the maximum (with fractional numbers of ui having each value) is achieved when
2019|a|
2019b
of them are a and
are b.
|a| ` b
|a| ` b
In fact, this happens in the solution: the number ui is replaced by xi copies of a and yi copies of b.

14

Bath — UK, 11th–22nd July 2019

A3.

Let n ě 3 be a positive integer and let pa1 , a2 , . . . , an q be a strictly increasing
sequence of n positive real numbers with sum equal to 2. Let X be a subset of t1, 2, . . . , nu
such that the value of
ˇ
ˇ
ˇ
ˇ
ÿ
ˇ
ˇ
ai ˇ
ˇ1 ´
ˇ
ˇ
iPX

is minimised. Prove that there exists a strictly increasing sequence of n positive real numbers
pb1 , b2 , . . . , bn q with sum equal to 2 such that
ÿ
bi “ 1.
iPX

(New Zealand)

Common remarks. In all solutions, we say an index set X is pai q-minimising if it has
the property in the problem for the given sequence pai q. Write X c for the complement of X,
and ra, bs for the interval of integers k such that a ď k ď b. Note that
ˇ
ˇ ˇ
ˇ
ˇ
ÿ ˇˇ
ÿ ˇˇ ˇˇ
ˇ
ai ˇ ,
ai ˇ “ ˇ1 ´
ˇ1 ´
ˇ
ˇ ˇ
ˇ
iPX c
iPX
so we may exchange X and X c where convenient. Let
ÿ
ÿ
ai ´
ai
∆“
iPX c

iPX

ř
and note that X is pai q-minimising if and only if it minimises |∆|, and that iPX ai “ 1 if and
only if ∆ “ 0.
In some solutions, a scaling process is used. If we have a strictly increasing sequence of
positive real numbers ci (typically obtained by perturbing the ai in some way) such that
ÿ
ÿ
ci ,
ci “
iPX

iPX c

řn

then we may put bi “ 2ci { j“1 cj . So it suﬃces to construct such a sequence without needing
its sum to be 2.
The solutions below show various possible approaches to the problem. Solutions 1 and 2
perturb a few of the ai to form the bi (with scaling in the case of Solution 1, without scaling in
the case of Solution 2). Solutions 3 and 4 look at properties of the index set X. Solution 3 then
perturbs many of the ai to form the bi , together with scaling. Rather than using such perturbations, Solution 4 constructs a sequence pbi q directly from the set X with the required properties.
Solution 4 can be used to give a complete description of sets X that are pai q-minimising for
some pai q.
ř
Solution 1. Without loss of generality, assume iPX ai ď 1, and we may assume strict
inequality as otherwise bi “ ai works. Also, X clearly cannotřbe empty.ř
If n P X, add ∆ to an , producing a sequence of ci with iPX ci “ iPX c ci , and then scale
as described above to make the sum equal to 2. Otherwise, there is some k with k P X and
k ` 1 P X c . Let δ “ ak`1 ´ ak .
• If δ ą ∆, add ∆ to ak and then scale.
• If δ ă ∆, then considering X Y tk ` 1u z tku contradicts X being pai q-minimising.
• If δ “ ∆, choose any j ‰ k, k ` 1 (possible since n ě 3), and any ǫ less than the least
of a1 and all the diﬀerences ai`1 ´ ai . If j P X then add ∆ ´ ǫ to ak and ǫ to aj , then
scale; otherwise, add ∆ to ak and ǫ{2 to ak`1 , and subtract ǫ{2 from aj , then scale.

Shortlisted problems – solutions

15

Solution 2. This is similar
ř to Solution 1, but without scaling. As in that solution, without
loss of generality, assume iPX ai ă 1.
Suppose there exists 1 ď j ď n ´ 1 such that j P X but j ` 1 P X c . Then aj`1 ´ aj ě ∆,
because otherwise considering X Y tj ` 1u z tju contradicts X being pai q-minimising.
If aj`1 ´ aj ą ∆, put
$
’
if i “ j;
&aj ` ∆{2,
bi “ aj`1 ´ ∆{2, if i “ j ` 1;
’
%
ai ,
otherwise.

If aj`1 ´ aj “ ∆, choose any ǫ less than the least of ∆{2, a1 and all the diﬀerences ai`1 ´ ai .
If |X| ě 2, choose k P X with k ‰ j, and put
$
’
’aj ` ∆{2 ´ ǫ, if i “ j;
’
&a ´ ∆{2,
if i “ j ` 1;
j`1
bi “
’
ak ` ǫ,
if i “ k;
’
’
%
ai ,
otherwise.
Otherwise, |X c | ě 2, so choose k P X c with k ‰ j ` 1, and put
$
aj ` ∆{2,
if i “ j;
’
’
’
&a ´ ∆{2 ` ǫ, if i “ j ` 1;
j`1
bi “
’
ak ´ ǫ,
if i “ k;
’
’
%
ai ,
otherwise.

If there is no 1 ď j ď n such that j P X but j ` 1 P X c , there must be some 1 ă k ď n
such that X “ rk, ns (certainly X cannot be empty). We must have a1 ą ∆, as otherwise
considering X Y t1u contradicts X being pai q-minimising. Now put
$
’
&a1 ´ ∆{2, if i “ 1;
bi “ an ` ∆{2, if i “ n;
’
%
ai ,
otherwise.

ř
Solution 3. Without loss of generality, assume iPX ai ď 1, so ∆ ě 0. If ∆ “ 0 we can take
bi “ ai , so now assume that ∆ ą 0.
Suppose that there is some k ď n such that |X X rk, ns| ą |X c X rk, ns|. If we choose the
largest such k then |X X rk, ns| ´ |X c X rk, ns| “ 1. We can now ﬁnd the required sequence pbi q
by starting with ci “ ai for i ă k and ci “ ai ` ∆ for i ě k, and then scaling as described
above.
If no such k exists, we will derive a contradiction. For each i P X we can choose i ă ji ď n
in such a way that ji P X c and all the ji are diﬀerent. (For instance, note that necessarily
n P X c and now just work downwards; each time an i P X is considered, let ji be the least
element of X c greater than i and not yet used.) Let Y be the (possibly empty) subset of r1, ns
consisting of those elements in X c that are also not one of the ji . In any case
ÿ
ÿ
∆“
paji ´ ai q `
aj
iPX

jPY

where each term in the sums is positive. Since n ě 3 the total number of terms above is at
least two. Take a least such term and its corresponding index i and consider the set Z which
we form from X by removing i and adding ji (if it is a term of the ﬁrst type) or just by adding j
if it is a term of the second type. The corresponding expression of ∆ for Z has the sign of its
least term changed, meaning that the sum is still nonnegative but strictly less than ∆, which
contradicts X being pai q-minimising.

16

Bath — UK, 11th–22nd July 2019

Solution 4. This uses some similar ideas to Solution 3, but describes properties of the index
sets X that are suﬃcient to describe a corresponding sequence pbi q that is not derived from pai q.
Note that, for two subsets X, Y of r1, ns, the following are equivalent:
• |X X ri, ns| ď |Y X ri, ns| for all 1 ď i ď n;
• Y is at least as large as X, and for all 1 ď j ď |Y |, the j th largest element of Y is at least
as big as the j th largest element of X;
• there is an injective function f : X Ñ Y such that f piq ě i for all i P X.
If these equivalent conditions are satisﬁed, we write X ĺ Y . We write X ă Y if X ĺ Y and
X ‰Y.
ř
ř
Note that if X ă Y , then iPX ai ă iPY ai (the second description above makes this clear).
We claim ﬁrst that, if n ě 3 and X ă X c , then there exists Y with X ă Y ă X c . Indeed,
as |X| ď |X c |, we have |X c | ě 2. Deﬁne Y to consist of the largest element of X c , together
with all but the largest element of X; it is clear both that Y is distinct from X and X c , and
that X ĺ Y ĺ X c , which is what we need.
But, in this situation, we have
¸
˜
ÿ
ÿ
ÿ
ÿ
ÿ
ai ,
ai
and
1´
ai “ ´ 1 ´
ai ă
ai ă
iPX

iPY

iPX c

iPX c

iPX

ř
ř
so |1 ´ iPY ai | ă |1 ´ iPX ai |.
Hence if X is pai q-minimising, we do not have X ă X c , and similarly we do not have
X c ă X.
Considering the ﬁrst description above, this immediately implies the following Claim.

Claim. There exist 1 ď k, ℓ ď n such that |X X rk, ns| ą n´k`1
and |X X rℓ, ns| ă n´ℓ`1
.
2
2
We now construct our sequence pbi q using this claim. Let k and ℓ be the greatest values
satisfying the claim, and without loss of generality suppose k “ n and ℓ ă n (otherwise
replace X by its complement). As ℓ is maximal, n ´ ℓ is even and |X X rℓ, ns| “ n´ℓ
. For
2
suﬃciently small positive ǫ, we take
$
’
&0, if i ă ℓ;
bi “ iǫ ` δ, if ℓ ď i ď n ´ 1;
’
%
γ, if i “ n.
Let M “

ř

and

iPX i. So we require

Mǫ `

ˆ

˙
n´ℓ
´1 δ`γ “1
2

npn ` 1q
ǫ ` pn ´ ℓqδ ` γ “ 2.
2

These give
γ “ 2δ `

ˆ

npn ` 1q
´ 2M
2

˙

ǫ

and for suﬃciently small positive ǫ, solving for γ and δ gives 0 ă δ ă γ (since ǫ “ 0 gives
` 1q and γ “ 2δ), so the sequence is strictly increasing and has positive values.
δ “ 1{p n´ℓ
2

Shortlisted problems – solutions

17

Comment. This solution also shows that the claim gives a complete description of sets X that are
pai q-minimising for some pai q.
Another approach to proving the claim is as follows. We prove the existence of ℓ with the claimed
property; the existence of k follows by considering the complement of X.
P
T
Suppose, for a contradiction, that for all 1 ď ℓ ď n we have |X X rℓ, ns| ě n´ℓ`1
. If we ever
2
have strict inequality, consider the set Y “ tn, n ´ 2, n ´ 4, . . .u. This set may be obtained from X by
possibly removing some elements and reducing the values of others. (To see this, consider the largest
k P X z Y , if any; remove it, and replace it by the greatest j P X c with j ă k, if any. Such steps
preserve the given inequality, and are possible until we reach the set Y .) So if we had strict inequality,
and so X ‰ Y , we have
ÿ
ÿ
ai ą
ai ą 1,
iPX

iPY

contradicting X being pai q-minimising. Otherwise, we always have equality, meaning that X “ Y . But
now consider Z “ Y Y tn ´ 1u z tnu. Since n ě 3, we have
ÿ
ÿ
ÿ
ÿ
ai ą
ai ą
ai “ 2 ´
ai ,
iPY

iPZ

and so Z contradicts X being pai q-minimising.

iPY c

iPY

18

Bath — UK, 11th–22nd July 2019

A4.

Let n ě 2 be a positive integer and a1 , a2 , . . . , an be real numbers such that
a1 ` a2 ` ¨ ¨ ¨ ` an “ 0.

Deﬁne the set A by

ˇ
(
A “ pi, jq ˇ 1 ď i ă j ď n, |ai ´ aj | ě 1 .

Prove that, if A is not empty, then

ÿ

pi,jqPA

ai aj ă 0.

(China)

Solution 1. Deﬁne sets B and C by

ˇ
(
B “ pi, jq ˇ 1 ď i, j ď n, |ai ´ aj | ě 1 ,
ˇ
(
C “ pi, jq ˇ 1 ď i, j ď n, |ai ´ aj | ă 1 .

We have
ÿ

1 ÿ
ai aj
2 pi,jqPB
pi,jqPA
ÿ
ÿ
ÿ
ÿ
ai aj “
ai aj ´
ai aj “ 0 ´
ai aj .
ai aj “

1ďi,jďn

pi,jqPB

pi,jqRB

pi,jqPC

So it suﬃces to show that if A (and hence B) are nonempty, then
ÿ
ai aj ą 0.
pi,jqPC

Partition the indices into sets P , Q, R, and S such that
ˇ
ˇ
(
(
P “ i ˇ ai ď ´1
R “ i ˇ 0 ă ai ă 1
ˇ
ˇ
(
(
Q “ i ˇ ´1 ă ai ď 0
S “ i ˇ 1 ď ai .

Then

ÿ

pi,jqPC

ai aj ě

ÿ

iPP YS

a2i `

ÿ

i,jPQYR

ai aj “

ÿ

iPP YS

a2i `

˜

ÿ

ai

ÿ

ai ,

iPQYR

¸2

ě 0.

The ﬁrst inequality holds because all of the positive terms in the RHS are also in the LHS,
and all of the negative terms in the LHS are also in the RHS. The ﬁrst inequality attains
equality only if both sides have the same negative terms, which implies |ai ´ aj | ă 1 whenever
i, j P Q Y R; the second inequality attains equality only if P “ S “ ∅. But then we would
have A “ ∅. So A nonempty implies that the inequality holds strictly, as required.
Solution 2. Consider P, Q, R, S as in Solution 1, set
ÿ
ÿ
ÿ
p“
ai , q “
ai , r “
ai ,
iPP

and let

t` “

iPQ

ÿ

pi,jqPA, ai aj ě0

ai aj ,

iPR

t´ “

ÿ

s“

iPS

ai aj .

pi,jqPA, ai aj ď0

We know that p ` q ` r ` s “ 0, and we need to prove that t` ` t´ ă 0.
Notice that t` ď p2 {2`pq `rs`s2 {2 (with equality only if p “ s “ 0), and t´ ď pr `ps`qs
(with equality only if there do not exist i P Q and j P R with aj ´ ai ą 1). Therefore,

pp ` q ` r ` sq2 pq ` rq2
pq ` rq2
p2 ` s2
` pq ` rs ` pr ` ps ` qs “
´
“´
ď 0.
2
2
2
2
If A is not empty and p “ s “ 0, then there must exist i P Q, j P R with |ai ´ aj | ą 1, and
hence the earlier equality conditions cannot both occur.
t` ` t´ ď

Shortlisted problems – solutions

19

Comment. The RHS of the original inequality cannot be replaced with any constant c ă 0 (independent of n). Indeed, take
a1 “ ´
Then

ÿ

pi,jqPA

ai aj “ ´

n
1
2
, a2 “ ¨ ¨ ¨ “ an´1 “
, an “
.
n`2
n`2
n`2

2n
, which converges to zero as n Ñ 8.
pn ` 2q2

20

Bath — UK, 11th–22nd July 2019

This page is intentionally left blank

Shortlisted problems – solutions

A5.

21

Let x1 , x2 , . . . , xn be diﬀerent real numbers. Prove that
ÿ ź 1 ´ xi xj

1ďiďn j‰i

xi ´ xj

“

#

0, if n is even;
1, if n is odd.
(Kazakhstan)

Common remarks. Let Gpx1 , x2 , . . . , xn q be the function of the n variables x1 , x2 , . . . , xn on
the LHS of the required identity.
Solution 1 (Lagrange interpolation). Since both sides of the identity are rational functions,
it suﬃces to prove it when all xi R t˘1u. Deﬁne
n
ź
f ptq “
p1 ´ xi tq ,
i“1

and note that
f pxi q “ p1 ´ x2i q

ź
j‰i

1 ´ xi xj .

Using the nodes `1, ´1, x1 , . . . , xn , the Lagrange interpolation formula gives us the following
expression for f :
n
ÿ

i“1

f pxi q

x ` 1 ź x ´ xi
x ´ 1 ź x ´ xi
px ´ 1qpx ` 1q ź x ´ xj
` f p1q
` f p´1q
.
pxi ´ 1qpxi ` 1q j‰i xi ´ xj
1 ` 1 1ďiďn 1 ´ xi
´1 ´ 1 1ďiďn 1 ´ xi

The coeﬃcient of tn`1 in f ptq is 0, since f has degree n. The coeﬃcient of tn`1 in the above
expression of f is
0“

ÿ

1ďiďn

ź
j‰i

f pxi q

` ź

pxi ´ xj q ¨ pxi ´ 1qpxi ` 1q

“ ´Gpx1 , . . . , xn q `

1ďjďn

1 p´1qn`1
`
.
2
2

f p1q

p1 ´ xj q ¨ p1 ` 1q

` ź

f p´1q

p´1 ´ xj q ¨ p´1 ´ 1q

1ďjďn

Comment. The main difficulty is to think of including the two extra nodes ˘1 and evaluating the
coefficient tn`1 in f when n ` 1 is higher than the degree of f .
It is possible to solve the problem using Lagrange interpolation on the nodes x1 , . . . , xn , but the
definition of the polynomial being interpolated should depend on the parity of n. For n even, consider
the polynomial
ź
ź
P pxq “
p1 ´ xxi q ´
px ´ xi q.
i

i

Lagrange interpolation shows that G is the coefficient of xn´1 in the polynomial P pxq{p1 ´ x2 q, i.e. 0.
For n odd, consider the polynomial
P pxq “

ź
ź
p1 ´ xxi q ´ x px ´ xi q.
i

i

Now G is the coefficient of xn´1 in P pxq{p1 ´ x2 q, which is 1.

22

Bath — UK, 11th–22nd July 2019

Solution 2 (using
symmetries). Observe that G is symmetric in the variables x1 , . . . , xn .
ś
Deﬁne V “ iăj pxj ´ xi q and let F “ G ¨ V , which is a polynomial in x1 , . . . , xn . Since
V is alternating, F is also alternating (meaning that, if we exchange any two variables, then
F changes sign). Every alternating polynomial in n variables x1 , . . . , xn vanishes when any two
variables xi , xj (i ‰ j) are equal, and is therefore divisible by xi ´ xj for each pair i ‰ j. Since
these linear factors are pairwise coprime, V divides F exactly as a polynomial. Thus G is in
fact a symmetric polynomial in x1 , . . . , xn .
Now observe that if all xi are nonzero and we set yi “ 1{xi for i “ 1, . . . , n, then we have
1 ´ yi yj
1 ´ xi xj
“
,
yi ´ yj
xi ´ xj
so that

ˆ

1
1
,...,
G
x1
xn

˙

“ Gpx1 , . . . , xn q .

By continuity this is an identity of rational functions. Since G is a polynomial, it implies that
G is constant. (If G were not constant, we could choose a point pc1 , . . . , cn q with all ci ‰ 0,
such that Gpc1 , . . . , cn q ‰ Gp0, . . . , 0q; then gpxq :“ Gpc1 x, . . ˇ. , c´
be a nonconstant
n xq would ¯ˇ
ˇ
y
y ˇ
polynomial in the variable x, so |gpxq| Ñ 8 as x Ñ 8, hence ˇG c1 , . . . , cn ˇ Ñ 8 as y Ñ 0,
which is impossible since G is a polynomial.)
We may identify the constant by substituting xi “ ζ i , where ζ is a primitive nth root of unity
in C. In the ith term in the sum in the original expression we have a factor 1´ζ iζ n´i “ 0, unless
i “ n or 2i
the case where n is odd, the only exceptional
is i “ n, which gives
ś“ n.1´ζIn
ś term1`ζ
j
j
n
the value j‰n 1´ζ j “ 1. When n is even, we also have the term j‰ ´1´ζ j “ p´1qn´1 “ ´1,
2
so the sum is 0.
Comment. If we write out an explicit expression for F ,
F “

ÿ

1ďiďn

p´1qn´i

ź

jăk
j,k‰i

pxk ´ xj q

ź
p1 ´ xi xj q
j‰i

then to prove directly that F vanishes when xi “ xj for some i ‰ j, but no other pair of variables
coincide, we have to check carefully that the two nonzero terms in this sum cancel.
A different and slightly less convenient way to identify the constant is to substitute xi “ 1 ` ǫζ i ,
and throw away terms that are Opǫq as ǫ Ñ 0.

Solution 3 (breaking symmetry). Consider G as a rational function in xn with coeﬃcients
that are rational functions in the other variables. We can write
P pxn q
j‰n pxn ´ xj q

Gpx1 , . . . , xn q “ ś

where P pxn q is a polynomial in xn whose coeﬃcients are rational functions in the other variables.
We then have
¸
˜
¸
˜
¸˜
ź
ÿ
ź
ź 1 ´ xi xj
.
P pxn q “
p1 ´ xn xj q `
pxi xn ´ 1q
pxn ´ xj q
x
´
x
i
j
j‰n
1ďiďn´1
j‰i,n
j‰i,n
For any k ‰ n, substituting xn “ xk (which is valid when manipulating the numerator P pxn q

Shortlisted problems – solutions

23

on its own), we have (noting that xn ´ xj vanishes when j “ k)
˜
¸
˜
¸˜
¸
ź
ÿ
ź
ź 1 ´ xi xj
P pxk q “
p1 ´ xk xj q `
pxi xk ´ 1q
pxk ´ xj q
xi ´ xj
j‰n
1ďiďn´1
j‰i,n
j‰i,n
¸
˜
˜
¸
¸˜
ź
ź 1 ´ xk xj
`
˘ ź
“
p1 ´ xk xj q ` x2k ´ 1
pxk ´ xj q
xk ´ xj
j‰n
j‰k,n
j‰k,n
˜
˜
¸
¸
ź
`
˘ ź
“
p1 ´ xk xj q ` x2k ´ 1
p1 ´ xk xj q
j‰n

j‰k,n

“ 0.

Note that P is a polynomial in xn of degree n ´ 1. For any choice of distinct real numbers
x1 , . . . , xn´1 , P has those real numbers as its roots, and the denominator has the same degree
and the same roots. This shows that G is constant in xn , for any ﬁxed choice of distinct
x1 , . . ., xn´1 . Now, G is symmetric in all n variables, so it must be also be constant in each of
the other variables. G is therefore a constant that depends only on n. The constant may be
identiﬁed as in the previous solution.
Comment. There is also a solution in which we recognise the expression for F in the comment after
Solution 2 as the final column expansion of a certain matrix obtained by modifying the final column
of the Vandermonde matrix. The task is then to show that the matrix can be modified by column
operations either to make the final column identically zero (in the case where n even) or to recover the
Vandermonde matrix (in the case where n odd). The polynomial P {p1 ´ x2 q is helpful for this task,
where P is the parity-dependent polynomial defined in the comment after Solution 1.

24

A6.

Bath — UK, 11th–22nd July 2019

A polynomial P px, y, zq in three variables with real coeﬃcients satisﬁes the identities
P px, y, zq “ P px, y, xy ´ zq “ P px, zx ´ y, zq “ P pyz ´ x, y, zq.

p˚q

Prove that there exists a polynomial F ptq in one variable such that
P px, y, zq “ F px2 ` y 2 ` z 2 ´ xyzq.
(Russia)
Common remarks. The polynomial x2 ` y 2 ` z 2 ´ xyz satisﬁes the condition (˚), so every
polynomial of the form F px2 ` y 2 ` z 2 ´ xyzq does satisfy (˚). We will use without comment the
fact that two polynomials have the same coeﬃcients if and only if they are equal as functions.
Solution 1. In the ﬁrst two steps, we deal with any polynomial P px, y, zq satisfying P px, y, zq “
P px, y, xy ´ zq. Call such a polynomial weakly symmetric, and call a polynomial satisfying the
full conditions in the problem symmetric.
Step 1. We start with the description of weakly symmetric polynomials. We claim that they
are exactly the polynomials in x, y, and zpxy ´ zq. Clearly, all such polynomials are weakly
symmetric. For the converse statement, consider P1 px, y, zq :“ P px, y, z ` 12 xyq, which satisﬁes
P1 px, y, zq “ P1 px, y, ´zq and is therefore a polynomial in x, y, and z 2 . This means that P is a
polynomial in x, y, and pz ´ 21 xyq2 “ ´zpxy ´ zq ` 14 x2 y 2, and therefore a polynomial in x, y,
and zpxy ´ zq.
Step 2. Suppose that P is weakly symmetric. Consider the monomials in P px, y, zq of highest
total degree. Our aim is to show that in each such monomial µxa y b z c we have a, b ě c. Consider
the expansion
ÿ
`
˘k
P px, y, zq “
µijk xi y j zpxy ´ zq .
p1.1q
i,j,k

The maximal total degree of a summand in p1.1q is m “ maxi,j,k : µijk ‰0 pi ` j ` 3kq. Now, for
`
˘k
any i, j, k satisfying i ` j ` 3k “ m the summand µi,j,k xi y j zpxy ´ zq has leading term of
the form µxi`k y j`k z k . No other nonzero summand in p1.1q may have a term of this form in its
expansion, hence this term does not cancel in the whole sum. Therefore, deg P “ m, and the
leading component of P is exactly
ÿ
µi,j,k xi`k y j`k z k ,
i`j`3k“m

and each summand in this sum satisﬁes the condition claimed above.
Step 3. We now prove the problem statement by induction on m “ deg P . For m “ 0 the
claim is trivial. Consider now a symmetric polynomial P with deg P ą 0. By Step 2, each
of its monomials µxa y bz c of the highest total degree satisﬁes a, b ě c. Applying other weak
symmetries, we obtain a, c ě b and b, c ě a; therefore, P has
` a unique leading
˘c monomial of the
form µpxyzqc . The polynomial P0 px, y, zq “ P px, y, zq ´ µ xyz ´ x2 ´ y 2 ´ z 2 has smaller total
degree. Since P0 is symmetric, it is representable as a polynomial function of xyz ´ x2 ´ y 2 ´ z 2 .
Then P is also of this form, completing the inductive step.
Comment. We could alternatively carry out Step 1 by an induction on n “ degz P , in a manner
similar to Step 3. If n “ 0, the statement holds. Assume that n ą 0 and check the leading component
of P with respect to z:
P px, y, zq “ Qn px, yqz n ` Rpx, y, zq ,

Shortlisted problems – solutions

25

where degz R ă n. After the change z ÞÑ xy ´ z, the leading component becomes Qn px, yqp´zqn ; on
the other hand, it should remain the same. Hence n is even. Now consider the polynomial
`
˘n{2
P0 px, y, zq “ P px, y, zq ´ Qn px, yq ¨ zpz ´ xyq
.
It`is also weakly symmetric,
and degz P0 ă n. By the inductive hypothesis, it has the form P0 px, y, zq “
˘
S x, y, zpz ´ xyq . Hence the polynomial
`
˘
`
˘n{2
P px, y, zq “ S x, y, zpxy ´ zq ` Qn px, yq zpz ´ xyq

also has this form. This completes the inductive step.

Solution 2. We will rely on the well-known identity
cos2 u ` cos2 v ` cos2 w ´ 2 cos u cos v cos w ´ 1 “ 0 whenever u ` v ` w “ 0.

p2.1q

Claim 1. The polynomial P px, y, zq is constant on the surface

(
S “ p2 cos u, 2 cos v, 2 cos wq : u ` v ` w “ 0 .

Proof. Notice that for x “ 2 cos u, y “ 2 cos v, z “ 2 cos w, the Vieta jumps x ÞÑ yz ´ x,
y ÞÑ zx´y, z ÞÑ xy´z in p˚q replace pu, v, wq by pv´w, ´v, wq, pu, w´u, ´wq and p´u, v, u´vq,
respectively. For example, for the ﬁrst type of jump we have
yz ´ x “ 4 cos v cos w ´ 2 cos u “ 2 cospv ` wq ` 2 cospv ´ wq ´ 2 cos u “ 2 cospv ´ wq.
Deﬁne Gpu, v, wq “ P p2 cos u, 2 cos v, 2 cos wq. For u ` v ` w “ 0, the jumps give
Gpu, v, wq “ Gpv ´ w, ´v, wq “ Gpw ´ v, ´v, pv ´ wq ´ p´vqq “ Gp´u ´ 2v, ´v, 2v ´ wq
“ Gpu ` 2v, v, w ´ 2vq .
By induction,

`
˘
Gpu, v, wq “ G u ` 2kv, v, w ´ 2kv pk P Zq.

p2.2q

`
˘
Gpu, v, wq “ G u, v ´ 2ℓu, w ` 2ℓu pℓ P Zq.

p2.3q

`
˘
Gpu, v, wq “ G u ` 2pπ, v ` 2qπ, w ´ 2pp ` qqπ pp, q P Zq.

p2.4q

Similarly,
And, of course, we have

Take two nonzero real numbers u, v such that u, v and π are linearly independent over Q. By
combining (2.2–2.4), we can see that G is constant on a dense subset of the plane u ` v ` w “ 0.
By continuity, G is constant on the entire plane and therefore P is constant on S.
l
Claim 2. The polynomial T px, y, zq “ x2 ` y 2 ` z 2 ´ xyz ´ 4 divides P px, y, zq ´ P p2, 2, 2q.
Proof. By dividing P by T with remainders, there exist some polynomials Rpx, y, zq, Apy, zq
and Bpy, zq such that
P px, y, zq ´ P p2, 2, 2q “ T px, y, zq ¨ Rpx, y, zq ` Apy, zqx ` Bpy, zq.

p2.5q

On the surface S the LHS of (2.5) is zero by Claim 1 (since p2, 2, 2q P S) and T “ 0 by (2.1).
Hence, Apy, zqx ` Bpy, zq vanishes on S.
Notice that for every y “ 2 cos v and z “ 2 cos w with π3 ă v, w ă 2π
, there are two
3
distinct values of x such that px, y, zq P S, namely x1 “ 2 cospv ` wq (which is negative), and
x2 “ 2 cospv ´ wq (which is positive). This can happen only if Apy, zq “ Bpy, zq “ 0. Hence,
Apy, zq “ Bpy, zq “ 0 for |y| ă 1, |z| ă 1. The polynomials A and B vanish on an open set, so
A and B are both the zero polynomial.
l

26

Bath — UK, 11th–22nd July 2019

The quotient pP px, y, zq ´ P p2, 2, 2qq{T px, y, zq is a polynomial of lower degree than P and
it also satisﬁes (˚). The problem statement can now be proven by induction on the degree of P .
Comment. In the proof of p2.2q and p2.3q we used two consecutive Vieta jumps; in fact from p˚q we
used only P px, y, xy ´ zq “ P px, zx ´ y, zq “ P pyz ´ x, y, zq.

Solution 3 (using algebraic geometry, just for interest). Let Q “ x2 ` y 2 ` z 2 ´ xyz
and let t P C. Checking where Q ´ t, BQ
, BQ and BQ
vanish simultaneously, we ﬁnd that the
Bx By
Bz
surface Q “ t is smooth except for the cases t “ 0, when the only singular point is p0, 0, 0q,
and t “ 4, when the four points p˘2, ˘2, ˘2q that satisfy xyz “ 8 are the only singular points.
The singular points are the ﬁxed points of the group Γ of polynomial automorphisms of C3
generated by the three Vieta involutions
ι1 : px, y, zq ÞÑ px, y, xy ´ zq,

ι2 : px, y, zq ÞÑ px, xz ´ y, zq,

ι3 : px, y, zq ÞÑ pyz ´ x, y, zq .

Γ acts on each surface Vt : Q ´ t “ 0. If Q ´ t were reducible then the surface Q “ t would
contain a curve of singular points. Therefore Q ´ t is irreducible in Crx, y, zs. (One can also
prove algebraically that Q ´ t is irreducible, for example by checking that its discriminant as a
quadratic polynomial in x is not a square in Cry, zs, and likewise for the other two variables.)
In the following solution we will only use the algebraic surface V0 .
Let U be the Γ-orbit of p3, 3, 3q. Consider ι3 ˝ ι2 , which leaves z invariant. For each ﬁxed
value of z, ι3 ˝ ι2 acts linearly on px, yq by the matrix
ˆ 2
˙
z ´ 1 ´z
Mz :“
.
z
´1
The reverse composition ι2 ˝ι3 acts by Mz´1 “ Mzadj . Note det Mz “ 1 and trMz “ z 2 ´2. When
z does not lie in the real interval r´2, 2s, the eigenvalues of Mz do not have absolute value 1,
so every orbit of the group generated by Mz on C2 z tp0, 0qu is unbounded. For example, ﬁxing
z “ 3 we ﬁnd p3F2k`1 , 3F2k´1 , 3q P U for every k P Z, where pFn qnPZ is the Fibonacci sequence
with F0 “ 0, F1 “ 1.
Now we may start at any point p3F2k`1, 3F2k´1 , 3q and iteratively apply ι1 ˝ ι2 to generate
another inﬁnite sequence of distinct points of U, Zariski dense in the hyperbola cut out of V0 by
the plane x ´ 3F2k`1 “ 0. (The plane x “ a cuts out an irreducible conic when a R t´2, 0, 2u.)
Thus the Zariski closure U of U contains inﬁnitely many distinct algebraic curves in V0 . Since
V0 is an irreducible surface this implies that U “ V0 .
For any polynomial P satisfying (˚), we have P ´ P p3, 3, 3q “ 0 at each point of U. Since
U “ V0 , P ´ P p3, 3, 3q vanishes on V0 . Then Hilbert’s Nullstellensatz and the irreducibility
of Q imply that P ´ P p3, 3, 3q is divisible by Q. Now pP ´ P p3, 3, 3qq{Q is a polynomial also
satisfying (˚), so we may complete the proof by an induction on the total degree, as in the other
solutions.
Comment. We remark that Solution 2 used a trigonometric parametrisation of a real component of
V4 ; in contrast V0 is birationally equivalent to the projective space P2 under the maps
ˆ 2
˙
a ` b2 ` c2 a2 ` b2 ` c2 a2 ` b2 ` c2
px, y, zq Ñ px : y : zq, pa : b : cq Ñ
,
,
.
bc
ac
ab
The set U in Solution 3 is contained in Z3 so it is nowhere dense in V0 in the classical topology.
Comment (background to the problem). A triple pa, b, cq P Z3 is called a Markov triple if
a2 ` b2 ` c2 “ 3abc, and an integer that occurs as a coordinate of some Markov triple is called a
Markov number. (The spelling Markoff is also frequent.) Markov triples arose in A. Markov’s work
in the 1870s on the reduction theory of indefinite binary quadratic forms. For every Markov triple,

Shortlisted problems – solutions

27

p3a, 3b, 3cq lies on Q “ 0. It is well known that all nonzero Markov triples can be generated from
p1, 1, 1q by sequences of Vieta involutions, which are the substitutions described in equation (˚) in the
problem statement. There has been recent work by number theorists about the properties of Markov
numbers (see for example Jean Bourgain, Alex Gamburd and Peter Sarnak, Markoff triples and strong
approximation, Comptes Rendus Math. 345, no. 2, 131–135 (2016), arXiv:1505.06411). Each Markov
number occurs in infinitely many triples, but a famous old open problem is the unicity conjecture,
which asserts that each Markov number occurs in only one Markov triple (up to permutations and sign
changes) as the largest coordinate in absolute value in that triple. It is a standard fact in the modern
literature on Markov numbers that the Markov triples are Zariski dense in the Markov surface. Proving
this is the main work of Solution 3. Algebraic geometry is definitely off-syllabus for the IMO, and one
still has to work a bit to prove the Zariski density. On the other hand the approaches of Solutions
1 and 2 are elementary and only use tools expected to be known by IMO contestants. Therefore we
do not think that the existence of a solution using algebraic geometry necessarily makes this problem
unsuitable for the IMO.

28

Bath — UK, 11th–22nd July 2019

A7.

Let Z be the set of integers. We consider functions f : Z Ñ Z satisfying
`
˘
`
˘
f f px ` yq ` y “ f f pxq ` y

for all integers x and y. For such a function, we say that an integer v is f -rare if the set
Xv “ tx P Z : f pxq “ vu
is ﬁnite and nonempty.
(a) Prove that there exists such a function f for which there is an f -rare integer.
(b) Prove that no such function f can have more than one f -rare integer.
(Netherlands)
Solution 1. a) Let f be the function where f p0q “ 0 and f pxq is the largest power of 2
dividing 2x for x ‰ 0. The integer 0 is evidently f -rare, so it remains to verify the functional
equation.
Since f p2xq “ 2f pxq for all x, it suﬃces to verify the functional equation when at least one
of x and y is odd (the case x “ y “ 0 being trivial). If y is odd, then we have
f pf px ` yq ` yq “ 2 “ f pf pxq ` yq
since all the values attained by f are even. If, on the other hand, x is odd and y is even, then
we already have
f px ` yq “ 2 “ f pxq

from which the functional equation follows immediately.

b) An easy inductive argument (substituting x ` ky for x) shows that
f pf px ` kyq ` yq “ f pf pxq ` yq

(˚)

for all integers x, y and k. If v is an f -rare integer and a is the least element of Xv , then by
substituting y “ a ´ f pxq in the above, we see that
f px ` k ¨ pa ´ f pxqqq ´ f pxq ` a P Xv
for all integers x and k, so that in particular
f px ` k ¨ pa ´ f pxqqq ě f pxq
for all integers x and k, by assumption on a. This says that on the (possibly degenerate)
arithmetic progression through x with common diﬀerence a ´ f pxq, the function f attains its
minimal value at x.
Repeating the same argument with a replaced by the greatest element b of Xv shows that
f px ` k ¨ pb ´ f pxqq ď f pxq
for all integers x and k. Combined with the above inequality, we therefore have
f px ` k ¨ pa ´ f pxqq ¨ pb ´ f pxqqq “ f pxq

(:)

for all integers x and k.
Thus if f pxq ‰ a, b, then the set Xf pxq contains a nondegenerate arithmetic progression, so
is inﬁnite. So the only possible f -rare integers are a and b.
In particular, the f -rare integer v we started with must be one of a or b, so that f pvq “
f paq “ f pbq “ v. This means that there cannot be any other f -rare integers v 1 , as they would
on the one hand have to be either a or b, and on the other would have to satisfy f pv 1 q “ v 1 .
Thus v is the unique f -rare integer.

Shortlisted problems – solutions

29

Comment 1. If f is a solution to the functional equation, then so too is any conjugate of f by a
translation, i.e. any function x ÞÑ f px ` nq ´ n for an integer n. Thus in proving part (b), one is free
to consider only functions f for which 0 is f -rare, as in the following solution.

Solution 2, part (b) only. Suppose v is f -rare, and let a and b be the least and greatest
elements of Xv , respectively. Substituting x “ v and y “ a ´ v into the equation shows that
f pvq ´ v ` a P Xv
and in particular f pvq ě v. Repeating the same argument with x “ v and y “ b ´ v shows that
f pvq ď v, and hence f pvq “ v.
Suppose now that v 1 is a second f -rare integer. We may assume that v “ 0 (see Comment 1).
We’ve seen that f pv 1 q “ v 1 ; we claim that in fact f pkv 1 q “ v 1 for all positive integers k. This
gives a contradiction unless v 1 “ v “ 0.
This claim is proved by induction on k. Supposing it to be true for k, we substitute y “ kv 1
and x “ 0 into the functional equation to yield
f ppk ` 1qv 1 q “ f pf p0q ` kv 1 q “ f pkv 1 q “ v 1
using that f p0q “ 0. This completes the induction, and hence the proof.
Comment 2. There are many functions f satisfying the functional equation for which there is an
f -rare integer. For instance, one may generalise the construction in part (a) of Solution 1 by taking
a sequence 1 “ a0 , a1 , a2 , . . . of positive integers with each ai a proper divisor of ai`1 and choosing
arbitrary functions fi : pZ{ai Zq z t0u Ñ ai Z z t0u from the nonzero residue classes modulo ai to the
nonzero multiples of ai . One then defines a function f : Z Ñ Z by
#
fi`1 px mod ai`1 q, if ai | x but ai`1 ∤ x;
f pxq :“
0,
if x “ 0.
If one writes vpxq for the largest i such that ai | x (with vp0q “ 8), then it is easy to verify the
functional equation for f separately in the two cases vpyq ą vpxq and vpxq ě vpyq. Hence this f
satisfies the functional equation and 0 is an f -rare integer.
Comment 3. In fact, if v is an f -rare integer for an f satisfying the functional equation, then its
fibre Xv “ tvu must be a singleton. We may assume without loss of generality that v “ 0. We’ve
already seen in Solution 1 that 0 is either the greatest or least element of X0 ; replacing f with the
function x ÞÑ ´f p´xq if necessary, we may assume that 0 is the least element of X0 . We write b for
the largest element of X0 , supposing for contradiction that b ą 0, and write N “ p2bq!.
It now follows from (˚) that we have
f pf pN bq ` bq “ f pf p0q ` bq “ f pbq “ 0,
from which we see that f pN bq ` b P X0 Ď r0, bs. It follows that f pN bq P r´b, 0q, since by construction
N b R Xv . Now it follows that pf pN bq ´ 0q ¨ pf pN bq ´ bq is a divisor of N , so from (:) we see that
f pN bq “ f p0q “ 0. This yields the desired contradiction.

30

Bath — UK, 11th–22nd July 2019

Combinatorics
C1.

The inﬁnite sequence a0 , a1 , a2 , . . . of (not necessarily diﬀerent) integers has the
following properties: 0 ď ai ď i for all integers i ě 0, and
ˆ ˙
ˆ ˙ ˆ ˙
k
k
k
“ 2k
` ¨¨¨`
`
ak
a1
a0
for all integers k ě 0.
Prove that all integers N ě 0 occur in the sequence (that is, for all N ě 0, there exists i ě 0
with ai “ N).
(Netherlands)
Solution. We prove by induction on k that every initial segment of the sequence, a0 , a1 , . . . , ak ,
consists of the following elements (counted with multiplicity, and not necessarily in order), for
some ℓ ě 0 with 2ℓ ď k ` 1:
0, 1, . . . , ℓ ´ 1,

0, 1, . . . , k ´ ℓ.

For k “ 0 we have a0 “ 0, which is of this form. Now suppose that for k “ m the elements
a0 , a1 , . . . , am are 0, 0, 1, 1, 2, 2, . . . , ℓ ´ 1, ℓ ´ 1, ℓ, ℓ ` 1, . . . , m ´ ℓ ´ 1, m ´ ℓ for some ℓ with
0 ď 2ℓ ď m ` 1. It is given that
˙
˙ ˆ
˙
ˆ
˙ ˆ
ˆ
m`1
m`1
m`1
m`1
“ 2m`1 ,
`
` ¨¨¨`
`
am`1
am
a1
a0
which becomes
˙˙
˙
ˆ
˙ ˆ
ˆˆ
m`1
m`1
m`1
` ¨¨¨`
`
ℓ´1
1
0
˙
˙˙ ˆ
˙
ˆ
˙ ˆ
ˆˆ
m`1
m`1
m`1
m`1
“ 2m`1 ,
`
` ¨¨¨`
`
`
am`1
m´ℓ
1
0
`
˘ ` m`1 ˘
or, using m`1
“ m`1´i , that
i
ˆˆ

˙˙
˙
ˆ
˙ ˆ
m`1
m`1
m`1
` ¨¨¨`
`
ℓ´1
1
0
˙
˙˙ ˆ
˙
ˆ
˙ ˆ
ˆˆ
m`1
m`1
m`1
m`1
“ 2m`1 .
`
` ¨¨¨`
`
`
am`1
ℓ`1
m
m`1

On the other hand, it is well known that
˙
˙
ˆ
˙ ˆ
ˆ
m`1
m`1
m`1
“ 2m`1 ,
` ¨¨¨`
`
m`1
1
0
and so, by subtracting, we get

˙
m`1
.
“
ℓ
`
˘
From this, using the fact that the binomial coeﬃcients m`1
are increasing for i ď m`1
and
i
2
m`1
decreasing for i ě 2 , we conclude that either am`1 “ ℓ or am`1 “ m ` 1 ´ ℓ. In either case,
a0 , a1 , . . . , am`1 is again of the claimed form, which concludes the induction.
As a result of this description, any integer N ě 0 appears as a term of the sequence ai for
some 0 ď i ď 2N.
ˆ

m`1
am`1

˙

ˆ

Shortlisted problems – solutions

31

C2.

You are given a set of n blocks, each weighing at least 1; their total weight is 2n.
Prove that for every real number r with 0 ď r ď 2n ´ 2 you can choose a subset of the blocks
whose total weight is at least r but at most r ` 2.
(Thailand)
Solution 1. We prove the following more general statement by induction on n.
Claim. Suppose that you have n blocks, each of weight at least 1, and of total weight s ď 2n.
Then for every r with ´2 ď r ď s, you can choose some of the blocks whose total weight is at
least r but at most r ` 2.
Proof. The base case n “ 1 is trivial. To prove the inductive step, let x be the largest
block weight. Clearly, x ě s{n, so s ´ x ď n´1
s ď 2pn ´ 1q. Hence, if we exclude a
n
block of weight x, we can apply the inductive hypothesis to show the claim holds (for this
smaller set) for any ´2 ď r ď s ´ x. Adding the excluded block to each of those combinations, we see that the claim also holds when x ´ 2 ď r ď s. So if x ´ 2 ď s ´ x, then
we have covered the whole interval r´2, ss. But each block weight is at least 1, so we have
x ´ 2 ď ps ´ pn ´ 1qq ´ 2 “ s ´ p2n ´ pn ´ 1qq ď s ´ ps ´ pn ´ 1qq ď s ´ x, as desired.
l
Comment. Instead of inducting on sets of blocks with total weight s ď 2n, we could instead prove the
result only for s “ 2n. We would then need to modify the inductive step to scale up the block weights
before applying the induction hypothesis.

Solution 2. Let x1 , . . . , xn be
ř the weights of the blocks in weakly increasing order. Consider
the set S of sums of the form jPJ xj for a subset J Ď t1, 2, . . . , nu. We want to prove that the
mesh of S – i.e. the largest distance between two adjacentřelements – is at most 2.
For 0 ď k ď n, let Sk denote the set of sums of the form iPJ xi for a subset J Ď t1, 2, . . . , ku.
We will show by induction on k that the mesh of Sk is at most 2.
The base case k “ 0 is trivial (as S0 “ t0u). For k ą 0 we have
Sk “ Sk´1 Y pxk ` Sk´1 q

ř
(where pxk ` Sk´1 q denotes txk ` s : s P Sk´1 u), sořit suﬃces to prove that xk ď jăk xj ` 2.
But if this were not the case, we would have xl ą jăk xj ` 2 ě k ` 1 for all l ě k, and hence
2n “

n
ÿ

j“1

xj ą pn ` 1 ´ kqpk ` 1q ` k ´ 1.

This rearranges to n ą kpn`1´kq, which is false for 1 ď k ď n, giving the desired contradiction.

32

Bath — UK, 11th–22nd July 2019

C3.

Let n be a positive integer. Harry has n coins lined up on his desk, each showing
heads or tails. He repeatedly does the following operation: if there are k coins showing heads
and k ą 0, then he ﬂips the k th coin over; otherwise he stops the process. (For example, the
process starting with T HT would be T HT Ñ HHT Ñ HT T Ñ T T T , which takes three
steps.)
Letting C denote the initial conﬁguration (a sequence of n H’s and T ’s), write ℓpCq for the
number of steps needed before all coins show T . Show that this number ℓpCq is ﬁnite, and
determine its average value over all 2n possible initial conﬁgurations C.
(USA)
Answer: The average is 41 npn ` 1q.
Common remarks. Throughout all these solutions, we let Epnq denote the desired average
value.
Solution 1. We represent the problem using a directed graph Gn whose vertices are the
length-n strings of H’s and T ’s. The graph features an edge from each string to its successor
(except for T T ¨ ¨ ¨ T T , which has no successor). We will also write H̄ “ T and T̄ “ H.
The graph G0 consists of a single vertex: the empty string. The main claim is that Gn can
be described explicitly in terms of Gn´1 :
• We take two copies, X and Y , of Gn´1 .
• In X, we take each string of n ´ 1 coins and just append a T to it. In symbols, we replace
s1 ¨ ¨ ¨ sn´1 with s1 ¨ ¨ ¨ sn´1 T .
• In Y , we take each string of n ´ 1 coins, ﬂip every coin, reverse the order, and append
an H to it. In symbols, we replace s1 ¨ ¨ ¨ sn´1 with s̄n´1 s̄n´2 ¨ ¨ ¨ s̄1 H.
• Finally, we add one new edge from Y to X, namely HH ¨ ¨ ¨ HHH Ñ HH ¨ ¨ ¨ HHT .
We depict G4 below, in a way which indicates this recursive construction:

Y

X

HHT H

HT HH

T HT H

T T HH

HHHH

HT T H

TTTH

T HHH

HT T T

T HT T

HT HT

T HHT

TTTT

HHT T

HHHT

T T HT

We prove the claim inductively. Firstly, X is correct as a subgraph of Gn , as the operation on
coins is unchanged by an extra T at the end: if s1 ¨ ¨ ¨ sn´1 is sent to t1 ¨ ¨ ¨ tn´1 , then s1 ¨ ¨ ¨ sn´1 T
is sent to t1 ¨ ¨ ¨ tn´1 T .
Next, Y is also correct as a subgraph of Gn , as if s1 ¨ ¨ ¨ sn´1 has k occurrences of H, then
s̄n´1 ¨ ¨ ¨ s̄1 H has pn ´ 1 ´ kq ` 1 “ n ´ k occurrences of H, and thus (provided that k ą 0), if
s1 ¨ ¨ ¨ sn´1 is sent to t1 ¨ ¨ ¨ tn´1 , then s̄n´1 ¨ ¨ ¨ s̄1 H is sent to t̄n´1 ¨ ¨ ¨ t̄1 H.
Finally, the one edge from Y to X is correct, as the operation does send HH ¨ ¨ ¨ HHH to
HH ¨ ¨ ¨ HHT .

Shortlisted problems – solutions

33

To ﬁnish, note that the sequences in X take an average of Epn ´ 1q steps to terminate,
whereas the sequences in Y take an average of Epn ´ 1q steps to reach HH ¨ ¨ ¨ H and then an
additional n steps to terminate. Therefore, we have
Epnq “

n
1
pEpn ´ 1q ` pEpn ´ 1q ` nqq “ Epn ´ 1q ` .
2
2

We have Ep0q “ 0 from our description of G0 . Thus, by induction, we have Epnq “ 12 p1 ` ¨ ¨ ¨ `
nq “ 41 npn ` 1q, which in particular is ﬁnite.
Solution 2. We consider what happens with conﬁgurations depending on the coins they start
and end with.
• If a conﬁguration starts with H, the last n ´ 1 coins follow the given rules, as if they were
all the coins, until they are all T , then the ﬁrst coin is turned over.
• If a conﬁguration ends with T , the last coin will never be turned over, and the ﬁrst
n ´ 1 coins follow the given rules, as if they were all the coins.
• If a conﬁguration starts with T and ends with H, the middle n ´ 2 coins follow the given
rules, as if they were all the coins, until they are all T . After that, there are 2n ´ 1 more
steps: ﬁrst coins 1, 2, . . . , n ´ 1 are turned over in that order, then coins n, n ´ 1, . . . , 1
are turned over in that order.
As this covers all conﬁgurations, and the number of steps is clearly ﬁnite for 0 or 1 coins, it
follows by induction on n that the number of steps is always ﬁnite.
We deﬁne EAB pnq, where A and B are each one of H, T or ˚, to be the average number of
steps over conﬁgurations of length n restricted to those that start with A, if A is not ˚, and
that end with B, if B is not ˚ (so ˚ represents “either H or T ”). The above observations tell us
that, for n ě 2:
• EH˚ pnq “ Epn ´ 1q ` 1.
• E˚T pnq “ Epn ´ 1q.
• EHT pnq “ Epn ´ 2q ` 1 (by using both the observations for H˚ and for ˚T ).
• ET H pnq “ Epn ´ 2q ` 2n ´ 1.
Now EH˚ pnq “ 21 pEHH pnq ` EHT pnqq, so EHH pnq “ 2Epn ´ 1q ´ Epn ´ 2q ` 1. Similarly,
ET T pnq “ 2Epn ´ 1q ´ Epn ´ 2q ´ 1. So
n
1
Epnq “ pEHT pnq ` EHH pnq ` ET T pnq ` ET H pnqq “ Epn ´ 1q ` .
4
2
We have Ep0q “ 0 and Ep1q “ 21 , so by induction on n we have Epnq “ 14 npn ` 1q.
Solution 3. Let Hi be the number of heads in positions 1 to i inclusive (so Hn is the total
number of heads), and let Ii be 1 if the ith coin is a head, 0 otherwise. Consider the function
tpiq “ Ii ` 2pminti, Hn u ´ Hi q.
We claim that tpiq is the total number of times coin i is turned over (which implies that the
process terminates). Certainly tpiq “ 0 when all coins are tails, and tpiq is always a nonnegative
integer, so it suﬃces to show that when the k th coin is turned over (where k “ Hn ), tpkq goes
down by 1 and all the other tpiq are unchanged. We show this by splitting into cases:

34

Bath — UK, 11th–22nd July 2019
• If i ă k, Ii and Hi are unchanged, and minti, Hn u “ i both before and after the coin ﬂip,
so tpiq is unchanged.
• If i ą k, minti, Hn u “ Hn both before and after the coin ﬂip, and both Hn and Hi change
by the same amount, so tpiq is unchanged.
• If i “ k and the coin is heads, Ii goes down by 1, as do both minti, Hn u “ Hn and Hi ; so
tpiq goes down by 1.
• If i “ k and the coin is tails, Ii goes up by 1, minti, Hn u “ i is unchanged and Hi goes
up by 1; so tpiq goes down by 1.
We now need to compute the average value of
n
ÿ

i“1

tpiq “

n
ÿ

i“1

Ii ` 2

n
ÿ

i“1

minti, Hn u ´ 2

n
ÿ

Hi .

i“1

The average value of the ﬁrst term is 21 n, and that of the third term is ´ 21 npn ` 1q. To compute
the second term, we sum over choices for the total number of heads, and then over the possible
values of i, getting
ˆ ˙˙
n ˆ ˙ÿ
n
n ˆ ˙ˆ
ÿ
ÿ
j
n
n
1´n
1´n
.
nj ´
2
minti, ju “ 2
2
j i“1
j
j“0
j“0
Now, in terms of trinomial coeﬃcients,
˙
ˆ ˙ ÿ
n´1
n ˆ
n
ÿ ˆn ´ 1˙
ÿ
n
n
“ 2n´1 n
“n
“
j
j
n ´ j, j ´ 1, 1
j
j“0
j“1
j“0
and

n ˆ ˙ˆ ˙
ÿ
n
j

j“0

2

j

“

So the second term above is
2

n ˆ
ÿ

j“2

1´n

ˆ

2

n
n ´ j, j ´ 2, 2

n´1 2

n ´2

n´2

˙

ˆ ˙
ˆ ˙ n´2
˙
ˆ
n ÿ n´2
n´2 n
.
“
“2
2
2 j“0
j

ˆ ˙˙
npn ´ 1q
n
“ n2 ´
,
2
4

and the required average is
1
npn ´ 1q 1
npn ` 1q
Epnq “ n ` n2 ´
´ npn ` 1q “
.
2
4
2
4
Solution 4. Harry has built a Turing machine to ﬂip the coins for him. The machine is
initially positioned at the k th coin, where there are k heads (and the position before the ﬁrst
coin is considered to be the 0th coin). The machine then moves according to the following rules,
stopping when it reaches the position before the ﬁrst coin: if the coin at its current position
is H, it ﬂips the coin and moves to the previous coin, while if the coin at its current position
is T , it ﬂips the coin and moves to the next position.
Consider the maximal sequences of consecutive moves in the same direction. Suppose the
machine has a consecutive moves to the next coin, before a move to the previous coin. After
those a moves, the a coins ﬂipped in those moves are all heads, as is the coin the machine
is now at, so at least the next a ` 1 moves will all be moves to the previous coin. Similarly,
a consecutive moves to the previous coin are followed by at least a ` 1 consecutive moves to

Shortlisted problems – solutions

35

the next coin. There cannot be more than n consecutive moves in the same direction, so this
proves that the process terminates (with a move from the ﬁrst coin to the position before the
ﬁrst coin).
Thus we have a (possibly empty) sequence a1 ă ¨ ¨ ¨ ă at ď n giving the lengths of maximal
sequences of consecutive moves in the same direction, where the ﬁnal at moves must be moves
to the previous coin, ending before the ﬁrst coin. We claim there is a bijection between initial
conﬁgurations of the coins and such sequences. This gives
npn ` 1q
1
Epnq “ p1 ` 2 ` ¨ ¨ ¨ ` nq “
2
4
as required, since each i with 1 ď i ď n will appear in half of the sequences, and will contribute i
to the number of moves when it does.
To see the bijection, consider following the sequence of moves backwards, starting with the
machine just before the ﬁrst coin and all coins showing tails. This certainly determines a unique
conﬁguration of coins that could possibly correspond to the given sequence. Furthermore, every
coin ﬂipped as part of the aj consecutive moves is also ﬂipped as part of all subsequent sequences
of ak consecutive moves, for all k ą j, meaning that, as we follow the moves backwards, each
coin is always in the correct state when ﬂipped to result in a move in the required direction.
(Alternatively, since there are 2n possible conﬁgurations of coins and 2n possible such ascending
sequences, the fact that the sequence of moves determines at most one conﬁguration of coins,
and thus that there is an injection from conﬁgurations of coins to such ascending sequences, is
suﬃcient for it to be a bijection, without needing to show that coins are in the right state as
we move backwards.)
Solution 5. We explicitly describe what happens with an arbitrary sequence C of n coins.
Suppose that C contain k heads at positions 1 ď c1 ă c2 ă ¨ ¨ ¨ ă ck ď n.
Let i be the minimal index such that ci ě k. Then the ﬁrst few steps will consist of turning
over the k th , pk ` 1qth , . . . , ci th , pci ´ 1qth , pci ´ 2qth , . . . , k th coins in this order. After that we
get a conﬁguration with k ´ 1 heads at the same positions as in the initial one, except for ci .
This part of the process takes 2pci ´ kq ` 1 steps.
After that, the process acts similarly; by induction on the number of heads we deduce that
the process ends. Moreover, if the ci disappear in order ci1 , . . . , cik , the whole process takes
ℓpCq “

k
ÿ
`

j“1

k
k
k
ÿ
ÿ
ÿ
˘
2pcij ´ pk ` 1 ´ jqq ` 1 “ 2
cj ´ 2 pk ` 1 ´ jq ` k “ 2
cj ´ k 2
j“1

j“1

j“1

steps.
` ˘
Now let us ﬁnd the total value Sk of ℓpCq over all nk conﬁgurations with exactly k heads.
To sum `up the
˘ above expression over those, notice that each number 1 ď i ď n appears as cj
exactly n´1
times. Thus
k´1
˙ n
ˆ
ˆ ˙
pn ´ 1q ¨ ¨ ¨ pn ´ k ` 1q npn ` 1q n ¨ ¨ ¨ pn ´ k ` 1q 2
n´1 ÿ
n 2
Sk “ 2
k “2
i´
¨
´
k
k ´ 1 i“1
k
pk ´ 1q!
2
k!
˙
˙
ˆ
ˆ
˘
n´1
n´2
npn ´ 1q ¨ ¨ ¨ pn ´ k ` 1q `
.
`n
pn ` 1q ´ k “ npn ´ 1q
“
pk ´ 1q!
k´1
k´1

Therefore, the total value of ℓpCq over all conﬁgurations is
˙
˙
n ˆ
n ˆ
n
ÿ
ÿ
ÿ
npn ` 1q
n´1
n´2
“ npn ´ 1q2n´2 ` n2n´1 “ 2n
`n
Sk “ npn ´ 1q
.
k´1
k´1
4
k“1
k“1
k“1
Hence the required average is Epnq “ npn`1q
.
4

36

Bath — UK, 11th–22nd July 2019

C4.

On a ﬂat plane in Camelot, King Arthur builds a labyrinth L consisting of n walls,
each of which is an inﬁnite straight line. No two walls are parallel, and no three walls have a
common point. Merlin then paints one side of each wall entirely red and the other side entirely
blue.
At the intersection of two walls there are four corners: two diagonally opposite corners
where a red side and a blue side meet, one corner where two red sides meet, and one corner
where two blue sides meet. At each such intersection, there is a two-way door connecting the
two diagonally opposite corners at which sides of diﬀerent colours meet.
After Merlin paints the walls, Morgana then places some knights in the labyrinth. The
knights can walk through doors, but cannot walk through walls.
Let kpLq be the largest number k such that, no matter how Merlin paints the labyrinth L,
Morgana can always place at least k knights such that no two of them can ever meet. For
each n, what are all possible values for kpLq, where L is a labyrinth with n walls?
(Canada)
Answer: The only possible value of k is k “ n ` 1, no matter what shape the labyrinth is.
` ˘
Solution 1. First we show by induction that the n walls divide the plane into n`1
`1 regions.
2
The claim is true for n “ 0 as, when there are no walls, the plane forms a single region. When
placing the nth wall, it intersects each of the n´ 1 other walls exactly once and hence splits each
of n of the ``
regions
those
˘
˘formed by
`n`1
˘ other walls into two regions. By the induction hypothesis,
n
this yields 2 ` 1 ` n “ 2 ` 1 regions, proving the claim.
` ˘
Now let G be the graph with vertices given by the n`1
` 1 regions, and with two regions
2
connected by an edge if there is a door between them.
We now show that no matter how Merlin paints the n walls, Morgana
` ˘ can place at least
n ` 1 knights. No matter how the walls are painted, there are exactly n2 intersection points,
each of which corresponds to a single edge in G. Consider adding the edges of G sequentially and
note that each edge reduces the number of connected
` components
˘
`n˘ by at most one. Therefore
the number of connected components of G is at least n`1
`
1
´
“ n ` 1. If Morgana places
2
2
a knight in regions corresponding to diﬀerent connected components of G, then no two knights
can ever meet.
Now we give a construction showing that, no matter what shape the labyrinth is, Merlin
can colour it such that there are exactly n ` 1 connected components, allowing Morgana to
place at most n ` 1 knights.
First, we choose a coordinate system on the labyrinth so that none of the walls run due
north-south, or due east-west. We then have Merlin paint the west face of each wall red, and
the east face of each wall blue. We label the regions according to how many walls the region is
on the east side of: the labels are integers between 0 and n.
We claim that, for each i, the regions labelled i are connected by doors. First, we note that
for each i with 0 ď i ď n there is a unique region labelled i which is unbounded to the north.
Now, consider a knight placed in some region with label i, and ask them to walk north
(moving east or west by following the walls on the northern sides of regions, as needed). This
knight will never get stuck: each region is convex, and so, if it is bounded to the north, it has
a single northernmost vertex with a door northwards to another region with label i.
Eventually it will reach a region which is unbounded to the north, which will be the unique
such region with label i. Hence every region with label i is connected to this particular region,
and so all regions with label i are connected to each other.
As a result, there are exactly n ` 1 connected components, and Morgana can place at most
n ` 1 knights.

Shortlisted problems – solutions

37

Comment. Variations on this argument exist: some of them capture more information, and some of
them capture less information, about the connected components according to this system of numbering.
For example, it can be shown that the unbounded regions are numbered 0, 1, . . . , n´1, n, n´1, . . . , 1
as one cycles around them, that the regions labelled 0 and n are the only regions in their connected
components, and that each other connected component forms a single chain running between the two
unbounded ones. It is also possible to argue that the regions are acyclic without revealing much about
their structure.

Solution 2. We give another description of a strategy for Merlin to paint the walls so that
Morgana can place no more than n ` 1 knights.
Merlin starts by building a labyrinth of n walls of his own design. He places walls in turn
with increasing positive gradients, placing each so far to the right that all intersection points
of previously-placed lines lie to the left of it. He paints each in such a way that blue is on the
left and red is on the right.
For example, here is a possible sequence of four such lines ℓ1 , ℓ2 , ℓ3 , ℓ4 :
ℓ4
ℓ3
ℓ2
ℓ1

red

blue

We say that a region is “on the right” if it has x-coordinate unbounded above (note that if
we only have one wall, then both regions are on the right). We claim inductively that, after
placing n lines, there are n ` 1 connected components in the resulting labyrinth, each of which
contains exactly one region on the right. This is certainly true after placing 0 lines, as then
there is only one region (and hence one connected component) and it is on the right.
When placing the nth line, it then cuts every one of the n ´ 1 previously placed lines, and
since it is to the right of all intersection points, the regions it cuts are exactly the n regions on
the right.

2

1
blue
red
blue
red
blue
red

3

2
4

3
4

5

The addition of this line leaves all previous connected components with exactly one region on
the right, and creates a new connected component containing exactly one region, and that
region is also on the right. As a result, by induction, this particular labyrinth will have n ` 1
connected components.
Having built this labyrinth, Merlin then moves the walls one-by-one (by a sequence of
continuous translations and rotations of lines) into the proper position of the given labyrinth,
in such a way that no two lines ever become parallel.

38

Bath — UK, 11th–22nd July 2019

blu
e
red

The only time the conﬁguration is changed is when one wall is moved through an intersection
point of two others:

3

red
blue

1

3
2

4
3

1

2

4
3

2

blue
red

3

red
blue

blu
e
red

blue
red

2

2

Note that all moves really do switch between two conﬁgurations like this: all sets of three lines
have this colour conﬁguration initially, and the rules on rotations mean they are preserved (in
particular, we cannot create three lines creating a triangle with three red edges inwards, or
three blue edges inwards).
However, as can be seen, such a move preserves the number of connected components, so in
the painting this provides for Arthur’s actual labyrinth, Morgana can still only place at most
n ` 1 knights.
Comment. While these constructions are superficially distinct, they in fact result in the same colourings for any particular labyrinth. In fact, using the methods of Solution 2, it is possible to show that
these are the only colourings that result in exactly n ` 1 connected components.

Shortlisted problems – solutions

39

C5.

On a certain social network, there are 2019 users, some pairs of which are friends,
where friendship is a symmetric relation. Initially, there are 1010 people with 1009 friends each
and 1009 people with 1010 friends each. However, the friendships are rather unstable, so events
of the following kind may happen repeatedly, one at a time:
Let A, B, and C be people such that A is friends with both B and C, but B and C
are not friends; then B and C become friends, but A is no longer friends with them.
Prove that, regardless of the initial friendships, there exists a sequence of such events after
which each user is friends with at most one other user.
(Croatia)
Common remarks. The problem has an obvious rephrasing in terms of graph theory. One
is given a graph G with 2019 vertices, 1010 of which have degree 1009 and 1009 of which have
degree 1010. One is allowed to perform operations on G of the following kind:
Suppose that vertex A is adjacent to two distinct vertices B and C which are not
adjacent to each other. Then one may remove the edges AB and AC from G and
add the edge BC into G.
Call such an operation a refriending. One wants to prove that, via a sequence of such refriendings, one can reach a graph which is a disjoint union of single edges and vertices.
All of the solutions presented below will use this reformulation.
Solution 1. Note that the given graph is connected, since the total degree of any two vertices
is at least 2018 and hence they are either adjacent or have at least one neighbour in common.
Hence the given graph satisﬁes the following condition:
Every connected component of G with at least three vertices is not complete
and has a vertex of odd degree.

(1)

We will show that if a graph G satisﬁes condition (1) and has a vertex of degree at least 2, then
there is a refriending on G that preserves condition (1). Since refriendings decrease the total
number of edges of G, by using a sequence of such refriendings, we must reach a graph G with
maximal degree at most 1, so we are done.

A

40

Bath — UK, 11th–22nd July 2019

Pick a vertex A of degree at least 2 in a connected component G1 of G. Since no component
of G with at least three vertices is complete we may assume that not all of the neighbours
of A are adjacent to one another. (For example, pick a maximal complete subgraph K of G1 .
Some vertex A of K has a neighbour outside K, and this neighbour is not adjacent to every
vertex of K by maximality.) Removing A from G splits G1 into smaller connected components
G1 , . . . , Gk (possibly with k “ 1), to each of which A is connected by at least one edge. We
divide into several cases.
Case 1: k ě 2 and A is connected to some Gi by at least two edges.
Choose a vertex B of Gi adjacent to A, and a vertex C in another component Gj adjacent
to A. The vertices B and C are not adjacent, and hence removing edges AB and AC and
adding in edge BC does not disconnect G1 . It is easy to see that this preserves the condition,
since the refriending does not change the parity of the degrees of vertices.
Case 2: k ě 2 and A is connected to each Gi by exactly one edge.
Consider the induced subgraph on any Gi and the vertex A. The vertex A has degree 1 in
this subgraph; since the number of odd-degree vertices of a graph is always even, we see that
Gi has a vertex of odd degree (in G). Thus if we let B and C be any distinct neighbours of A,
then removing edges AB and AC and adding in edge BC preserves the above condition: the
refriending creates two new components, and if either of these components has at least three
vertices, then it cannot be complete and must contain a vertex of odd degree (since each Gi
does).
Case 3: k “ 1 and A is connected to G1 by at least three edges.
By assumption, A has two neighbours B and C which are not adjacent to one another.
Removing edges AB and AC and adding in edge BC does not disconnect G1 . We are then done
as in Case 1.
Case 4: k “ 1 and A is connected to G1 by exactly two edges.
Let B and C be the two neighbours of A, which are not adjacent. Removing edges AB
and AC and adding in edge BC results in two new components: one consisting of a single
vertex; and the other containing a vertex of odd degree. We are done unless this second
component would be a complete graph on at least 3 vertices. But in this case, G1 would be a
complete graph minus the single edge BC, and hence has at least 4 vertices since G1 is not a
4-cycle. If we let D be a third vertex of G1 , then removing edges BA and BD and adding in
edge AD does not disconnect G1 . We are then done as in Case 1.
A
B

C

D

Comment. In fact, condition 1 above precisely characterises those graphs which can be reduced to a
graph of maximal degree ď 1 by a sequence of refriendings.

Shortlisted problems – solutions

41

Solution 2. As in the previous solution, note that a refriending preserves the property that a
graph has a vertex of odd degree and (trivially) the property that it is not complete; note also
that our initial graph is connected. We describe an algorithm to reduce our initial graph to a
graph of maximal degree at most 1, proceeding in two steps.
Step 1: There exists a sequence of refriendings reducing the graph to a tree.
Proof. Since the number of edges decreases with each refriending, it suﬃces to prove the following: as long as the graph contains a cycle, there exists a refriending such that the resulting
graph is still connected. We will show that the graph in fact contains a cycle Z and vertices
A, B, C such that A and B are adjacent in the cycle Z, C is not in Z, and is adjacent to A but
not B. Removing edges AB and AC and adding in edge BC keeps the graph connected, so we
are done.
B

C

A

To ﬁnd this cycle Z and vertices A, B, C, we pursue one of two strategies. If the graph
contains a triangle, we consider a largest complete subgraph K, which thus contains at least
three vertices. Since the graph itself is not complete, there is a vertex C not in K connected
to a vertex A of K. By maximality of K, there is a vertex B of K not connected to C, and
hence we are done by choosing a cycle Z in K through the edge AB.
B

C

A

If the graph is triangle-free, we consider instead a smallest cycle Z. This cycle cannot
be Hamiltonian (i.e. it cannot pass through every vertex of the graph), since otherwise by
minimality the graph would then have no other edges, and hence would have even degree at
every vertex. We may thus choose a vertex C not in Z adjacent to a vertex A of Z. Since the
graph is triangle-free, it is not adjacent to any neighbour B of A in Z, and we are done.
l
Step 2: Any tree may be reduced to a disjoint union of single edges and vertices by a sequence
of refriendings.
Proof. The refriending preserves the property of being acyclic. Hence, after applying a sequence
of refriendings, we arrive at an acyclic graph in which it is impossible to perform any further
refriendings. The maximal degree of any such graph is 1: if it had a vertex A with two
neighbours B, C, then B and C would necessarily be nonadjacent since the graph is cycle-free,
and so a refriending would be possible. Thus we reach a graph with maximal degree at most 1
as desired.
l

42

Bath — UK, 11th–22nd July 2019

C6.

Let n ą 1 be an integer. Suppose we are given 2n points in a plane such that
no three of them are collinear. The points are to be labelled A1 , A2 , . . . , A2n in some order.
We then consider the 2n angles =A1 A2 A3 , =A2 A3 A4 , . . . , =A2n´2 A2n´1 A2n , =A2n´1 A2n A1 ,
=A2n A1 A2 . We measure each angle in the way that gives the smallest positive value (i.e.
between 0˝ and 180˝). Prove that there exists an ordering of the given points such that the
resulting 2n angles can be separated into two groups with the sum of one group of angles equal
to the sum of the other group.
(USA)
Comment. The first three solutions all use the same construction involving a line separating the
points into groups of n points each, but give different proofs that this construction works. Although
Solution 1 is very short, the Problem Selection Committee does not believe any of the solutions is easy
to find and thus rates this as a problem of medium difficulty.

Solution 1. Let ℓ be a line separating the points into two groups (L and R) with n points in
each. Label the points A1 , A2 , . . . , A2n so that L “ tA1 , A3 , . . . , A2n´1 u. We claim that this
labelling works.
Take a line s “ A2n A1 .
(a) Rotate s around A1 until it passes through A2 ; the rotation is performed in a direction
such that s is never parallel to ℓ.
(b) Then rotate the new s around A2 until it passes through A3 in a similar manner.
(c) Perform 2n ´ 2 more such steps, after which s returns to its initial position.
The total (directed) rotation angle Θ of s is clearly a multiple of 180˝ . On the other hand,
s was never parallel to ℓ, which is possible only if Θ “ 0. Now it remains to partition all the
2n angles into those where s is rotated anticlockwise, and the others.
Solution 2. When tracing a cyclic path through the Ai in order, with straight line segments
between consecutive points, let θi be the exterior angle at Ai , with a sign convention
that it
ř2n
is positive if the path turns left and negative if the path turns right. Then i“1 θi “ 360k ˝
for some integer k. Let φi “ =Ai´1 Ai Ai`1 (indices mod 2n), deﬁned as in the problem; thus
φi “ 180˝ ´ |θi |.
Let L be the set of ř
i for which
R be the set for which it
ř the path turns left at Ai and let
˝
turns right. Then S “ iPL φi ´ iPR φi “ p180p|L| ´ |R|q ´ 360kq , which is a multiple of 360˝
since the number of points is even. We will show that the points can be labelled such that
S “ 0, in which case L and R satisfy the required condition of the problem.
Note that the value of S is deﬁned for a slightly larger class of conﬁgurations: it is OK
for two points to coincide, as long as they are not consecutive, and OK for three points to be
collinear, as long as Ai , Ai`1 and Ai`2 do not appear on a line in that order. In what follows
it will be convenient, although not strictly necessary, to consider such conﬁgurations.
Consider how S changes if a single one of the Ai is moved along some straight-line path
(not passing through any Aj and not lying on any line Aj Ak , but possibly crossing such lines).
Because S is a multiple of 360˝ , and the angles change continuously, S can only change when a
point moves between R and L. Furthermore, if φj “ 0 when Aj moves between R and L, S is
unchanged; it only changes if φj “ 180˝ when Aj moves between those sets.
For any starting choice of points, we will now construct a new conﬁguration, with labels such
that S “ 0, that can be perturbed into the original one without any φi passing through 180˝ ,
so that S “ 0 for the original conﬁguration with those labels as well.
Take some line such that there are n points on each side of that line. The new conﬁguration
has n copies of a single point on each side of the line, and a path that alternates between

Shortlisted problems – solutions

43

sides of the line; all angles are 0, so this conﬁguration has S “ 0. Perturbing the points into
their original positions, while keeping each point on its side of the line, no angle φi can pass
through 180˝, because no straight line can go from one side of the line to the other and back.
So the perturbation process leaves S “ 0.
Comment. More complicated variants of this solution are also possible; for example, a path defined
using four quadrants of the plane rather than just two half-planes.

Solution 3. First, let ℓ be a line in the plane such that there are n points on one side and the
other n points on the other side. For convenience, assume ℓ is horizontal (otherwise, we can
rotate the plane). Then we can use the terms “above”, “below”, “left” and “right” in the usual
way. We denote the n points above the line in an arbitrary order as P1 , P2 , . . . , Pn , and the
n points below the line as Q1 , Q2 , . . ., Qn .
If we connect Pi and Qj with a line segment, the line segment will intersect with the line ℓ.
Denote the intersection as Iij . If Pi is connected to Qj and Qk , where j ă k, then Iij and Iik
are two diﬀerent points, because Pi , Qj and Qk are not collinear.
Now we deﬁne a “sign” for each angle =Qj Pi Qk . Assume j ă k. We specify that the sign is
positive for the following two cases:
• if i is odd and Iij is to the left of Iik ,
• if i is even and Iij is to the right of Iik .
Otherwise the sign of the angle is negative. If j ą k, then the sign of =Qj Pi Qk is taken to be
the same as for =Qk Pi Qj .
Similarly, we can deﬁne the sign of =Pj Qi Pk with j ă k (or equivalently =Pk Qi Pj ). For
example, it is positive when i is odd and Iji is to the left of Iki .
Henceforth, whenever we use the notation =Qj Pi Qk or =Pj Qi Pk for a numerical quantity,
it is understood to denote either the (geometric) measure of the angle or the negative of this
measure, depending on the sign as speciﬁed above.
We now have the following important fact for signed angle measures:
=Qi1 Pk Qi3 “ =Qi1 Pk Qi2 ` =Qi2 Pk Qi3

p1q

for all points Pk , Qi1 , Qi2 and Qi3 with i1 ă i2 ă i3 . The following ﬁgure shows a “natural”
arrangement of the points. Equation (1) still holds for any other arrangement, as can be easily
veriﬁed.
Pk

Qi1

Qi2

Qi3

Similarly, we have
=Pi1 Qk Pi3 “ =Pi1 Qk Pi2 ` =Pi2 Qk Pi3 ,
for all points Qk , Pi1 , Pi2 and Pi3 , with i1 ă i2 ă i3 .

p2q

44

Bath — UK, 11th–22nd July 2019
We are now ready to specify the desired ordering A1 , . . . , A2n of the points:
• if i ď n is odd, put Ai “ Pi and A2n`1´i “ Qi ;
• if i ď n is even, put Ai “ Qi and A2n`1´i “ Pi .

For example, for n “ 3 this ordering is P1 , Q2 , P3 , Q3 , P2 , Q1 . This sequence alternates between
P ’s and Q’s, so the above conventions specify a sign for each of the angles Ai´1 Ai Ai`1 . We
claim that the sum of these 2n signed angles equals 0. If we can show this, it would complete
the proof.
We prove the claim by induction. For brevity, we use the notation =Pi to denote whichever
of the 2n angles has its vertex at Pi , and =Qi similarly.
First let n “ 2. If the four points can be arranged to form a convex quadrilateral, then the
four line segments P1 Q1 , P1 Q2 , P2 Q1 and P2 Q2 constitute a self-intersecting quadrilateral. We
use several ﬁgures to illustrate the possible cases.
The following ﬁgure is one possible arrangement of the points.
P1
P2

I11

I21

I12

I22

Q1

Q2

Then =P1 and =Q1 are positive, =P2 and =Q2 are negative, and we have
|=P1 | ` |=Q1 | “ |=P2 | ` |=Q2 |.
With signed measures, we have
=P1 ` =Q1 ` =P2 ` =Q2 “ 0.

p3q

If we switch the labels of P1 and P2 , we have the following picture:
P2
P1

I21

Q1

I11

I22

I12

Q2

Switching labels P1 and P2 has the eﬀect of ﬂipping the sign of all four angles (as well as swapping the magnitudes on the relabelled points); that is, the new values of p=P1 , =P2 , =Q1 , =Q2 q
equal the old values of p´=P2 , ´=P1 , ´=Q1 , ´=Q2 q. Consequently, equation (3) still holds.
Similarly, when switching the labels of Q1 and Q2 , or both the P ’s and the Q’s, equation (3)
still holds.

Shortlisted problems – solutions

45

The remaining subcase of n “ 2 is that one point lies inside the triangle formed by the other
three. We have the following picture.
P1

P2
I11

I12
I21

I22

Q1

Q2

We have
|=P1 | ` |=Q1 | ` |=Q2 | “ |=P2 |.
and equation (3) holds.
Again, switching the labels for P ’s or the Q’s will not aﬀect the validity of equation (3).
Also, if the point lying inside the triangle of the other three is one of the Q’s rather than
the P ’s, the result still holds, since our sign convention is preserved when we relabel Q’s as P ’s
and vice-versa and reﬂect across ℓ.
We have completed the proof of the claim for n “ 2.
Assume the claim holds for n “ k, and we wish to prove it for n “ k ` 1. Suppose we are
given our 2pk ` 1q points. First ignore Pk`1 and Qk`1 , and form 2k angles from P1 , . . . , Pk ,
Q1 , . . ., Qk as in the n “ k case. By the induction hypothesis we have
k
ÿ

p=Pi ` =Qi q “ 0.

i“1

When we add in the two points Pk`1 and Qk`1 , this changes our angles as follows:
• the angle at Pk changes from =Qk´1 Pk Qk to =Qk´1 Pk Qk`1 ;
• the angle at Qk changes from =Pk´1 Qk Pk to =Pk´1 Qk Pk`1 ;
• two new angles =Qk Pk`1Qk`1 and =Pk Qk`1 Pk`1 are added.
We need to prove the changes have no impact on the total sum. In other words, we need to
prove
p=Qk´1 Pk Qk`1 ´ =Qk´1 Pk Qk q ` p=Pk´1 Qk Pk`1 ´ =Pk´1 Qk Pk q ` p=Pk`1 ` =Qk`1 q “ 0. p4q
In fact, from equations (1) and (2), we have
=Qk´1 Pk Qk`1 ´ =Qk´1 Pk Qk “ =Qk Pk Qk`1 ,
and
=Pk´1 Qk Pk`1 ´ =Pk´1 Qk Pk “ =Pk Qk Pk`1.
Therefore, the left hand side of equation (4) becomes =Qk Pk Qk`1 `=Pk Qk Pk`1 `=Qk Pk`1 Qk`1 `
=Pk Qk`1 Pk`1, which equals 0, simply by applying the n “ 2 case of the claim. This completes
the induction.

46

Bath — UK, 11th–22nd July 2019

Solution 4. We shall think instead of the problem as asking us to assign a weight ˘1 to each
angle, such that the weighted sum of all the angles is zero.
Given an ordering A1 , . . . , A2n of the points, we shall assign weights according to the following recipe: walk in order from point to point, and assign the left turns `1 and the right
turns ´1. This is the same weighting as in Solution 3, and as in that solution, the weighted
sum is a multiple of 360˝ .
We now aim to show the following:
Lemma. Transposing any two consecutive points in the ordering changes the weighted sum by
˘360˝ or 0.
Knowing that, we can conclude quickly: if the ordering A1 , . . . , A2n has weighted angle
sum 360k ˝ , then the ordering A2n , . . . , A1 has weighted angle sum ´360k ˝ (since the angles
are the same, but left turns and right turns are exchanged). We can reverse the ordering of A1 ,
. . . , A2n by a sequence of transpositions of consecutive points, and in doing so the weighted
angle sum must become zero somewhere along the way.
We now prove that lemma:
Proof. Transposing two points amounts to taking a section Ak Ak`1 Ak`2 Ak`3 as depicted, reversing the central line segment Ak`1 Ak`2 , and replacing its two neighbours with the dotted
lines.
Ak`1

Ak`3

Ak`1

Ak`2
Ak

Ak`3

Ak`2
Ak

Figure 1: Transposing two consecutive vertices: before (left) and afterwards (right)
In each triangle, we alter the sum by ˘180˝. Indeed, using (anticlockwise) directed angles
modulo 360˝ , we either add or subtract all three angles of each triangle.
Hence both triangles together alter the sum by ˘180 ˘ 180˝ , which is ˘360˝ or 0.
l

Shortlisted problems – solutions

47

C7.

There are 60 empty boxes B1 , . . . , B60 in a row on a table and an unlimited supply
of pebbles. Given a positive integer n, Alice and Bob play the following game.
In the ﬁrst round, Alice takes n pebbles and distributes them into the 60 boxes as she
wishes. Each subsequent round consists of two steps:
(a) Bob chooses an integer k with 1 ď k ď 59 and splits the boxes into the two groups
B1 , . . . , Bk and Bk`1, . . . , B60 .
(b) Alice picks one of these two groups, adds one pebble to each box in that group, and removes
one pebble from each box in the other group.
Bob wins if, at the end of any round, some box contains no pebbles. Find the smallest n
such that Alice can prevent Bob from winning.
(Czech Republic)
Answer: n “ 960. In general, if there are N ą 1 boxes, the answer is n “

XN

`1
2

\ PN

T
`
1
´ 1.
2

Common
X N remarks.
\ PN
T We present solutions for the general case of N ą 1 boxes, and write
M “ 2 ` 1 2 ` 1 ´ 1 for the claimed answer. For 1 ď k ă N, say that Bob makes a
k-move if he splits the boxes into a left group tB1 , . . . , Bk u and a right group tBk`1 , . . . , BN u.
Say that one conﬁguration dominates another if it has at least as many pebbles in each box,
and say that it strictly dominates the other conﬁguration if it also has more pebbles in at least
one box. (Thus, if Bob wins in some conﬁguration, he also wins in every conﬁguration that it
dominates.)
It is often convenient to consider ‘V-shaped’ conﬁgurations; for 1 ď i ď N, let Vi be the
conﬁguration where Bj contains 1 ` |j ´ i| pebbles (i.e. where the ith box has a single pebble
and the numbers increase by one in both directions, so the ﬁrst box has i pebbles and the last
box has N ` 1 P´ iT pebbles). Note that Vi contains 21 ipi ` 1q ` 21 pN ` 1 ´ iqpN ` 2 ´ iq ´ 1
pebbles. If i “ N2 , this number equals M.
Solutions split naturally into a strategy for Alice (starting with M pebbles and showing she
can prevent Bob from winning) and a strategy for Bob (showing he can win for any starting
conﬁguration with at most M ´ 1 pebbles). The following observation is also useful to simplify
the analysis of strategies for Bob.
Observation A. Consider two consecutive rounds. Suppose that in the ﬁrst round Bob made
a k-move and Alice picked the left group, and then in the second round Bob makes an ℓ-move,
with ℓ ą k. We may then assume, without loss of generality, that Alice again picks the left
group.

Proof. Suppose Alice picks the right group in the second round. Then the combined eﬀect of
the two rounds is that each of the boxes Bk`1 , . . . , Bℓ lost two pebbles (and the other boxes
are unchanged). Hence this conﬁguration is strictly dominated by that before the ﬁrst round,
and it suﬃces to consider only Alice’s other response.
l
Solution 1 (Alice). Alice initially distributes pebbles according to Vr N s . Suppose the current
2
conﬁguration of pebbles dominates Vi . If Bob makes a k-move with k ě i then Alice picks the
left group, which results in a conﬁguration that dominates Vi`1 . Likewise, if Bob makes a
k-move with k ă i then Alice picks the right group, which results in a conﬁguration that
dominates Vi´1 . Since none of V1 , . . . , VN contains an empty box, Alice can prevent Bob from
ever winning.

48

Bath — UK, 11th–22nd July 2019

Solution 1 (Bob). The key idea in this solution is the following claim.
Claim. If there exist a positive integer k such that there are at least 2k boxes that have at
most k pebbles each then Bob can force a win.
Proof. We ignore the other boxes. First, Bob makes a k-move (splits the 2k boxes into two
groups of k boxes each). Without loss of generality, Alice picks the left group. Then Bob makes
a pk ` 1q-move, . . . , a p2k ´ 1q-move. By Observation A, we may suppose Alice always picks
the left group. After Bob’s p2k ´ 1q-move, the rightmost box becomes empty and Bob wins.
l
Now, we claim that if n ă M then either there already exists an empty box, or there exist
a positive integer k and 2k boxes with at most k pebbles each (and thus Bob can Xforce
\ a win).
N
Otherwise, assume each box contains at least 1 pebble, and for each 1 ď k ď 2 , at least
N ´ p2k ´ 1q “ N ` 1 ´ 2k boxes contain at least k ` 1 pebbles. Summing, there are at least
as many pebbles in total as in Vr N s ; that is, at least M pebbles, as desired.
2

\
Solution 2 (Alice). Let K “ 2 ` 1 . Alice starts with the boxes in the conﬁguration VK .
For each of Bob’s N ´ 1 possible choices, consider the subset of rounds in which he makes that
choice. In that subset of rounds, Alice alternates between picking the left group and picking the
right group; the ﬁrst time Bob makes that choice, Alice picks the group containing the K th box.
Thus, at any time during the game, the number of pebbles in each box depends only on which
choices Bob has made an odd number of times. This means that the number of pebbles in a
box could decrease by at most the number of choices for which Alice would have started by
removing a pebble from the group containing that box. These numbers are, for each box,
XN \ XN
\
P
T
, 2 ´ 1 , . . . , 1, 0, 1, . . . , N2 ´ 1 .
2
XN

These are pointwise less than the numbers of pebbles the boxes started with, meaning that no
box ever becomes empty with this strategy.
\
X
Solution 2 (Bob). Let K “ N2 ` 1 . For Bob’s strategy, we consider a conﬁguration X with
at most M ´ 1 pebbles, and we make use of Observation A. Consider two conﬁgurations with
M pebbles: VK and VN `1´K (if n is odd, they are the same conﬁguration; if n is even, one is
the reverse of the other). The conﬁguration X has fewer pebbles than VK in at least one box,
and fewer pebbles than VN `1´K in at least one box.
Suppose ﬁrst that, with respect to one of those conﬁgurations (without loss of
VK ),
P generality
T
X has fewer pebbles in one of the boxes in the half where they have 1, 2, . . . , N2 pebbles (the
right half in VK if N is even; if N is odd, we can take it to be the right half, without loss of
generality, as the conﬁguration is symmetric). Note that the number cannot be fewer in the
box with 1 pebble in VK , because then it would have 0 pebbles. Bob then does a K-move.
If Alice picks the right group, the total number of pebbles goes down and we restart Bob’s
strategy with a smaller number of pebbles. If Alice picks the left group, Bob follows with a
pK ` 1q-move, a pK ` 2q-move, and so on; by Observation A we may assume Alice always picks
the left group. But whichever box in the right half had fewer pebbles in X than in VK ends up
with 0 pebbles at some point in this sequence of moves.
Otherwise, N is even, and for both of those conﬁgurations, there are fewer pebbles in X
only on the 2, 3, . . . , N2 ` 1 side. That is, the numbers of pebbles in X are at least
N N
, ´ 1, . . . , 1, 1, . . . , N2
2 2

pCq

with equality occurring at least once on each side. Bob does an N2 -move. Whichever group
Alice chooses, the total number of pebbles is unchanged, and the side from which pebbles are
removed now has a box with fewer pebbles than in (C), so the previous case of Bob’s strategy
can now be applied.

Shortlisted problems – solutions

49

Solution 3 (Bob). For any conﬁguration C, deﬁne LpCq to be the greatest integer such that,
for all 0 ď i ď N ´ 1, the box Bi`1 contains at least LpCq ´ i pebbles. Similarly, deﬁne RpCq
to be greatest integer such that, for all 0 ď i ď N ´ 1, the box BN ´i contains at least
RpCq ´ i pebbles. (Thus, C dominates the ‘left half’ of VLpCq and the ‘right half’ of VN `1´RpCq .)
Then C dominates a ‘V-shaped’ conﬁguration if and only if LpCq ` RpCq ě N ` 1. Note that
if C dominates a V-shaped conﬁguration, it has at least M pebbles.
Now suppose that there are fewer than M pebbles, so we have LpCq ` RpCq ď N. Then
Bob makes an LpCq-move (or more generally any move with at least LpCq boxes on the left and
RpCq boxes on the right). Let C 1 be the new conﬁguration, and suppose that no box becomes
empty (otherwise Bob has won). If Alice picks the left group, we have LpC 1 q “ LpCq ` 1 and
RpC 1 q “ RpCq ´ 1. Otherwise, we have LpC 1 q “ LpCq ´ 1 and RpC 1 q “ RpCq ` 1. In either
case, we have LpC 1 q ` RpC 1 q ď N.
Bob then repeats this strategy, until one of the boxes becomes empty. Since the condition
in Observation A holds, we may assume that Alice picks a group on the same side each time.
Then one of L and R is strictly decreasing; without loss of generality assume that L strictly
decreases. At some point we reach L “ 1. If B2 is still nonempty, then B1 must contain a
single pebble. Bob makes a 1-move, and by Observation A, Alice must (eventually) pick the
right group, making this box empty.

50

Bath — UK, 11th–22nd July 2019

C8.

Alice has a map of Wonderland, a country consisting of n ě 2 towns. For every
pair of towns, there is a narrow road going from one town to the other. One day, all the roads
are declared to be “one way” only. Alice has no information on the direction of the roads, but
the King of Hearts has oﬀered to help her. She is allowed to ask him a number of questions.
For each question in turn, Alice chooses a pair of towns and the King of Hearts tells her the
direction of the road connecting those two towns.
Alice wants to know whether there is at least one town in Wonderland with at most one
outgoing road. Prove that she can always ﬁnd out by asking at most 4n questions.
Comment. This problem could be posed with an explicit statement about points being awarded for
weaker bounds cn for some c ą 4, in the style of IMO 2014 Problem 6.

(Thailand)

Solution. We will show Alice needs to ask at most 4n ´ 7 questions. Her strategy has the
following phases. In what follows, S is the set of towns that Alice, so far, does not know to
have more than one outgoing road (so initially |S| “ n).
Phase 1. Alice chooses any two towns, say A and B. Without loss of generality, suppose
that the King of Hearts’ answer is that the road goes from A to B.
At the end of this phase, Alice has asked 1 question.
Phase 2. During this phase there is a single (variable) town T that is known to have at
least one incoming road but not yet known to have any outgoing roads. Initially, T is B. Alice
does the following n ´ 2 times: she picks a town X she has not asked about before, and asks
the direction of the road between T and X. If it is from X to T , T is unchanged; if it is
from T to X, X becomes the new choice of town T , as the previous T is now known to have
an outgoing road.
At the end of this phase, Alice has asked a total of n ´ 1 questions. The ﬁnal town T is not
yet known to have any outgoing roads, while every other town has exactly one outgoing road
known. The undirected graph of roads whose directions are known is a tree.
Phase 3. During this phase, Alice asks about the directions of all roads between T and
another town she has not previously asked about, stopping if she ﬁnds two outgoing roads
from T . This phase involves at most n ´ 2 questions. If she does not ﬁnd two outgoing roads
from T , she has answered her original question with at most 2n ´ 3 ď 4n ´ 7 questions, so in
what follows we suppose that she does ﬁnd two outgoing roads, asking a total of k questions in
this phase, where 2 ď k ď n ´ 2 (and thus n ě 4 for what follows).
For every question where the road goes towards T , the town at the other end is removed
from S (as it already had one outgoing road known), while the last question resulted in T being
removed from S. So at the end of this phase, |S| “ n ´ k ` 1, while a total of n ` k ´ 1 questions
have been asked. Furthermore, the undirected graph of roads within S whose directions are
known contains no cycles (as T is no longer a member of S, all questions asked in this phase
involved T and the graph was a tree before this phase started). Every town in S has exactly
one outgoing road known (not necessarily to another town in S).
Phase 4. During this phase, Alice repeatedly picks any pair of towns in S for which she
does not know the direction of the road between them. Because every town in S has exactly
one outgoing road known, this always results in the removal of one of those two towns from S.
Because there are no cycles in the graph of roads of known direction within S, this can continue
until there are at most 2 towns left in S.
If it ends with t towns left, n ´ k ` 1 ´ t questions were asked in this phase, so a total of
2n ´ t questions have been asked.
Phase 5. During this phase, Alice asks about all the roads from the remaining towns
in S that she has not previously asked about. She has deﬁnitely already asked about any road
between those towns (if t “ 2). She must also have asked in one of the ﬁrst two phases about

Shortlisted problems – solutions

51

at least one other road involving one of those towns (as those phases resulted in a tree with
n ą 2 vertices). So she asks at most tpn ´ tq ´ 1 questions in this phase.
At the end of this phase, Alice knows whether any town has at most one outgoing road.
If t “ 1, at most 3n ´ 3 ď 4n ´ 7 questions were needed in total, while if t “ 2, at most
4n ´ 7 questions were needed in total.
Comment 1. The version of this problem originally submitted asked only for an upper bound
of 5n, which is much simpler to prove. The Problem Selection Committee preferred a version with an
asymptotically optimal constant. In the following comment, we will show that the constant is optimal.
Comment 2. We will show that Alice cannot always find out by asking at most 4n ´ 3plog2 nq ´
15 questions, if n ě 8.
To show this, we suppose the King of Hearts is choosing the directions as he goes along, only
picking the direction of a road when Alice asks about it for the first time. We provide a strategy for
the King of Hearts that ensures that, after the given number of questions, the map is still consistent
both with the existence of a town with at most one outgoing road, and with the nonexistence of such
a town. His strategy has the following phases. When describing how the King of Hearts’ answer to
a question is determined below, we always assume he is being asked about a road for the first time
(otherwise, he just repeats his previous answer for that road). This strategy is described throughout
in graph-theoretic terms (vertices and edges rather than towns and roads).
Phase 1. In this phase, we consider the undirected graph formed by edges whose directions are
known. The phase terminates when there are exactly 8 connected components whose undirected graphs
are trees. The following invariant is maintained: in a component with k vertices whose undirected graph
is a tree, every vertex has at most tlog2 ku edges into it.
• If the King of Hearts is asked about an edge between two vertices in the same component, or
about an edge between two components at least one of which is not a tree, he chooses any
direction for that edge arbitrarily.
• If he is asked about an edge between a vertex in component A that has a vertices and is a tree
and a vertex in component B that has b vertices and is a tree, suppose without loss of generality
that a ě b. He then chooses the edge to go from A to B. In this case, the new number of edges
into any vertex is at most maxttlog2 au, tlog2 bu ` 1u ď tlog2 pa ` bqu.
In all cases, the invariant is preserved, and the number of tree components either remains unchanged
or goes down by 1. Assuming Alice does not repeat questions, the process must eventually terminate
with 8 tree components, and at least n ´ 8 questions having been asked.
Note that each tree component contains at least one vertex with no outgoing edges. Colour one
such vertex in each tree component red.
Phase 2. Let V1 , V2 and V3 be the
of the red vertices whose components are smallest
(so\their
\
X
X three
components together have at most 38 n vertices, with each component having at most 38 n ´ 2 vertices). Let sets C1 , C2 , . . . be the connected components after removing the Vj . By construction,
there are no edges with known direction between Ci and Cj for i ‰ j, and there are at least five such
components.
If at any point during this phase, the King of Hearts is asked about an edge within one of the Ci ,
he chooses an arbitrary direction. If he is asked about an edge between Ci and Cj for i ‰ j, he answers
so that all edges go from Ci to Ci`1 and Ci`2 , with indices taken modulo the number of components,
and chooses arbitrarily for other pairs. This ensures that all vertices other than the Vj will have more
than one outgoing edge.
For edges involving one of the Vj he answers as follows, so as to remain consistent for as long
as possible with both possibilities for whether one of those vertices has at most one outgoing edge.
Note that as they were red vertices, they have no outgoing edges at the start of this phase. For edges
between two of the Vj , he answers that the edges go from V1 to V2 , from V2 to V3 and from V3 to V1 .
For edges between Vj and some other vertex, he always answers that the edge goes into Vj , except for
the last such edge for which he is asked the question for any given Vj , for which he answers that the

52

Bath — UK, 11th–22nd July 2019

edge goes out of Vj . Thus, as long as at least one of the Vj has not had the question answered for all
the vertices that are not among the Vj , his answers are still compatible both with all vertices having
more than one outgoing edge, and with that Vj having only one
edge.
\\
X outgoing
X
At the start of this phase, each of the Vj has at most log2 83 n ´ 2 ă plog2 nq ´ 1 incoming
edges. Thus, Alice cannot determine whether some vertex has only one outgoing edge within 3pn ´
3 ´ pplog2 nq ´ 1qq ´ 1 questions in this phase; that is, 4n ´ 3plog 2 nq ´ 15 questions total.
Comment 3. We can also improve the upper bound slightly, to 4n ´ 2plog2 nq ` 1. (We do not know
where the precise minimum number of questions lies between 4n ´ 3plog2 nq` Op1q and 4n ´ 2plog2 nq`
Op1q.) Suppose n ě 5 (otherwise no questions are required at all).
To do this, we replace Phases 1 and 2 of the given solution with a different strategy that also
results in a spanning tree where one vertex V is not known to have any outgoing edges, and all other
vertices have exactly one outgoing edge known, but where there is more control over the numbers of
incoming edges. In Phases 3 and 4 we then take more care about the order in which pairs of towns are
chosen, to ensure that each of the remaining towns has already had a question asked about at least
log2 n ` Op1q edges.
Define trees Tm with 2m vertices, exactly one of which (the root) has no outgoing edges and the rest
of which have exactly one outgoing edge, as follows: T0 is a single vertex, while Tm is constructed by
joining the roots of two copies of Tm´1 with an edge in either direction. If n “ 2m we can readily ask
n ´ 1 questions, resulting in a tree Tm for the edges with known direction: first ask about 2m´1 disjoint
pairs of vertices, then about 2m´2 disjoint pairs of the roots of the resulting T1 trees,
X and
\ so on. For
k
the general case, where n is not a power of 2, after k stages of this process we have n{2 trees, each
of which is like Tk but may have some extra vertices (but, however, a unique root). If there are an
even number of trees, then ask about pairs of their roots. If there are an odd number (greater than 1)
of trees, when a single Tk is left over, ask about its root together with that of one of the Tk`1 trees.
Say m “ tlog2 nu. The result of that process is a single Tm tree, possibly with some extra vertices
but still a unique root V . That root has at least m incoming edges, and we may list vertices V0 ,
. . . , Vm´1 with edges to V , such that, for all 0 ď i ă m, vertex Vi itself has at least i incoming edges.
Now divide the vertices other than V into two parts: A has all vertices at an odd distance from V
and B has all the vertices at an even distance from B. Both A and B are nonempty; A contains the Vi ,
while B contains a sequence of vertices with at least 0, 1, . . . , m ´ 2 incoming edges respectively,
similar to the Vi . There are no edges with known direction within A or within B.
In Phase 3, then ask about edges between V and other vertices: first those in B, in order of
increasing number of incoming edges to the other vertex, then those in A, again in order of increasing
number of incoming edges, which involves asking at most n ´ 1 ´ m questions in this phase. If two
outgoing edges are not found from V , at most 2n ´ 2 ´ m ď 4n ´ 2plog2 nq ` 1 questions needed
to be asked in total, so we suppose that two outgoing edges were found, with k questions asked in
this phase, where 2 ď k ď n ´ 1 ´ m. The state of S is as described in the solution above, with
the additional property that, since S must still contain all vertices with edges to V , it contains the
vertices Vi described above.
In Phase 4, consider the vertices left in B, in increasing order of number of edges incoming to a
vertex. If s is the least number of incoming edges to such a vertex, then, for any s ď t ď m ´ 2, there
are at least m ´ t ´ 2 vertices with more than t incoming edges. Repeatedly asking about the pair of
vertices left in B with the least numbers of incoming edges results in a single vertex left over (if any
were in B at all at the start of this phase) with at least m ´ 2 incoming edges. Doing the same with A
(which must be nonempty) leaves a vertex with at least m ´ 1 incoming edges.
Thus if only A is nonempty we ask at most n ´ m questions in Phase 5, so in total at most
3n ´ m ´ 1 questions, while if both are nonempty we ask at most 2n ´ 2m ` 1 questions in Phase 5,
so in total at most 4n ´ 2m ´ 1 ă 4n ´ 2plog2 nq ` 1 questions.

Shortlisted problems – solutions

This page is intentionally left blank

53

54

Bath — UK, 11th–22nd July 2019

C9.

For any two diﬀerent real numbers x and y, we deﬁne Dpx, yq to be the unique
integer d satisfying 2d ď |x ´ y| ă 2d`1 . Given a set of reals F , and an element x P F , we say
that the scales of x in F are the values of Dpx, yq for y P F with x ‰ y.
Let k be a given positive integer. Suppose that each member x of F has at most k diﬀerent
scales in F (note that these scales may depend on x). What is the maximum possible size of F ?
(Italy)
Answer: The maximum possible size of F is 2k .
Common remarks. For convenience, we extend the use of the word scale: we say that the
scale between two reals x and y is Dpx, yq.
Solution. We ﬁrst construct a set F with 2k members, each member having at most k diﬀerent
scales in F . Take F “ t0, 1, 2, . . . , 2k ´ 1u. The scale between any two members of F is in the
set t0, 1, . . . , k ´ 1u.
We now show that 2k is an upper bound on the size of F . For every ﬁnite set S of real
numbers, and every real x, let rS pxq denote the number of diﬀerent scales of x in S. That
is, rS pxq “ |tDpx, yq : x ‰ y P Su|. Thus, for every element x of the set F in the problem
statement, we have rF pxq ď k. The condition |F | ď 2k is an immediate consequence of the
following lemma.
Lemma. Let S be a ﬁnite set of real numbers, and deﬁne
ÿ
wpSq “
2´rS pxq .
xPS

Then wpSq ď 1.

Proof. Induction on n “ |S|. If S “ txu, then rS pxq “ 0, so wpSq “ 1.
Assume now n ě 2, and let x1 ă ¨ ¨ ¨ ă xn list the members of S. Let d be the minimal scale
between two distinct elements of S; then there exist neighbours xt and xt`1 with Dpxt , xt`1 q “ d.
Notice that for any two indices i and j with j ´ i ą 1 we have Dpxi , xj q ą d, since
|xi ´ xj | “ |xi`1 ´ xi | ` |xj ´ xi`1 | ě 2d ` 2d “ 2d`1 .
Now choose the minimal i ď t and the maximal j ě t ` 1 such that Dpxi , xi`1 q “
Dpxi`1 , xi`2 q “ ¨ ¨ ¨ “ Dpxj´1 , xj q “ d.
Let E be the set of all the xs with even indices i ď s ď j, O be the set of those with
odd indices i ď s ď j, and R be the rest of the elements (so that S is the disjoint union of
E, O and R). Set SO “ R Y O and SE “ R Y E; we have |SO | ă |S| and |SE | ă |S|, so
wpSO q, wpSE q ď 1 by the inductive hypothesis.
Clearly, rSO pxq ď rS pxq and rSE pxq ď rS pxq for any x P R, and thus
ÿ

xPR

1 ÿ ´rS pxq
p2
` 2´rS pxq q
2 xPR
1 ÿ ´rS pxq
ď
p2 O ` 2´rSE pxq q .
2 xPR

2´rS pxq “

On the other hand, for every x P O, there is no y P SO such that DSO px, yq “ d (as all
candidates from S were in E). Hence, we have rSO pxq ď rS pxq ´ 1, and thus
ÿ

xPO

2´rS pxq ď

1 ÿ ´rS pxq
2 O .
2 xPO

Shortlisted problems – solutions

55

Similarly, for every x P E, we have
ÿ

xPE

2´rS pxq ď

1 ÿ ´rS pxq
2 E .
2 xPE

We can then combine these to give
ÿ
ÿ
ÿ
wpSq “
2´rS pxq `
2´rS pxq `
2´rS pxq
xPR

ď

1ÿ

xPO

xPE

p2´rSO pxq ` 2´rSE pxq q `

1 ÿ ´rS pxq 1 ÿ ´rS pxq
2 O `
2 E
2 xPO
2 xPE
¸

2 xPR
˜
ÿ
1 ÿ ´rS pxq
2´rSE pxq
2 O `
“
2 xPS
xPS
O

E

(since SO “ O Y R and SE “ E Y R)

1
pwpSO q ` wpSE qqq
(by deﬁnition of wp¨q)
2
ď1
(by the inductive hypothesis)

“

which completes the induction.

l

Comment 1. The sets O and E above are not the only ones we could have chosen. Indeed, we could
instead have used the following definitions:
Let d be the maximal scale between two distinct elements of S; that is, d “ Dpx1 , xn q. Let
O “ tx P S : Dpx, xn q “ du (a ‘left’ part of the set) and let E “ tx P S : Dpx1 , xq “ du (a ‘right’
part of the set). Note that these two sets are disjoint, and nonempty (since they contain x1 and xn
respectively). The rest of the proof is then the same as in Solution 1.
Comment 2. Another possible set F containing 2k members could arise from considering a binary
tree of height k, allocating a real number to each leaf, and trying to make the scale between the values
of two leaves dependent only on the (graph) distance between them. The following construction makes
this more precise.
We build up sets Fk recursively. Let F0 “ t0u, and then let Fk`1 “ Fk Y tx ` 3 ¨ 4k : x P Fk u (i.e.
each half of Fk`1 is a copy of Fk ). We have that Fk is contained in the interval r0, 4k`1 q, and so it
follows by induction on k that every member of Fk`1 has k different scales in its own half of Fk`1 (by
the inductive hypothesis), and only the single scale 2k ` 1 in the other half of Fk`1 .
Both of the constructions presented here have the property that every member of F has exactly k
different scales in F. Indeed, it can be seen that this must hold (up to a slight perturbation) for any
such maximal set. Suppose there were some element x with only k ´ 1 different scales in F (and every
other element had at most k different scales). Then we take some positive real ǫ, and construct a new
set F 1 “ ty : y P F, y ď xu Y ty ` ǫ : y P F, y ě xu. We have |F 1 | “ |F| ` 1, and if ǫ is sufficiently
small then F 1 will also satisfy the property that no member has more than k different scales in F 1 .
This observation might be used to motivate the idea of weighting members of an arbitrary set S
of reals according to how many different scales they have in S.

56

Bath — UK, 11th–22nd July 2019

Geometry
G1.

Let ABC be a triangle. Circle Γ passes through A, meets segments AB and AC
again at points D and E respectively, and intersects segment BC at F and G such that F lies
between B and G. The tangent to circle BDF at F and the tangent to circle CEG at G meet
at point T . Suppose that points A and T are distinct. Prove that line AT is parallel to BC.
(Nigeria)
Solution. Notice that =T F B “ =F DA because F T is tangent to circle BDF , and moreover
=F DA “ =CGA because quadrilateral ADF G is cyclic. Similarly, =T GB “ =GEC because
GT is tangent to circle CEG, and =GEC “ =CF A. Hence,
=T F B “ =CGA and =T GB “ =CF A.
T

p1q

A
E

Γ

D

B

F

G

C

Triangles F GA and GF T have a common side F G, and by p1q their angles at F, G are the
same. So, these triangles are congruent. So, their altitudes starting from A and T , respectively,
are equal and hence AT is parallel to line BF GC.
Comment. Alternatively, we can prove first that T lies on Γ. For example, this can be done by
showing that =AF T “ =AGT using p1q. Then the statement follows as =T AF “ =T GF “ =GF A.

Shortlisted problems – solutions

57

G2.

Let ABC be an acute-angled triangle and let D, E, and F be the feet of altitudes
from A, B, and C to sides BC, CA, and AB, respectively. Denote by ωB and ωC the incircles
of triangles BDF and CDE, and let these circles be tangent to segments DF and DE at M
and N, respectively. Let line MN meet circles ωB and ωC again at P ‰ M and Q ‰ N,
respectively. Prove that MP “ NQ.
(Vietnam)
Solution. Denote the centres of ωB and ωC by OB and OC , let their radii be rB and rC , and
let BC be tangent to the two circles at T and U, respectively.
A

F
E
P

ωB
ϕ
rB

ωC

M
N ψ

ϕ
ψ

OB

rC

OC

ϕ

B

T

ψ

D

U

Q
C

From the cyclic quadrilaterals AF DC and ABDE we have
1
1
1
=MDOB “ =F DB “ =BAC “ =CDE “ =OC DN,
2
2
2
so the right-angled triangles DMOB and DNOC are similar. The ratio of similarity between
the two triangles is
DN
OC N
rC
“
“
.
DM
OB M
rB
Let ϕ “ =DMN and ψ “ =MND. The lines F M and EN are tangent to ωB and ωC ,
respectively, so
=MT P “ =F MP “ =DMN “ ϕ and =QUN “ =QNE “ =MND “ ψ.
(It is possible that P or Q coincides with T or U, or lie inside triangles DMT or DUN,
respectively. To reduce case-sensitivity, we may use directed angles or simply ignore angles
MT P and QUN.)
In the circles ωB and ωC the lengths of chords MP and NQ are
MP “ 2rB ¨ sin =MT P “ 2rB ¨ sin ϕ and NQ “ 2rC ¨ sin =QUN “ 2rC ¨ sin ψ.
By applying the sine rule to triangle DNM we get
DN
sin =DMN
sin ϕ
“
“
.
DM
sin =MND
sin ψ
Finally, putting the above observations together, we get
2rB sin ϕ
rB sin ϕ
DM sin ϕ
sin ψ sin ϕ
MP
“
“
¨
“
¨
“
¨
“ 1,
NQ
2rC sin ψ
rC sin ψ
DN sin ψ
sin ϕ sin ψ
so MP “ NQ as required.

58

Bath — UK, 11th–22nd July 2019

G3.

In triangle ABC, let A1 and B1 be two points on sides BC and AC, and let P and Q
be two points on segments AA1 and BB1 , respectively, so that line P Q is parallel to AB. On
ray P B1 , beyond B1 , let P1 be a point so that =P P1 C “ =BAC. Similarly, on ray QA1 ,
beyond A1 , let Q1 be a point so that =CQ1 Q “ =CBA. Show that points P , Q, P1 , and Q1
are concyclic.
(Ukraine)
Solution 1. Throughout the solution we use oriented angles.
Let rays AA1 and BB1 intersect the circumcircle of △ACB at A2 and B2 , respectively. By
=QP A2 “ =BAA2 “ =BB2 A2 “ =QB2 A2 ,
points P, Q, A2, B2 are concyclic; denote the circle passing through these points by ω. We shall
prove that P1 and Q1 also lie on ω.
Q1

ω

P1
C
A2
B2
A1

B1
P

Q

A

B

By
=CA2 A1 “ =CA2 A “ =CBA “ =CQ1 Q “ =CQ1 A1 ,
points C, Q1, A2 , A1 are also concyclic. From that we get
=QQ1 A2 “ =A1 Q1 A2 “ =A1 CA2 “ =BCA2 “ =BAA2 “ =QP A2 ,
so Q1 lies on ω.
It follows similarly that P1 lies on ω.
Solution 2. First consider the case when lines P P1 and QQ1 intersect each other at some
point R.
Let line P Q meet the sides AC and BC at E and F , respectively. Then
=P P1 C “ =BAC “ =P EC,
so points C, E, P, P1 lie on a circle; denote that circle by ωP . It follows analogously that points
C, F, Q, Q1 lie on another circle; denote it by ωQ .
Let AQ and BP intersect at T . Applying Pappus’ theorem to the lines AA1 P and BB1 Q
provides that points C “ AB1 X BA1 , R “ A1 Q X B1 P and T “ AQ X BP are collinear.
Let line RCT meet P Q and AB at S and U, respectively. From AB k P Q we obtain
SP
UB
SF
“
“
,
SQ
UA
SE
so
SP ¨ SE “ SQ ¨ SF.

Shortlisted problems – solutions

59
ωQ

R

ωP

Q1
P1
C

A1

B1

E

F

S
P

Q
T
U

A

B

So, point S has equal powers with respect to ωP and ωQ , hence line RCS is their radical
axis; then R also has equal powers to the circles, so RP ¨ RP1 “ RQ ¨ RQ1 , proving that points
P, P1 , Q, Q1 are indeed concyclic.
Now consider the case when P P1 and QQ1 are parallel. Like in the previous case, let AQ
and BP intersect at T . Applying Pappus’ theorem again to the lines AA1 P and BB1 Q, in this
limit case it shows that line CT is parallel to P P1 and QQ1 .
Let line CT meet P Q and AB at S and U, as before. The same calculation as in the
previous case shows that SP ¨ SE “ SQ ¨ SF , so S lies on the radical axis between ωP and ωQ .
ωQ

Q1
P1
ωP
C

ℓ

A1
B1

E

F

S
Q

P
T

A

U

B

Line CST , that is the radical axis between ωP and ωQ , is perpendicular to the line ℓ of centres
of ωP and ωQ . Hence, the chords P P1 and QQ1 are perpendicular to ℓ. So the quadrilateral
P P1 Q1 Q is an isosceles trapezium with symmetry axis ℓ, and hence is cyclic.
Comment. There are several ways of solving the problem involving Pappus’ theorem. For example,
one may consider the points K “ P B1 X BC and L “ QA1 X AC. Applying Pappus’ theorem to the
lines AA1 P and QB1 B we get that K, L, and P Q X AB are collinear, i.e. that KL k AB. Therefore,
cyclicity of P , Q, P1 , and Q1 is equivalent to that of K, L, P1 , and Q1 . The latter is easy after noticing
that C also lies on that circle. Indeed, e.g. =pLK, LCq “ =pAB, ACq “ =pP1 K, P1 Cq shows that K
lies on circle KLC.
This approach also has some possible degeneracy, as the points K and L may happen to be ideal.

60

Bath — UK, 11th–22nd July 2019

G4.

Let P be a point inside triangle ABC. Let AP meet BC at A1 , let BP meet CA
at B1 , and let CP meet AB at C1 . Let A2 be the point such that A1 is the midpoint of P A2 ,
let B2 be the point such that B1 is the midpoint of P B2 , and let C2 be the point such that
C1 is the midpoint of P C2 . Prove that points A2 , B2 , and C2 cannot all lie strictly inside the
circumcircle of triangle ABC.
(Australia)
C2
C3

B

C1
A1 A2

A3

P
A

B1
C

B2
B3

Solution 1. Since
=AP B ` =BP C ` =CP A “ 2π “ pπ ´ =ACBq ` pπ ´ =BACq ` pπ ´ =CBAq,
at least one of the following inequalities holds:
=AP B ě π ´ =ACB,

=BP C ě π ´ =BAC,

=CP A ě π ´ =CBA .

Without loss of generality, we assume that =BP C ě π ´ =BAC. We have =BP C ą =BAC
because P is inside △ABC. So =BP C ě maxp=BAC, π ´ =BACq and hence
sin =BP C ď sin =BAC .

p˚q

Let the rays AP , BP , and CP cross the circumcircle Ω again at A3 , B3 , and C3 , respectively.
We will prove that at least one of the ratios BP1BB13 and CP1CC13 is at least 1, which yields that one
of the points B2 and C2 does not lie strictly inside Ω.
Because A, B, C, B3 lie on a circle, the triangles CB1 B3 and BB1 A are similar, so
CB1
BB1
“
.
B1 B3
B1 A
Applying the sine rule we obtain
P B1
P B1 CB1
P B1 BB1
sin =ACP sin =BAC
“
¨
“
¨
“
¨
.
B1 B3
CB1 B1 B3
CB1 B1 A
sin =BP C sin =P BA
Similarly,

P C1
sin =P BA sin =BAC
“
¨
.
C1 C3
sin =BP C sin =ACP
Multiplying these two equations we get
sin2 =BAC
P B1 P C1
¨
“
ě1
B1 B3 C1 C3
sin2 =BP C
using p˚q, which yields the desired conclusion.

Shortlisted problems – solutions

61

Comment. It also cannot happen that all three points A2 , B2 , and C2 lie strictly outside Ω. The same
proof works almost literally, starting by assuming without loss of generality that =BP C ď π ´ =BAC
and using =BP C ą =BAC to deduce that sin =BP C ě sin =BAC. It is possible for A2 , B2 , and C2
all to lie on the circumcircle; from the above solution we may derive that this happens if and only if P
is the orthocentre of the triangle ABC, (which lies strictly inside ABC if and only if ABC is acute).

Solution 2. Deﬁne points A3 , B3 , and C3 as in Solution 1. Assume for the sake of contradiction
that A2 , B2 , and C2 all lie strictly inside circle ABC. It follows that P A1 ă A1 A3 , P B1 ă B1 B3 ,
and P C1 ă C1 C3 .
Observe that △P BC3 „ △P CB3. Let X be the point on side P B3 that corresponds to
point C1 on side P C3 under this similarity. In other words, X lies on segment P B3 and satisﬁes
P X : XB3 “ P C1 : C1 C3 . It follows that
=XCP “ =P BC1 “ =B3 BA “ =B3 CB1 .
Hence lines CX and CB1 are isogonal conjugates in △P CB3.

A

B3

α
B1

C3

α

Y
α

C1

X
P

y
x

y

B

y

x
C

A1

A3

Let Y be the foot of the bisector of =B3 CP in △P CB3. Since P C1 ă C1 C3 , we have
P X ă XB3 . Also, we have P Y ă Y B3 because P B1 ă B1 B3 and Y lies between X and B1 .
By the angle bisector theorem in △P CB3 , we have P Y : Y B3 “ P C : CB3 . So P C ă CB3
and it follows that =P B3 C ă =CP B3 . Now since =P B3 C “ =BB3 C “ =BAC, we have
=BAC ă =CP B3 .
Similarly, we have
=CBA ă =AP C3

and =ACB ă =BP A3 “ =B3 P A .

Adding these three inequalities yields π ă π, and this contradiction concludes the proof.

62

Bath — UK, 11th–22nd July 2019

Solution 3. Choose coordinates such that the circumcentre of △ABC is at the origin and
the circumradius is 1. Then we may think of A, B, and C as vectors in R2 such that
|A|2 “ |B|2 “ |C|2 “ 1 .
P may be represented as a convex combination αA`βB`γC where α, β, γ ą 0 and α`β`γ “ 1.
Then
1
α
βB ` γC
“
P´
A,
A1 “
β`γ
1´α
1´α
so
1`α
2α
A2 “ 2A1 ´ P “
P´
A.
1´α
1´α
Hence
˙2
˙2
ˆ
ˆ
1`α
4αp1 ` αq
2α
2
2
A¨P .
|A2 | “
|P | `
|A|2 ´
1´α
1´α
p1 ´ αq2
Using |A|2 “ 1 we obtain

Likewise

and

p1 ´ αq2
1`α 2
2α2
|A2 |2 “
|P | `
´ 2αA ¨ P.
2p1 ` αq
2
1`α

(1)

1`β 2
2β 2
p1 ´ βq2
|B2 |2 “
|P | `
´ 2βB ¨ P
2p1 ` βq
2
1`β

(2)

p1 ´ γq2
1`γ 2
2γ 2
|C2 |2 “
|P | `
´ 2γC ¨ P.
2p1 ` γq
2
1`γ

(3)

Summing (1), (2) and (3) we obtain on the LHS the positive linear combination
LHS “

p1 ´ βq2
p1 ´ γq2
p1 ´ αq2
|A2 |2 `
|B2 |2 `
|C2 |2
2p1 ` αq
2p1 ` βq
2p1 ` γq

and on the RHS the quantity
ˆ
˙
ˆ
˙
1`α 1`β 1`γ
2β 2
2γ 2
2α2
2
|P | `
´ 2pαA ¨ P ` βB ¨ P ` γC ¨ P q .
`
`
`
`
2
2
2
1`α 1`β 1`γ
The ﬁrst term is 2|P |2 and the last term is ´2P ¨ P , so
ˆ
˙
2α2
2β 2
2γ 2
RHS “
`
`
1`α 1`β 1`γ
3α ´ 1 p1 ´ αq2 3β ´ 1 p1 ´ βq2 3γ ´ 1 p1 ´ γq2
“
`
`
`
`
`
2
2p1 ` αq
2
2p1 ` βq
2
2p1 ` γq
2
2
2
p1 ´ βq
p1 ´ γq
p1 ´ αq
`
`
.
“
2p1 ` αq 2p1 ` βq 2p1 ` γq
Here we used the fact that
3α ´ 1 3β ´ 1 3γ ´ 1
`
`
“ 0.
2
2
2
We have shown that a linear combination of |A1 |2 , |B1 |2 , and |C1 |2 with positive coeﬃcients is
equal to the sum of the coeﬃcients. Therefore at least one of |A1 |2 , |B1 |2 , and |C1 |2 must be at
least 1, as required.
Comment. This proof also works when P is any point for which α, β, γ ą ´1, α ` β ` γ “ 1, and
α, β, γ ‰ 1. (In any cases where α “ 1 or β “ 1 or γ “ 1, some points in the construction are not
defined.)

Shortlisted problems – solutions

This page is intentionally left blank

63

64

Bath — UK, 11th–22nd July 2019

G5.

Let ABCDE be a convex pentagon with CD “ DE and =EDC ‰ 2 ¨ =ADB.
Suppose that a point P is located in the interior of the pentagon such that AP “ AE and
BP “ BC. Prove that P lies on the diagonal CE if and only if areapBCDq ` areapADEq “
areapABDq ` areapABP q.
(Hungary)
Solution 1. Let P 1 be the reﬂection of P across line AB, and let M and N be the midpoints of
P 1 E and P 1 C respectively. Convexity ensures that P 1 is distinct from both E and C, and hence
from both M and N. We claim that both the area condition and the collinearity condition in
the problem are equivalent to the condition that the (possibly degenerate) right-angled triangles
AP 1 M and BP 1 N are directly similar (equivalently, AP 1 E and BP 1 C are directly similar).
E

D

M

C
B

A
N
P1
For the equivalence with the collinearity condition, let F denote the foot of the perpendicular
from P 1 to AB, so that F is the midpoint of P P 1 . We have that P lies on CE if and only if F lies
on MN, which occurs if and only if we have the equality =AF M “ =BF N of signed angles
modulo π. By concyclicity of AP 1F M and BF P 1 N, this is equivalent to =AP 1 M “ =BP 1 N,
which occurs if and only if AP 1 M and BP 1 N are directly similar.
M
B

A

N

F
P1

For the other equivalence with the area condition, we have the equality of signed areas
areapABDq ` areapABP q “ areapAP 1 BDq “ areapAP 1 Dq ` areapBDP 1 q. Using the identity
areapADEq ´ areapAP 1Dq “ areapADEq ` areapADP 1 q “ 2 areapADMq, and similarly for B,
we ﬁnd that the area condition is equivalent to the equality
areapDAMq “ areapDBNq.
Now note that A and B lie on the perpendicular bisectors of P 1E and P 1C, respectively. If
we write G and H for the feet of the perpendiculars from D to these perpendicular bisectors
respectively, then this area condition can be rewritten as
MA ¨ GD “ NB ¨ HD.
(In this condition, we interpret all lengths as signed lengths according to suitable conventions:
for instance, we orient P 1 E from P 1 to E, orient the parallel line DH in the same direction, and
orient the perpendicular bisector of P 1 E at an angle π{2 clockwise from the oriented segment
P 1 E – we adopt the analogous conventions at B.)

Shortlisted problems – solutions

65
E

D

H

G
C

M

A

B

N

P1
To relate the signed lengths GD and HD to the triangles AP 1 M and BP 1 N, we use the
following calculation.
Claim. Let Γ denote the circle centred on D with both E and C on the circumference, and
h the power of P 1 with respect to Γ. Then we have the equality
1
GD ¨ P 1 M “ HD ¨ P 1 N “ h ‰ 0.
4
Proof. Firstly, we have h ‰ 0, since otherwise P 1 would lie on Γ, and hence the internal angle
bisectors of =EDP 1 and =P 1 DC would pass through A and B respectively. This would violate
the angle inequality =EDC ‰ 2 ¨ =ADB given in the question.
Next, let E 1 denote the second point of intersection of P 1E with Γ, and let E 2 denote the
point on Γ diametrically opposite E 1 , so that E 2 E is perpendicular to P 1 E. The point G lies
on the perpendicular bisectors of the sides P 1 E and EE 2 of the right-angled triangle P 1 EE 2 ;
it follows that G is the midpoint of P 1 E 2 . Since D is the midpoint of E 1 E 2 , we have that
GD “ 21 P 1E 1 . Since P 1 M “ 21 P 1 E, we have GD ¨ P 1 M “ 14 P 1 E 1 ¨ P 1 E “ 41 h. The other equality
HD ¨ P 1 N follows by exactly the same argument.
E2

Γ

D
E
G

E1
M

P1
l
From this claim, we see that the area condition is equivalent to the equality
pMA : P 1 Mq “ pNB : P 1 Nq
of ratios of signed lengths, which is equivalent to direct similarity of AP 1 M and BP 1 N, as
desired.

66

Bath — UK, 11th–22nd July 2019

Solution 2. Along the perpendicular bisector of CE, deﬁne the linear function
f pXq “ areapBCXq ` areapAXEq ´ areapABXq ´ areapABP q,
where, from now on, we always use signed areas. Thus, we want to show that C, P, E are
collinear if and only if f pDq “ 0.
C

D

E
P
B

A

Let P 1 be the reﬂection of P across line AB. The point P 1 does not lie on the line CE.
To see this, we let A2 and B 2 be the points obtained from A and B by dilating with scale
factor 2 about P 1 , so that P is the orthogonal projection of P 1 onto A2 B 2 . Since A lies on the
perpendicular bisector of P 1E, the triangle A2 EP 1 is right-angled at E (and B 2 CP 1 similarly).
If P 1 were to lie on CE, then the lines A2 E and B 2 C would be perpendicular to CE and A2
and B 2 would lie on the opposite side of CE to D. It follows that the line A2 B 2 does not meet
triangle CDE, and hence point P does not lie inside CDE. But then P must lie inside ABCE,
and it is clear that such a point cannot reﬂect to a point P 1 on CE.
We thus let O be the centre of the circle CEP 1 . The lines AO and BO are the perpendicular
bisectors of EP 1 and CP 1, respectively, so
areapBCOq ` areapAOEq “ areapOP 1Bq ` areapP 1 OAq “ areapP 1 BOAq
“ areapABOq ` areapBAP 1 q “ areapABOq ` areapABP q,
and hence f pOq “ 0.
Notice that if point O coincides with D then points A, B lie in angle domain CDE and
=EOC “ 2 ¨ =AOB, which is not allowed. So, O and D must be distinct. Since f is linear and
vanishes at O, it follows that f pDq “ 0 if and only if f is constant zero – we want to show this
occurs if and only if C, P, E are collinear.
T

C

E

P

E

O

A
B

C

P

A

B

P′

In the one direction, suppose ﬁrstly that C, P, E are not collinear, and let T be the centre
of the circle CEP . The same calculation as above provides
areapBCT q ` areapAT Eq “ areapP BT Aq “ areapABT q ´ areapABP q
so
f pT q “ ´2 areapABP q ‰ 0.

Shortlisted problems – solutions

67

Hence, the linear function f is nonconstant with its zero is at O, so that f pDq ‰ 0.
In the other direction, suppose that the points C, P, E are collinear. We will show that f is
constant zero by ﬁnding a second point (other than O) at which it vanishes.
E
P

C
A

A′

B

Q

B′

Let Q be the reﬂection of P across the midpoint of AB, so P AQB is a parallelogram. It
is easy to see that Q is on the perpendicular bisector of CE; for instance if A1 and B 1 are the
points produced from A and B by dilating about P with scale factor 2, then the projection
of Q to CE is the midpoint of the projections of A1 and B 1 , which are E and C respectively.
The triangles BCQ and AQE are indirectly congruent, so
`
˘ `
˘
f pQq “ areapBCQq ` areapAQEq ´ areapABQq ´ areapBAP q “ 0 ´ 0 “ 0.

The points O and Q are distinct. To see this, consider the circle ω centred on Q with P 1 on
the circumference; since triangle P P 1 Q is right-angled at P 1 , it follows that P lies outside ω.
On the other hand, P lies between C and E on the line CP E. It follows that C and E cannot
both lie on ω, so that ω is not the circle CEP 1 and Q ‰ O.
Since O and Q are distinct zeroes of the linear function f , we have f pDq “ 0 as desired.
Comment 1. The condition =EDC ‰ 2¨=ADB cannot be omitted. If D is the centre of circle CEP 1 ,
then the condition on triangle areas is satisfied automatically, without having P on line CE.
Comment 2. The “only if” part of this problem is easier than the “if” part. For example, in
the second part of Solution 2, the triangles EAQ and QBC are indirectly congruent, so the sum
of their areas is 0, and DCQE is a kite. Now one can easily see that =pAQ, DEq “ =pCD, CBq
and =pBQ, DCq “ =pED, EAq, whence areapBCDq “ areapAQDq ` areapEQAq and areapADEq “
areapBDQq ` areapBQCq, which yields the result.

68

Bath — UK, 11th–22nd July 2019

Comment 3. The origin of the problem is the following observation. Let ABDH be a tetrahedron
and consider the sphere S that is tangent to the four face planes, internally to planes ADH and BDH
and externally to ABD and ABH (or vice versa). It is known that the sphere S exists if and only
if areapADHq ` areapBDHq ‰ areapABHq ` areapABDq; this relation comes from the usual formula
for the volume of the tetrahedron.
Let T, Ta , Tb , Td be the points of tangency between the sphere and the four planes, as shown in the
picture. Rotate the triangle ABH inward, the triangles BDH and ADH outward, into the triangles
ABP , BDC and ADE, respectively, in the plane ABD. Notice that the points Td , Ta , Tb are rotated
to T , so we have HTa “ HTb “ HTd “ P T “ CT “ ET . Therefore, the point T is the centre of the
circle CEP . Hence, if the sphere exists then C, E, P cannot be collinear.
If the condition =EDC ‰ 2 ¨ =ADB is replaced by the constraint that the angles =EDA, =ADB
and =BDC satisfy the triangle inequality, it enables reconstructing the argument with the tetrahedron
and the tangent sphere.
H

C
D

P

B
A

T

E

Ta

Tb
Td

Shortlisted problems – solutions

69

G6.

Let I be the incentre of acute-angled triangle ABC. Let the incircle meet BC, CA,
and AB at D, E, and F , respectively. Let line EF intersect the circumcircle of the triangle
at P and Q, such that F lies between E and P . Prove that =DP A ` =AQD “ =QIP .
(Slovakia)
Ŋ of the circumcircle, containing
Solution 1. Let N and M be the midpoints of the arcs BC
and opposite vertex A, respectively. By =F AE “ =BAC “ =BNC, the right-angled kites
AF IE and NBMC are similar. Consider the spiral similarity ϕ (dilation in case of AB “ AC)
that moves AF IE to NBMC. The directed angle in which ϕ changes directions is =pAF, NBq,
same as =pAP, NP q and =pAQ, NQq; so lines AP and AQ are mapped to lines NP and NQ,
respectively. Line EF is mapped to BC; we can see that the intersection points P “ EF X AP
and Q “ EF X AQ are mapped to points BC X NP and BC X NQ, respectively. Denote these
points by P 1 and Q1 , respectively.
N
A

Γ

P
F
E
I

P′

B

D

L

C

Q

Q′

Z

M

Let L be the midpoint of BC. We claim that points P, Q, D, L are concyclic (if D “ L
then line BC is tangent to circle P QD). Let P Q and BC meet at Z. By applying Menelaus’
theorem to triangle ABC and line EF Z, we have
BD
BF AE
BZ
“
¨
“´
,
DC
F A EC
ZC
so the pairs B, C and D, Z are harmonic. It is well-known that this implies ZB ¨ZC “ ZD ¨ZL.
(The inversion with pole Z that swaps B and C sends Z to inﬁnity and D to the midpoint
of BC, because the cross-ratio is preserved.) Hence, ZD ¨ ZL “ ZB ¨ ZC “ ZP ¨ ZQ by the
power of Z with respect to the circumcircle; this proves our claim.
By =MP P 1 “ =MQQ1 “ =MLP 1 “ =MLQ1 “ 90˝ , the quadrilaterals MLP P 1 and
MLQQ1 are cyclic. Then the problem statement follows by
=DP A ` =AQD “ 360˝ ´ =P AQ ´ =QDP “ 360˝ ´ =P NQ ´ =QLP
“ =LP N ` =NQL “ =P 1 ML ` =LMQ1 “ =P 1 MQ1 “ =P IQ.

70

Bath — UK, 11th–22nd July 2019

Solution 2. Deﬁne the point M and the same spiral similarity ϕ as in the previous solution.
(The point N is not necessary.) It is well-known that the centre of the spiral similarity that
maps F, E to B, C is the Miquel point of the lines F E, BC, BF and CE; that is, the second
intersection of circles ABC and AEF . Denote that point by S.
By ϕpF q “ B and ϕpEq “ C the triangles SBF and SCE are similar, so we have
SB
BF
BD
“
“
.
SC
CE
CD
By the converse of the angle bisector theorem, that indicates that line SD bisects =BSC and
hence passes through M.
Let K be the intersection point of lines EF and SI. Notice that ϕ sends points S, F, E, I
to S, B, C, M, so ϕpKq “ ϕpF E X SIq “ BC X SM “ D. By ϕpIq “ M, we have KD k IM.
A

Γ

S

P
F
K

E
Q

I

D

B

C

L
M

We claim that triangles SP I and SDQ are similar, and so are triangles SP D and SIQ.
Let ray SI meet the circumcircle again at L. Note that the segment EF is perpendicular to
the angle bisector AM. Then by =AML “ =ASL “ =ASI “ 90˝ , we have ML k P Q. Hence,
Ŋ and therefore =P SL “ =MSQ “ =DSQ. By =QP S “ =QMS, the triangles
PŇL “ MQ
SP K and SMQ are similar. Finally,
SP
SP SK
SM SD
SD
“
¨
“
¨
“
SI
SK SI
SQ SM
SQ

shows that triangles SP I and SDQ are similar. The second part of the claim can be proved
analogously.
Now the problem statement can be proved by
=DP A ` =AQD “ =DP S ` =SQD “ =QIS ` =SIP “ =QIP .

Shortlisted problems – solutions

71

Solution 3. Denote the circumcircle of triangle ABC by Γ, and let rays P D and QD meet Γ
again at V and U, respectively. We will show that AU K IP and AV K IQ. Then the problem
statement will follow as
=DP A ` =AQD “ =V UA ` =AV U “ 180˝ ´ =UAV “ =QIP .
ŔC and let N be the midpoint of arc CAB;
Ő the lines AIM
Let M be the midpoint of arc BUV
and AN being the internal and external bisectors of angle BAC, respectively, are perpendicular.
Let the tangents drawn to Γ at B and C meet at R; let line P Q meet AU, AI, AV and BC at
X, T , Y and Z, respectively.
As in Solution 1, we observe that the pairs B, C and D, Z are harmonic. Projecting these
points from Q onto the circumcircle, we can see that B, C and U, P are also harmonic. Analogously, the pair V, Q is harmonic with B, C. Consider the inversion about the circle with
centre R, passing through B and C. Points B and C are ﬁxed points, so this inversion exchanges every point of Γ by its harmonic pair with respect to B, C. In particular, the inversion
maps points B, C, N, U, V to points B, C, M, P, Q, respectively.
Combine the inversion with projecting Γ from A to line P Q; the points B, C, M, P, Q are
projected to F, E, T, P, Q, respectively.
N
A

Γ

P
F

X

T

Y

E

Q

I
Z
B

D
U

C
V

M

R

The combination of these two transformations is projective map from the lines AB, AC,
AN, AU, AV to IF , IE, IT , IP , IQ, respectively. On the other hand, we have AB K IF ,
AC K IE and AN K AT , so the corresponding lines in these two pencils are perpendicular.
This proves AU K IP and AV K IQ, and hence completes the solution.

72

Bath — UK, 11th–22nd July 2019

G7.

The incircle ω of acute-angled scalene triangle ABC has centre I and meets sides BC,
CA, and AB at D, E, and F , respectively. The line through D perpendicular to EF meets ω
again at R. Line AR meets ω again at P . The circumcircles of triangles P CE and P BF meet
again at Q ‰ P . Prove that lines DI and P Q meet on the external bisector of angle BAC.
(India)
Common remarks. Throughout the solution, =pa, bq denotes the directed angle between
lines a and b, measured modulo π.
Solution 1.
Step 1. The external bisector of =BAC is the line through A perpendicular to IA. Let DI
meet this line at L and let DI meet ω at K. Let N be the midpoint of EF , which lies on IA
and is the pole of line AL with respect to ω. Since AN ¨ AI “ AE 2 “ AR ¨ AP , the points R,
N, I, and P are concyclic. As IR “ IP , the line NI is the external bisector of =P NR, so P N
meets ω again at the point symmetric to R with respect to AN – i.e. at K.
Let DN cross ω again at S. Opposite sides of any quadrilateral inscribed in the circle ω
meet on the polar line of the intersection of the diagonals with respect to ω. Since L lies on
the polar line AL of N with respect to ω, the line P S must pass through L. Thus it suﬃces to
prove that the points S, Q, and P are collinear.
A

L

K
K
K
K

F
A

N
N
N
N
I

F

M
M
M
M

S
S
S
S
ω

K
K
K
K

B

R

Q
Q
Q
Q

E

P
P
P
P
D

C

N
N
ω

I

E
Γ
P
P

D

C

T

Step 2. Let Γ be the circumcircle of △BIC. Notice that
=pBQ, QCq “ =pBQ, QP q ` =pP Q, QCq “ =pBF, F P q ` =pP E, ECq
“ =pEF, EP q ` =pF P, F Eq “ =pF P, EP q “ =pDF, DEq “ =pBI, ICq,
so Q lies on Γ. Let QP meet Γ again at T . It will now suﬃce to prove that S, P , and T
are collinear. Notice that =pBI, IT q “ =pBQ, QT q “ =pBF, F P q “ =pF K, KP q. Note
F D K F K and F D K BI so F K k BI and hence IT is parallel to the line KNP . Since
DI “ IK, the line IT crosses DN at its midpoint M.

Step 3. Let F 1 and E 1 be the midpoints of DE and DF , respectively. Since DE 1 ¨E 1 F “ DE 12 “
BE 1 ¨E 1 I, the point E 1 lies on the radical axis of ω and Γ; the same holds for F 1 . Therefore, this
radical axis is E 1 F 1 , and it passes through M. Thus IM ¨ MT “ DM ¨ MS, so S, I, D, and T
are concyclic. This shows =pDS, ST q “ =pDI, IT q “ =pDK, KP q “ =pDS, SP q, whence the
points S, P , and T are collinear, as desired.

Shortlisted problems – solutions

73
A

F
F
F
F

K
K
K
K

S
S
S
S
N
N
N
N

I

E
E
E
E

M
M
ω
B

P
P
D

C

Γ

T

Comment. Here is a longer alternative proof in step 1 that P , S, and L are collinear, using a circular
inversion instead of the fact that opposite sides of a quadrilateral inscribed in a circle ω meet on the
polar line with respect to ω of the intersection of the diagonals. Let G be the foot of the altitude from
N to the line DIKL. Observe that N, G, K, S are concyclic (opposite right angles) so
=DIP “ 2=DKP “ =GKN ` =DSP “ =GSN ` =N SP “ =GSP ,
hence I, G, S, P are concyclic. We have IG ¨ IL “ IN ¨ IA “ r 2 since △IGN „ △IAL. Inverting the
circle IGSP in circle ω, points P and S are fixed and G is taken to L so we find that P, S, and L are
collinear.

74

Bath — UK, 11th–22nd July 2019

Solution 2. We start as in Solution 1. Namely, we introduce the same points K, L, N, and S,
and show that the triples pP, N, Kq and pP, S, Lq are collinear. We conclude that K and R are
symmetric in AI, and reduce the problem statement to showing that P , Q, and S are collinear.
Step 1. Let AR meet the circumcircle Ω of ABC again at X. The lines AR and AK are
isogonal in the angle BAC; it is well known that in this case X is the tangency point of Ω with
the A-mixtilinear circle. It is also well known that for this point X, the line XI crosses Ω again
at the midpoint M 1 of arc BAC.
Step 2. Denote the circles BF P and CEP by ΩB and ΩC , respectively. Let ΩB cross AR
and EF again at U and Y , respectively. We have
=pUB, BF q “ =pUP, P F q “ =pRP, P F q “ =pRF, F Aq,
so UB k RF .
M′

A

ΩB

F

R
R
YY
YY
E

Ω

ω

IIII

VV
VV

Z
Z
Z
Z
ΩC
P
P
P
P

B

W
W
W
W
C

D
U
U
X
X

Next, we show that the points B, I, U, and X are concyclic. Since
=pUB, UXq “ =pRF, RXq “ =pAF, ARq ` =pF R, F Aq “ =pM 1 B, M 1 Xq ` =pDR, DF q,
it suﬃces to prove =pIB, IXq “ =pM 1 B, M 1 Xq ` =pDR, DF q, or =pIB, M 1 Bq “ =pDR, DF q.
But both angles equal =pCI, CBq, as desired. (This is where we used the fact that M 1 is the
midpoint of arc BAC of Ω.)
It follows now from circles BUIX and BP UF Y that
=pIU, UBq “ =pIX, BXq “ =pM 1 X, BXq “

π ´ =A
2
“ =pEF, AF q “ =pY F, BF q “ =pY U, BUq ,

so the points Y , U, and I are collinear.
Let EF meet BC at W . We have
=pIY, Y W q “ =pUY, F Y q “ =pUB, F Bq “ =pRF, AF q “ =pCI, CW q,
so the points W , Y , I, and C are concyclic.

Shortlisted problems – solutions

75

Similarly, if V and Z are the second meeting points of ΩC with AR and EF , we get that
the 4-tuples pC, V, I, Xq and pB, I, Z, W q are both concyclic.

Step 3. Let Q1 “ CY X BZ. We will show that Q1 “ Q.
First of all, we have

=pQ1 Y, Q1 Bq “ =pCY, ZBq “ =pCY, ZY q ` =pZY, BZq
“ =pCI, IW q ` =pIW, IBq “ =pCI, IBq “

π ´ =A
“ =pF Y, F Bq,
2

so Q1 P ΩB . Similarly, Q1 P ΩC . Thus Q1 P ΩB X ΩC “ tP, Qu and it remains to prove that
Q1 ‰ P . If we had Q1 “ P , we would have =pP Y, P Zq “ =pQ1 Y, Q1 Zq “ =pIC, IBq. This
would imply
=pP Y, Y F q ` =pEZ, ZP q “ =pP Y, P Zq “ =pIC, IBq “ =pP E, P F q,
so circles ΩB and ΩC would be tangent at P . That is excluded in the problem conditions, so
Q1 “ Q.
A

S

F

ΩB

R
R
R
R
N
N
N
N

YY
YY

E
Ω

ω

IIII

VV
VV

Z
Z
Z
Z
Q
=
Q
Q
Q′′′′′ =
=Q
Q
Q
=
Q

B

P
P
P
P

ΩC
W
W
W
W

C

D
U
U
U
U
X
X
X
X

Step 4. Now we are ready to show that P , Q, and S are collinear.
Notice that A and D are the poles of EW and DW with respect to ω, so W is the pole
of AD. Hence, W I K AD. Since CI K DE, this yields =pIC, W Iq “ =pDE, DAq. On the
other hand, DA is a symmedian in △DEF , so =pDE, DAq “ =pDN, DF q “ =pDS, DF q.
Therefore,
=pP S, P F q “ =pDS, DF q “ =pDE, DAq “ =pIC, IW q
“ =pY C, Y W q “ =pY Q, Y F q “ =pP Q, P F q,
which yields the desired collinearity.

76

Bath — UK, 11th–22nd July 2019

G8.

Let L be the set of all lines in the plane and let f be a function that assigns to each
line ℓ P L a point f pℓq on ℓ. Suppose that for any point X, and for any three lines ℓ1 , ℓ2 , ℓ3
passing through X, the points f pℓ1 q, f pℓ2 q, f pℓ3 q and X lie on a circle.
Prove that there is a unique point P such that f pℓq “ P for any line ℓ passing through P .
(Australia)
Common remarks. The condition on f is equivalent to the following: There is some function g that assigns to each point X a circle gpXq passing through X such that for any line ℓ
passing through X, the point f pℓq lies on gpXq. (The function g may not be uniquely deﬁned
for all points, if some points X have at most one value of f pℓq other than X; for such points,
an arbitrary choice is made.)
If there were two points P and Q with the given property, f pP Qq would have to be both
P and Q, so there is at most one such point, and it will suﬃce to show that such a point exists.
Solution 1. We provide a complete characterisation of the functions satisfying the given
condition.
Write =pℓ1 , ℓ2 q for the directed angle modulo 180˝ between the lines ℓ1 and ℓ2 . Given a
point P and an angle α P p0, 180˝ q, for each line ℓ, let ℓ1 be the line through P satisfying
=pℓ1 , ℓq “ α, and let hP,α pℓq be the intersection point of ℓ and ℓ1 . We will prove that there is
some pair pP, αq such that f and hP,α are the same function. Then P is the unique point in
the problem statement.
Given an angle α and a point P , let a line ℓ be called pP, αq-good if f pℓq “ hP,α pℓq. Let
a point X ‰ P be called pP, αq-good if the circle gpXq passes through P and some point
Y ‰ P, X on gpXq satisﬁes =pP Y, Y Xq “ α. It follows from this deﬁnition that if X is pP, αqgood then every point Y ‰ P, X of gpXq satisﬁes this angle condition, so hP,α pXY q “ Y for
every Y P gpXq. Equivalently, f pℓq P tX, hP,α pℓqu for each line ℓ passing through X. This
shows the following lemma.
Lemma 1. If X is pP, αq-good and ℓ is a line passing through X then either f pℓq “ X or ℓ is
pP, αq-good.
Lemma 2. If X and Y are diﬀerent pP, αq-good points, then line XY is pP, αq-good.

Proof. If XY is not pP, αq-good then by the previous Lemma, f pXY q “ X and similarly
f pXY q “ Y , but clearly this is impossible as X ‰ Y .
l
Lemma 3. If ℓ1 and ℓ2 are diﬀerent pP, αq-good lines which intersect at X ‰ P , then either
f pℓ1 q “ X or f pℓ2 q “ X or X is pP, αq-good.

Proof. If f pℓ1 q, f pℓ2 q ‰ X, then gpXq is the circumcircle of X, f pℓ1 q and f pℓ2 q. Since ℓ1 and ℓ2
are pP, αq-good lines, the angles
=pP f pℓ1 q, f pℓ1 qXq “ =pP f pℓ2 q, f pℓ2 qXq “ α,
so P lies on gpXq. Hence, X is pP, αq-good.

l

Lemma 4. If ℓ1 , ℓ2 and ℓ3 are diﬀerent pP, αq-good lines which intersect at X ‰ P , then X is
pP, αq-good.
Proof. This follows from the previous Lemma since at most one of the three lines ℓi can satisfy
f pℓi q “ X as the three lines are all pP, αq-good.
l

Lemma 5. If ABC is a triangle such that A, B, C, f pABq, f pACq and f pBCq are all diﬀerent
points, then there is some point P and some angle α such that A, B and C are pP, αq-good
points and AB, BC and CA are pP, αq-good lines.

Shortlisted problems – solutions

77

gpAq

A
E
gpCq

gpBq
F
B

P
D

C

Proof. Let D, E, F denote the points f pBCq, f pACq, f pABq, respectively. Then gpAq,
gpBq and gpCq are the circumcircles of AEF , BDF and CDE, respectively. Let P ‰ F
be the second intersection of circles gpAq and gpBq (or, if these circles are tangent at F , then
P “ F ). By Miquel’s theorem (or an easy angle chase), gpCq also passes through P . Then by
the cyclic quadrilaterals, the directed angles
=pP D, DCq “ =pP F, F Bq “ =pP E, EAq “ α,
for some angle α. Hence, lines AB, BC and CA are all pP, αq-good, so by Lemma 3, A, B and C
are pP, αq-good. (In the case where P “ D, the line P D in the equation above denotes the line
which is tangent to gpBq at P “ D. Similar deﬁnitions are used for P E and P F in the cases
where P “ E or P “ F .)
l
Consider the set Ω of all points px, yq with integer coordinates 1 ď x, y ď 1000, and consider
the set LΩ of all horizontal, vertical and diagonal lines passing through at least one point in Ω.
A simple counting argument shows that there are 5998 lines in LΩ . For each line ℓ in LΩ we
colour the point f pℓq red. Then there are at most 5998 red points. Now we partition the points
in Ω into 10000 ten by ten squares. Since there are at most 5998 red points, at least one of
these squares Ω10 contains no red points. Let pm, nq be the bottom left point in Ω10 . Then the
triangle with vertices pm, nq, pm ` 1, nq and pm, n ` 1q satisﬁes the condition of Lemma 5, so
these three vertices are all pP, αq-good for some point P and angle α, as are the lines joining
them. From this point on, we will simply call a point or line good if it is pP, αq-good for this
particular pair pP, αq. Now by Lemma 1, the line x “ m ` 1 is good, as is the line y “ n ` 1.
Then Lemma 3 implies that pm`1, n`1q is good. By applying these two lemmas repeatedly, we
can prove that the line x ` y “ m ` n ` 2 is good, then the points pm, n ` 2q and pm ` 2, nq then
the lines x “ m`2 and y “ n`2, then the points pm`2, n`1q, pm`1, n`2q and pm`2, n`2q
and so on until we have prove that all points in Ω10 are good.
Now we will use this to prove that every point S ‰ P is good. Since gpSq is a circle, it
passes through at most two points of Ω10 on any vertical line, so at most 20 points in total.
Moreover, any line ℓ through S intersects at most 10 points in Ω10 . Hence, there are at least
eight lines ℓ through S which contain a point Q in Ω10 which is not on gpSq. Since Q is not
on gpSq, the point f pℓq ‰ Q. Hence, by Lemma 1, the line ℓ is good. Hence, at least eight good
lines pass through S, so by Lemma 4, the point S is good. Hence, every point S ‰ P is good,
so by Lemma 2, every line is good. In particular, every line ℓ passing through P is good, and
therefore satisﬁes f pℓq “ P , as required.
Solution 2. Note that for any distinct points X, Y , the circles gpXq and gpY q meet on XY
at the point f pXY q P gpXq X gpY q X pXY q. We write spX, Y q for the second intersection point
of circles gpXq and gpY q.
Lemma 1. Suppose that X, Y and Z are not collinear, and that f pXY q R tX, Y u and similarly
for Y Z and ZX. Then spX, Y q “ spY, Zq “ spZ, Xq.
Proof. The circles gpXq, gpY q and gpZq through the vertices of triangle XY Z meet pairwise on
the corresponding edges (produced). By Miquel’s theorem, the second points of intersection of
any two of the circles coincide. (See the diagram for Lemma 5 of Solution 1.)
l

78

Bath — UK, 11th–22nd July 2019

Now pick any line ℓ and any six diﬀerent points Y1 , . . . , Y6 on ℓ z tf pℓqu. Pick a point X
not on ℓ or any of the circles gpYi q. Reordering the indices if necessary, we may suppose that
Y1 , . . . , Y4 do not lie on gpXq, so that f pXYi q R tX, Yi u for 1 ď i ď 4. By applying the above
lemma to triangles XYi Yj for 1 ď i ă j ď 4, we ﬁnd that the points spYi , Yj q and spX, Yi q are
all equal, to point O say. Note that either O does not lie on ℓ, or O “ f pℓq, since O P gpYiq.
Now consider an arbitrary point X 1 not on ℓ or any of the circles gpYi q for 1 ď i ď 4. As
above, we see that there are two indices 1 ď i ă j ď 4 such that Yi and Yj do not lie on gpX 1q.
By applying the above lemma to triangle X 1 Yi Yj we see that spX 1 , Yi q “ O, and in particular
gpX 1 q passes through O.
We will now show that f pℓ1 q “ O for all lines ℓ1 through O. By the above note, we may
assume that ℓ1 ‰ ℓ. Consider a variable point X 1 P ℓ1 z tOu not on ℓ or any of the circles gpYi q
for 1 ď i ď 4. We know that f pℓ1 q P gpX 1q X ℓ1 “ tX 1 , Ou. Since X 1 was suitably arbitrary, we
have f pℓ1 q “ O as desired.
Solution 3. Notice that, for any two diﬀerent points X and Y , the point f pXY q lies on both
gpXq and gpY q, so any two such circles meet in at least one point. We refer to two circles as
cutting only in the case where they cross, and so meet at exactly two points, thus excluding
the cases where they are tangent or are the same circle.
Lemma 1. Suppose there is a point P such that all circles gpXq pass through P . Then P has
the given property.
Proof. Consider some line ℓ passing through P , and suppose that f pℓq ‰ P . Consider some X P ℓ
with X ‰ P and X ‰ f pℓq. Then gpXq passes through all of P , f pℓq and X, but those three
points are collinear, a contradiction.
l
Lemma 2. Suppose that, for all ǫ ą 0, there is a point Pǫ with gpPǫq of radius at most ǫ. Then
there is a point P with the given property.
Proof. Consider a sequence ǫi “ 2´i and corresponding points Pǫi . Because the two
ř circles
1´i
1´j
gpPǫi q and gpPǫj q meet, the distance between Pǫi and Pǫj is at most 2 ` 2 . As i ǫi converges, these points converge to some point P . For all ǫ ą 0, the point P has distance at
most 2ǫ from Pǫ , and all circles gpXq pass through a point with distance at most 2ǫ from Pǫ ,
so distance at most 4ǫ from P . A circle that passes distance at most 4ǫ from P for all ǫ ą 0
must pass through P , so by Lemma 1 the point P has the given property.
l
Lemma 3. Suppose no two of the circles gpXq cut. Then there is a point P with the given
property.
Proof. Consider a circle gpXq with centre Y . The circle gpY q must meet gpXq without cutting
it, so has half the radius of gpXq. Repeating this argument, there are circles with arbitrarily
small radius and the result follows by Lemma 2.
l
Lemma 4. Suppose there are six diﬀerent points A, B1 , B2 , B3 , B4 , B5 such that no three
are collinear, no four are concyclic, and all the circles gpBi q cut pairwise at A. Then there is a
point P with the given property.
Proof. Consider some line ℓ through A that does not pass through any of the Bi and is not
tangent to any of the gpBi q. Fix some direction along that line, and let Xǫ be the point on ℓ
that has distance ǫ from A in that direction. In what follows we consider only those ǫ for which
Xǫ does not lie on any gpBi q (this restriction excludes only ﬁnitely many possible values of ǫ).
Consider the circle gpXǫ q. Because no four of the Bi are concyclic, at most three of them
lie on this circle, so at least two of them do not. There must be some sequence of ǫ Ñ 0 such
that it is the same two of the Bi for all ǫ in that sequence, so now restrict attention to that
sequence, and suppose without loss of generality that B1 and B2 do not lie on gpXǫ q for any ǫ
in that sequence.

Shortlisted problems – solutions

79

Then f pXǫ B1 q is not B1 , so must be the other point of intersection of Xǫ B1 with gpB1 q,
and the same applies with B2 . Now consider the three points Xǫ , f pXǫ B1 q and f pXǫ B2 q. As
ǫ Ñ 0, the angle at Xǫ tends to =B1 AB2 or 180˝ ´ =B1 AB2 , which is not 0 or 180˝ because
no three of the points were collinear. All three distances between those points are bounded
above by constant multiples of ǫ (in fact, if the triangle is scaled by a factor of 1{ǫ, it tends to
a ﬁxed triangle). Thus the circumradius of those three points, which is the radius of gpXǫ q, is
also bounded above by a constant multiple of ǫ, and so the result follows by Lemma 2.
l
Lemma 5. Suppose there are two points A and B such that gpAq and gpBq cut. Then there is
a point P with the given property.
Proof. Suppose that gpAq and gpBq cut at C and D. One of those points, without loss of
generality C, must be f pABq, and so lie on the line AB. We now consider two cases, according
to whether D also lies on that line.
Case 1: D does not lie on that line.
In this case, consider a sequence of Xǫ at distance ǫ from D, tending to D along some line
that is not a tangent to either circle, but perturbed slightly (by at most ǫ2 ) to ensure that no
three of the points A, B and Xǫ are collinear and no four are concyclic.
Consider the points f pXǫ Aq and f pXǫ Bq, and the circles gpXǫ q on which they lie. The
point f pXǫ Aq might be either A or the other intersection of Xǫ A with the circle gpAq, and the
same applies for B. If, for some sequence of ǫ Ñ 0, both those points are the other point of
intersection, the same argument as in the proof of Lemma 4 applies to ﬁnd arbitrarily small
circles. Otherwise, we have either inﬁnitely many of those circles passing through A, or inﬁnitely
many passing through B; without loss of generality, suppose inﬁnitely many through A.
We now show we can ﬁnd ﬁve points Bi satisfying the conditions of Lemma 4 (together
with A). Let B1 be any of the Xǫ for which gpXǫ q passes through A. Then repeat the following
four times, for 2 ď i ď 5.
Consider some line ℓ “ Xǫ A (diﬀerent from those considered for previous i) that is not
tangent to any of the gpBj q for j ă i, and is such that f pℓq “ A, so gpY q passes through A
for all Y on that line. If there are arbitrarily small circles gpY q we are done by Lemma 2, so
the radii of such circles must be bounded below. But as Y Ñ A, along any line not tangent
to gpBj q, the radius of a circle through Y and tangent to gpBj q at A tends to 0. So there must
be some Y such that gpY q cuts gpBj q at A rather than being tangent to it there, for all of the
previous Bj , and we may also pick it such that no three of the Bi and A are collinear and no
four are concyclic. Let Bi be this Y . Now the result follows by Lemma 4.
Case 2: D does lie on that line.
In this case, we follow a similar argument, but the sequence of Xǫ needs to be slightly
diﬀerent. C and D both lie on the line AB, so one must be A and the other must be B.
Consider a sequence of Xǫ tending to B. Rather than tending to B along a straight line (with
small perturbations), let the sequence be such that all the points are inside the two circles, with
the angle between Xǫ B and the tangent to gpBq at B tending to 0.
Again consider the points f pXǫ Aq and f pXǫ Bq. If, for some sequence of ǫ Ñ 0, both those
points are the other point of intersection with the respective circles, we see that the angle at Xǫ
tends to the angle between AB and the tangent to gpBq at B, which is not 0 or 180˝ , while the
distances tend to 0 (although possibly slower than any multiple of ǫ), so we have arbitrarily
small circumradii and the result follows by Lemma 2. Otherwise, we have either inﬁnitely many
of the circles gpXǫ q passing through A, or inﬁnitely many passing through B, and the same
argument as in the previous case enables us to reduce to Lemma 4.
l
Lemmas 3 and 5 together cover all cases, and so the required result is proved.

80

Bath — UK, 11th–22nd July 2019

Comment. From the property that all circles gpXq pass through the same point P , it is possible to
deduce that the function f has the form given in Solution 1. For any line ℓ not passing through P we
may define a corresponding angle αpℓq, which we must show is the same for all such lines. For any
point X ‰ P , with at least one line ℓ through X and not through P , such that f pℓq ‰ X, this angle
must be equal for all such lines through X (by (directed) angles in the same segment of gpXq).
Now consider all horizontal and all vertical lines not through P . For any pair consisting of a
horizontal line ℓ1 and a vertical line ℓ2 , we have αpℓ1 q “ αpℓ2 q unless f pℓ1 q or f pℓ2 q is the point of
intersection of those lines. Consider the bipartite graph whose vertices are those lines and where an
edge joins a horizontal and a vertical line with the same value of α. Considering a subgraph induced
by n horizontal and n vertical lines, it must have at least n2 ´ 2n edges, so some horizontal line has
edges to at least n ´ 2 of the vertical lines. Thus, in the original graph, all but at most two of the
vertical lines have the same value of α, and likewise all but at most two of the horizontal lines have
the same value of α, and, restricting attention to suitable subsets of those lines, we see that this value
must be the same for the vertical lines and for the horizontal lines.
But now we can extend this to all vertical and horizontal lines not through P (and thus to lines
in other directions as well, since the only requirement for ‘vertical’ and ‘horizontal’ above is that they
are any two nonparallel directions). Consider any horizontal line ℓ1 not passing through P , and we
wish to show that αpℓ1 q has the same value α it has for all but at most two lines not through P in any
direction. Indeed, we can deduce this by considering the intersection with any but at most five of the
vertical lines: the only ones to exclude are the one passing through P , the one passing through f pℓ1 q,
at most two such that αpℓq ‰ α, and the one passing through hP,α pℓ1 q (defined as in Solution 1). So
all lines ℓ not passing through P have the same value of αpℓq.

Solution 4. For any point X, denote by tpXq the line tangent to gpXq at X; notice that
f ptpXqq “ X, so f is surjective.
Step 1: We find a point P for which there are at least two different lines p1 and p2 such that
f ppi q “ P .
Choose any point X. If X does not have this property, take any Y P gpXq z tXu; then
f pXY q “ Y . If Y does not have the property, tpY q “ XY , and the circles gpXq and gpY q meet
again at some point Z. Then f pXZq “ Z “ f pY Zq, so Z has the required property.
We will show that P is the desired point. From now on, we ﬁx two diﬀerent lines p1
and p2 with f pp1 q “ f pp2 q “ P . Assume for contradiction that f pℓq “ Q ‰ P for some line ℓ
through P . We ﬁx ℓ, and note that Q P gpP q.
Step 2: We prove that P P gpQq.

Take an arbitrary point X P ℓ z tP, Qu. Two cases are possible for the position of tpXq
in relation to the pi ; we will show that each case (and subcase) occurs for only ﬁnitely many
positions of X, yielding a contradiction.
Case 2.1: tpXq is parallel to one of the pi ; say, to p1 .
Let tpXq cross p2 at R. Then gpRq is the circle pP RXq, as f pRP q “ P and f pRXq “ X.
Let RQ cross gpRq again at S. Then f pRQq P tR, Su X gpQq, so gpQq contains one of the
points R and S.
If R P gpQq, then R is one of ﬁnitely many points in the intersection gpQq X p2 , and each of
them corresponds to a unique position of X, since RX is parallel to p1 .
If S P gpQq, then =pQS, SP q “ =pRS, SP q “ =pRX, XP q “ =pp1 , ℓq, so =pQS, SP q is
constant for all such points X, and all points S obtained in such a way lie on one circle γ
passing through P and Q. Since gpQq does not contain P , it is diﬀerent from γ, so there are
only ﬁnitely many points S. Each of them uniquely determines R and thus X.

Shortlisted problems – solutions

81
p2
R
ℓ
X

Q

tpXq

P
gpXq

p1
S
gpRq

So, Case 2.1 can occur for only ﬁnitely many points X.
Case 2.2: tpXq crosses p1 and p2 at R1 and R2 , respectively.
Clearly, R1 ‰ R2 , as tpXq is the tangent to gpXq at X, and gpXq meets ℓ only at X and Q.
Notice that gpRi q is the circle pP XRi q. Let Ri Q meet gpRi q again at Si ; then Si ‰ Q, as gpRi q
meets ℓ only at P and X. Then f pRi Qq P tRi , Si u, and we distinguish several subcases.
p2
R2
S1

ℓ
X

Q

gpXq

P
S2
gpR2 q

R1

p1
tpXq

gpR1 q
Subcase 2.2.1: f pR1 Qq “ S1 , f pR2 Qq “ S2 ; so S1 , S2 P gpQq.

In this case we have 0 “ =pR1 X, XP q ` =pXP, R2 Xq “ =pR1 S1 , S1 P q ` =pS2 P, S2R2 q “
=pQS1 , S1 P q ` =pS2 P, S2 Qq, which shows P P gpQq.
Subcase 2.2.2: f pR1 Qq “ R1 , f pR2 Qq “ R2 ; so R1 , R2 P gpQq.

This can happen for at most four positions of X – namely, at the intersections of ℓ with a
line of the form K1 K2 , where Ki P gpQq X pi .

82

Bath — UK, 11th–22nd July 2019

Subcase 2.2.3: f pR1 Qq “ S1 , f pR2 Qq “ R2 (the case f pR1 Qq “ R1 , f pR2 Qq “ S2 is similar).
In this case, there are at most two possible positions for R2 – namely, the meeting points
of gpQq with p2 . Consider one of them. Let X vary on ℓ. Then R1 is the projection of X to p1
via R2 , S1 is the projection of R1 to gpQq via Q. Finally, =pQS1 , S1 Xq “ =pR1 S1 , S1 Xq “
=pR1 P, P Xq “ =pp1 , ℓq ‰ 0, so X is obtained by a ﬁxed projective transform gpQq Ñ ℓ from S1 .
So, if there were three points X satisfying the conditions of this subcase, the composition of the
three projective transforms would be the identity. But, if we apply it to X “ Q, we successively
get some point R11 , then R2 , and then some point diﬀerent from Q, a contradiction.
Thus Case 2.2 also occurs for only ﬁnitely many points X, as desired.
Step 3: We show that f pP Qq “ P , as desired.
The argument is similar to that in Step 2, with the roles of Q and X swapped. Again, we
show that there are only ﬁnitely many possible positions for a point X P ℓ z tP, Qu, which is
absurd.
Case 3.1: tpQq is parallel to one of the pi ; say, to p1 .
Let tpQq cross p2 at R; then gpRq is the circle pP RQq. Let RX cross gpRq again at S. Then
f pRXq P tR, Su X gpXq, so gpXq contains one of the points R and S.
p2
R
ℓ
X

Q

P

tpQq

S
p1
gpRq
gpQq

Subcase 3.1.1: S “ f pRXq P gpXq.
We have =ptpXq, QXq “ =pSX, SQq “ =pSR, SQq “ =pP R, P Qq “ =pp2 , ℓq. Hence
tpXq k p2 . Now we recall Case 2.1: we let tpXq cross p1 at R1 , so gpR1 q “ pP R1 Xq, and let R1 Q
meet gpR1 q again at S 1 ; notice that S 1 ‰ Q. Excluding one position of X, we may assume that
R1 R gpQq, so R1 ‰ f pR1 Qq. Therefore, S 1 “ f pR1 Qq P gpQq. But then, as in Case 2.1, we get
=ptpQq, P Qq “ =pQS 1 , S 1P q “ =pR1 X, XP q “ =pp2 , ℓq. This means that tpQq is parallel to p2 ,
which is impossible.
Subcase 3.1.2: R “ f pRXq P gpXq.
In this case, we have =ptpXq, ℓq “ =pRX, RQq “ =pRX, p1 q. Again, let R1 “ tpXqXp1 ; this
point exists for all but at most one position of X. Then gpR1 q “ pR1 XP q; let R1 Q meet gpR1q
again at S 1 . Due to =pR1 X, XRq “ =pQX, QRq “ =pℓ, p1 q, R1 determines X in at most two
ways, so for all but ﬁnitely many positions of X we have R1 R gpQq. Therefore, for those
positions we have S 1 “ f pR1 Qq P gpQq. But then =pRX, p1 q “ =pR1 X, XP q “ =pR1 S 1 , S 1 P q “
=pQS 1 , S 1 P q “ =ptpQq, QP q is ﬁxed, so this case can hold only for one speciﬁc position of X
as well.
Thus, in Case 3.1, there are only ﬁnitely many possible positions of X, yielding a contradiction.

Shortlisted problems – solutions

83

Case 3.2: tpQq crosses p1 and p2 at R1 and R2 , respectively.
By Step 2, R1 ‰ R2 . Notice that gpRi q is the circle pP QRi q. Let Ri X meet gpRi q at Si ;
then Si ‰ X. Then f pRi Xq P tRi , Si u, and we distinguish several subcases.
gpR2 q

p2
R2

S1

ℓ
Q
X

P

S2
gpQq
R1

p1
tpQq

gpR1 q
Subcase 3.2.1: f pR1 Xq “ S1 and f pR2 Xq “ S2 , so S1 , S2 P gpXq.
As in Subcase 2.2.1, we have 0 “ =pR1 Q, QP q`=pQP, R2 Qq “ =pXS1 , S1 P q`=pS2 P, S2Xq,
which shows P P gpXq. But X, Q P gpXq as well, so gpXq meets ℓ at three distinct points,
which is absurd.
Subcase 3.2.2: f pR1 Xq “ R1 , f pR2 Xq “ R2 , so R1 , R2 P gpXq.
Now three distinct collinear points R1 , R2 , and Q belong to gpXq, which is impossible.
Subcase 3.2.3: f pR1 Xq “ S1 , f pR2 Xq “ R2 (the case f pR1 Xq “ R1 , f pR2 Xq “ S2 is similar).
We have =pXR2 , R2 Qq “ =pXS1 , S1 Qq “ =pR1 S1 , S1 Qq “ =pR1 P, P Qq “ =pp1 , ℓq, so this
case can occur for a unique position of X.
Thus, in Case 3.2, there is only a unique position of X, again yielding the required contradiction.

84

Bath — UK, 11th–22nd July 2019

Number Theory
N1.

Find all pairs pm, nq of positive integers satisfying the equation
p2n ´ 1qp2n ´ 2qp2n ´ 4q ¨ ¨ ¨ p2n ´ 2n´1 q “ m!

p1q
(El Salvador)

Answer: The only such pairs are p1, 1q and p3, 2q.
Common remarks. In all solutions, for any prime p and positive integer N, we will denote
by vp pNq the exponent of the largest power of p that divides N. The left-hand side of p1q will
be denoted by Ln ; that is, Ln “ p2n ´ 1qp2n ´ 2qp2n ´ 4q ¨ ¨ ¨ p2n ´ 2n´1 q.
Solution 1. We will get an upper bound on n from the speed at which v2 pLn q grows.
From
Ln “ p2n ´ 1qp2n ´ 2q ¨ ¨ ¨ p2n ´ 2n´1 q “ 21`2`¨¨¨`pn´1q p2n ´ 1qp2n´1 ´ 1q ¨ ¨ ¨ p21 ´ 1q
we read

npn ´ 1q
.
2
On the other hand, v2 pm!q is expressed by the Legendre formula as
v2 pLn q “ 1 ` 2 ` ¨ ¨ ¨ ` pn ´ 1q “

v2 pm!q “

8 Y
ÿ
m]

i“1

2i

.

As usual, by omitting the ﬂoor functions,
v2 pm!q ă

8
ÿ
m

i“1

2i

“ m.

Thus, Ln “ m! implies the inequality
npn ´ 1q
ă m.
2

p2q

In order to obtain an opposite estimate, observe that
2

Ln “ p2n ´ 1qp2n ´ 2q ¨ ¨ ¨ p2n ´ 2n´1 q ă p2n qn “ 2n .
We claim that

˙
npn ´ 1q
! for n ě 6.
p3q
2 ă
2
`
˘
2
For n “ 6 the estimate p3q is true because 26 ă 6.9 ¨ 1010 and npn´1q
! “ 15! ą 1.3 ¨ 1012 .
2
For n ě 7 we prove p3q by the following inequalities:
˙
ˆ
npn´1q
npn ´ 1q
npn ´ 1q
! “ 15! ¨ 16 ¨ 17 ¨ ¨ ¨
ą 236 ¨ 16 2 ´15
2
2
n2

ˆ

2

2

“ 22npn´1q´24 “ 2n ¨ 2npn´2q´24 ą 2n .

Shortlisted problems – solutions

85

Putting together p2q and p3q, for n ě 6 we get a contradiction, since
ˆ
˙
npn ´ 1q
n2
Ln ă 2 ă
! ă m! “ Ln .
2
Hence n ě 6 is not possible.
Checking manually the cases n ď 5 we ﬁnd
L1 “ 1 “ 1!,
L2 “ 6 “ 3!,
5! ă L3 “ 168 ă 6!,
7! ă L4 “ 20 160 ă 8!
and
10! ă L5 “ 9 999 360 ă 11!.
So, there are two solutions:

(
pm, nq P p1, 1q, p3, 2q .

Solution 2. Like in the previous solution, the cases n “ 1, 2, 3, 4 are checked manually. We
will exclude n ě 5 by considering the exponents of 3 and 31 in p1q.
For odd primes p and distinct integers a, b, coprime to p, with p | a ´ b, the Lifting The
Exponent lemma asserts that
vp pak ´ bk q “ vp pa ´ bq ` vp pkq.
Notice that 3 divides 2k ´ 1 if only if k is even; moreover, by the Lifting The Exponent lemma
we have
v3 p22k ´ 1q “ v3 p4k ´ 1q “ 1 ` v3 pkq “ v3 p3kq.
Hence,
v3 pLn q “

ÿ

2kďn

v3 p4k ´ 1q “

ÿ

kďt n
u
2

v3 p3kq.

˘
`
Notice that the last expression is precisely the exponent of 3 in the prime factorisation of 3t n2 u !.
Therefore
˙
ˆ´
X n \¯
v3 pm!q “ v3 pLn q “ v3 3 2 !
Z ^
Z ^
n
n
3
ďmď3
` 2.
(4)
2
2
Suppose that n ě 5. Note that every ﬁfth factor in Ln is divisible by 31 “ 25 ´ 1, and hence
we have v31 pLn q ě t n5 u. Then
8 Y
8
Yn]
ÿ
m] ÿ m
m
n
ď v31 pLn q “ v31 pm!q “
ă
ď
“ .
k
k
10
5
31
31
30
k“1
k“1

By combining p4q and p5q,

3n ă m ď

p5q

3n
`2
2

so n ă 34 which is inconsistent with the inequality n ě 5.
Comment 1. There are many combinations of the ideas above; for example combining p2q and p4q
also provides n ă 5. Obviously, considering the exponents of any two primes in p1q, or considering one
prime and the magnitude orders lead to an upper bound on n and m.

86

Bath — UK, 11th–22nd July 2019

Comment 2. This problem has a connection to group theory. Indeed, the left-hand side is the
order of the group GLn pF2 q of invertible n-by-n matrices with entries modulo 2, while the right-hand
side is the order of the symmetric group Sm on m elements. The result thus shows that the only
possible isomorphisms between these groups are GL1 pF2 q – S1 and GL2 pF2 q – S3 , and there are in
fact isomorphisms in both cases. In general, GLn pF2 q is a simple group for n ě 3, as it is isomorphic
to P SLn pF2 q.
There is also a near-solution of interest: the left-hand side for n “ 4 is half of the right-hand side
when m “ 8; this turns out to correspond to an isomorphism GL4 pF2 q – A8 with the alternating group
on eight elements.
However, while this indicates that the problem is a useful one, knowing group theory is of no use
in solving it!

Shortlisted problems – solutions

N2.

87

Find all triples pa, b, cq of positive integers such that a3 ` b3 ` c3 “ pabcq2 .
(Nigeria)

Answer: The solutions are p1, 2, 3q and its permutations.
Common remarks. Note that the equation is symmetric. In all solutions, we will assume
without loss of generality that a ě b ě c, and prove that the only solution is pa, b, cq “ p3, 2, 1q.
The ﬁrst two solutions all start by proving that c “ 1.
Solution 1. We will start by proving that c “ 1. Note that
3a3 ě a3 ` b3 ` c3 ą a3 .
So 3a3 ě pabcq2 ą a3 and hence 3a ě b2 c2 ą a. Now b3 ` c3 “ a2 pb2 c2 ´ aq ě a2 , and so
18b3 ě 9pb3 ` c3 q ě 9a2 ě b4 c4 ě b3 c5 ,
so 18 ě c5 which yields c “ 1.
Now, note that we must have a ą b, as otherwise we would have 2b3 ` 1 “ b4 which has no
positive integer solutions. So
a3 ´ b3 ě pb ` 1q3 ´ b3 ą 1
and
2a3 ą 1 ` a3 ` b3 ą a3 ,

which implies 2a3 ą a2 b2 ą a3 and so 2a ą b2 ą a. Therefore
4p1 ` b3 q “ 4a2 pb2 ´ aq ě 4a2 ą b4 ,
so 4 ą b3 pb ´ 4q; that is, b ď 4.
Now, for each possible value of b with 2 ď b ď 4 we obtain a cubic equation for a with
constant coeﬃcients. These are as follows:
b“2:
b“3:
b“4:

a3 ´ 4a2 ` 9 “ 0
a3 ´ 9a2 ` 28 “ 0
a3 ´ 16a2 ` 65 “ 0.

The only case with an integer solution for a with b ď a is b “ 2, leading to pa, b, cq “ p3, 2, 1q.
Comment 1.1. Instead of writing down each cubic equation explicitly, we could have just observed
that a2 | b3 ` 1, and for each choice of b checked each square factor of b3 ` 1 for a2 .
We could also have observed that, with c “ 1, the relation 18b3 ě b4 c4 becomes b ď 18, and we
can simply check all possibilities for b (instead of working to prove that b ď 4). This check becomes
easier after using the factorisation b3 ` 1 “ pb ` 1qpb2 ´ b ` 1q and observing that no prime besides 3
can divide both of the factors.
Comment 1.2. Another approach to finish the problem after establishing that c ď 1 is to set
k “ b2 c2 ´ a, which is clearly an integer and must be positive as it is equal to pb3 ` c3 q{a2 . Then we
divide into cases based on whether k “ 1 or k ě 2; in the first case, we have b3 ` 1 “ a2 “ pb2 ´ 1q2
whose only positive root is b “ 2, and in the second case we have b2 ď 3a, and so
9
9
b4 ď p3aq2 ď pka2 q “ pb3 ` 1q,
2
2
which implies that b ď 4.

88

Bath — UK, 11th–22nd July 2019

Solution 2. Again, we will start by proving that c “ 1. Suppose otherwise a
that c ě 2. We
have a3 ` b3 ` c3 ď 3a3 , so b2 c2 ď 3a. Since c ě 2, this tells us that b ď 3a{4. As the
right-hand side of the original equation is a multiple of a2 , we have a2 ď 2b3 ď 2p3a{4q3{2 . In
other words, a ď 27
ă 2, which contradicts the assertion that a ě c ě 2. So there are no
16
solutions in this case, and so we must have c “ 1.
Now, the original equation becomes a3 ` b3 ` 1 “ a2 b2 . Observe that a ě 2, since otherwise
a “ b “ 1 as a ě b.
The right-hand side is a multiple of a2 , so the left-hand side must be as well. Thus, b3 ` 1 ě
a2 . Since a ě b, we also have
b3 ` 1
1
b2 “ a `
ď
2a
`
a2
a2
and so b2 ď 2a since b2 is an integer. Thus p2aq3{2 ` 1 ě b3 ` 1 ě a2 , from which we deduce
a ď 8.
Now, for each possible value of a with 2 ď a ď 8 we obtain a cubic equation for b with
constant coeﬃcients. These are as follows:
a“2:
a“3:
a“4:
a“5:
a“6:
a“7:
a“8:

b3 ´ 4b2 ` 9 “ 0
b3 ´ 9b2 ` 28 “ 0
b3 ´ 16b2 ` 65 “ 0
b3 ´ 25b2 ` 126 “ 0
b3 ´ 36b2 ` 217 “ 0
b3 ´ 49b2 ` 344 “ 0
b3 ´ 64b2 ` 513 “ 0.

The only case with an integer solution for b with a ě b is a “ 3, leading to pa, b, cq “ p3, 2, 1q.
Comment 2.1. As in Solution 1, instead of writing down each cubic equation explicitly, we could
have just observed that b2 | a3 ` 1, and for each choice of a checked each square factor of a3 ` 1 for b2 .
Comment 2.2. This solution does not require initially proving that c “ 1, in which case the bound
would become a ď 108. The resulting cases could, in principle, be checked by a particularly industrious
student.

Solution 3. Set k “ pb3 ` c3 q{a2 ď 2a, and rewrite the original equation as a ` k “ pbcq2 .
Since b3 and c3 are positive integers, we have pbcq3 ě b3 ` c3 ´ 1 “ ka2 ´ 1, so
a ` k ě pka2 ´ 1q2{3 .
As in Comment 1.2, k is a positive integer; for each value of k ě 1, this gives us a polynomial
inequality satisﬁed by a:
k 2 a4 ´ a3 ´ 5ka2 ´ 3k 2 a ´ pk 3 ´ 1q ď 0.
We now prove that a ď 3. Indeed,
0ě

k 2 a4 ´ a3 ´ 5ka2 ´ 3k 2 a ´ pk 3 ´ 1q
ě a4 ´ a3 ´ 5a2 ´ 3a ´ k ě a4 ´ a3 ´ 5a2 ´ 5a,
k2

which fails when a ě 4.
This leaves ten triples with 3 ě a ě b ě c ě 1, which may be checked manually to give
pa, b, cq “ p3, 2, 1q.

Shortlisted problems – solutions

89

Solution 4. Again, observe that b3 ` c3 “ a2 pb2 c2 ´ aq, so b ď a ď b2 c2 ´ 1.
We consider the function f pxq “ x2 pb2 c2 ´ xq. It can be seen that that on the interval
r0, b2 c2 ´ 1s the function f is increasing if x ă 32 b2 c2 and decreasing if x ą 23 b2 c2 . Consequently,
it must be the case that
´
¯
b3 ` c3 “ f paq ě min f pbq, f pb2 c2 ´ 1q .
First, suppose that b3 ` c3 ě f pb2 c2 ´ 1q. This may be written b3 ` c3 ě pb2 c2 ´ 1q2 , and so
2b3 ě b3 ` c3 ě pb2 c2 ´ 1q2 ą b4 c4 ´ 2b2 c2 ě b4 c4 ´ 2b3 c4 .
Thus, pb ´ 2qc4 ă 2, and the only solutions to this inequality have pb, cq “ p2, 2q or b ď 3 and
c “ 1. It is easy to verify that the only case giving a solution for a ě b is pa, b, cq “ p3, 2, 1q.
Otherwise, suppose that b3 ` c3 “ f paq ě f pbq. Then, we have
2b3 ě b3 ` c3 “ a2 pb2 c2 ´ aq ě b2 pb2 c2 ´ bq.
Consequently bc2 ď 3, with strict inequality in the case that b ‰ c. Hence c “ 1 and b ď 2.
Both of these cases have been considered already, so we are done.
Comment 4.1. Instead of considering which of f pbq and f pb2 c2 ´ 1q is less than f paq, we may also
proceed by explicitly dividing into cases based on whether a ě 32 b2 c2 or a ă 32 b2 c2 . The first case may
now be dealt with as follows. We have b3 c3 ` 1 ě b3 ` c3 as b3 and c3 are positive integers, so we have
4
b3 c3 ` 1 ě b3 ` c3 ě a2 ě b4 c4 .
9
This implies bc ď 2, and hence c “ 1 and b ď 2.

90

Bath — UK, 11th–22nd July 2019

N3.

We say that a set S of integers is rootiful if, for any positive integer n and any
a0 , a1 , . . . , an P S, all integer roots of the polynomial a0 ` a1 x ` ¨ ¨ ¨ ` an xn are also in S. Find
all rootiful sets of integers that contain all numbers of the form 2a ´ 2b for positive integers
a and b.
(Czech Republic)
Answer: The set Z of all integers is the only such rootiful set.
Solution 1. The set Z of all integers is clearly rootiful. We shall prove that any rootiful set S
containing all the numbers of the form 2a ´ 2b for a, b P Zą0 must be all of Z.
First, note that 0 “ 21 ´ 21 P S and 2 “ 22 ´ 21 P S. Now, ´1 P S, since it is a root of
2x ` 2, and 1 P S, since it is a root of 2x2 ´ x ´ 1. Also, if n P S then ´n is a root of x ` n, so
it suﬃces to prove that all positive integers must be in S.
Now, we claim that any positive integer n has a multiple in S. Indeed, suppose that n “ 2α ¨t
for α P Zě0 and t odd. Then t | 2φptq ´ 1, so n | 2α`φptq`1 ´ 2α`1 . Moreover, 2α`φptq`1 ´ 2α`1 P S,
and so S contains a multiple of every positive integer n.
We will now prove by induction that all positive integers are in S. Suppose that 0, 1, . . . , n´
1 P S; furthermore, let N be a multiple of n in S. Consider the base-n expansion of N, say
N “ ak nk `ak´1 nk´1 `¨ ¨ ¨`a1 n`a0 . Since 0 ď ai ă n for each ai , we have that all the ai are in S.
Furthermore, a0 “ 0 since N is a multiple of n. Therefore, ak nk ` ak´1nk´1 ` ¨ ¨ ¨ ` a1 n ´ N “ 0,
so n is a root of a polynomial with coeﬃcients in S. This tells us that n P S, completing the
induction.
Solution 2. As in the previous solution, we can prove that 0, 1 and ´1 must all be in any
rootiful set S containing all numbers of the form 2a ´ 2b for a, b P Zą0 .
We show that, in fact, every integer k with |k| ą 2 can be expressed as a root of a polynomial
whose coeﬃcients are of the form 2a ´ 2b . Observe that it suﬃces to consider the case where k
is positive, as if k is a root of an xn ` ¨ ¨ ¨ ` a1 x ` a0 “ 0, then ´k is a root of p´1qn an xn ` ¨ ¨ ¨ ´
a1 x ` a0 “ 0.
Note that
p2an ´ 2bn qk n ` ¨ ¨ ¨ ` p2a0 ´ 2b0 q “ 0
is equivalent to
2an k n ` ¨ ¨ ¨ ` 2a0 “ 2bn k n ` ¨ ¨ ¨ ` 2b0 .

Hence our aim is to show that two numbers of the form 2an k n ` ¨ ¨ ¨ ` 2a0 are equal, for a
ﬁxed value of n. We consider such polynomials where every term 2ai k i is at most 2k n ; in other
words, where 2 ď 2ai ď 2k n´i , or, equivalently, 1 ď ai ď 1 ` pn ´ iq log2 k. Therefore, there
must be 1 ` tpn ´ iq log2 ku possible choices for ai satisfying these constraints.
The number of possible polynomials is then
n
ź
i“0

p1 ` tpn ´ iq log2 kuq ě

n´1
ź
i“0

pn ´ iq log2 k “ n!plog2 kqn

where the inequality holds as 1 ` txu ě x.
As there are pn ` 1q such terms in the polynomial, each at most 2k n , such a polynomial
must have value at most 2k n pn ` 1q. However, for large n, we have n!plog2 kqn ą 2k n pn ` 1q.
Therefore there are more polynomials than possible values, so some two must be equal, as
required.

Shortlisted problems – solutions

91

N4.

Let Zą0 be the set of positive integers. A positive integer constant C is given. Find
all functions f : Zą0 Ñ Zą0 such that, for all positive integers a and b satisfying a ` b ą C,
a ` f pbq | a2 ` b f paq.

(˚)
(Croatia)

Answer: The functions satisfying (˚) are exactly the functions f paq “ ka for some constant
k P Zą0 (irrespective of the value of C).
Common remarks. It is easy to verify that the functions f paq “ ka satisfy (˚). Thus, in the
proofs below, we will only focus on the converse implication: that condition (˚) implies that
f “ ka.

A common minor part of these solutions is the derivation of some relatively easy bounds on
the function f . An upper bound is easily obtained by setting a “ 1 in (˚), giving the inequality
f pbq ď b ¨ f p1q
for all suﬃciently large b. The corresponding lower bound is only marginally more diﬃcult to
obtain: substituting b “ 1 in the original equation shows that
a ` f p1q | pa2 ` f paqq ´ pa ´ f p1qq ¨ pa ` f p1qq “ f p1q2 ` f paq
for all suﬃciently large a. It follows from this that one has the lower bound
f paq ě a ` f p1q ¨ p1 ´ f p1qq,
again for all suﬃciently large a.
Each of the following proofs makes use of at least one of these bounds.
Solution 1. First, we show that b | f pbq2 for all b. To do this, we choose a large positive
integer n so that nb ´ f pbq ě C. Setting a “ nb ´ f pbq in (˚) then shows that
nb | pnb ´ f pbqq2 ` bf pnb ´ f pbqq

so that b | f pbq2 as claimed.
Now in particular we have that p | f ppq for every prime p. If we write f ppq “ kppq ¨ p, then
the bound f ppq ď f p1q ¨ p (valid for p suﬃciently large) shows that some value k of kppq must
be attained for inﬁnitely many p. We will show that f paq “ ka for all positive integers a. To
do this, we substitute b “ p in (˚), where p is any suﬃciently large prime for which kppq “ k,
obtaining
a ` kp | pa2 ` pf paqq ´ apa ` kpq “ pf paq ´ pka.
For suitably large p we have gcdpa ` kp, pq “ 1, and hence we have
a ` kp | f paq ´ ka.
But the only way this can hold for arbitrarily large p is if f paq ´ ka “ 0. This concludes the
proof.
Comment. There are other ways to obtain the divisibility p | f ppq for primes p, which is all that
is needed in this proof. For instance, if f ppq were not divisible by p then the arithmetic progression
p2 ` bf ppq would attain prime values for infinitely many b by Dirichlet’s Theorem: hence, for these
pairs p, b, we would have p ` f pbq “ p2 ` bf ppq. Substituting a ÞÑ b and b ÞÑ p in (˚) then shows that
pf ppq2 ´ p2 qpp ´ 1q is divisible by b ` f ppq and hence vanishes, which is impossible since p ∤ f ppq by
assumption.

92

Bath — UK, 11th–22nd July 2019

Solution 2. First, we substitute b “ 1 in (˚) and rearrange to ﬁnd that
f paq ` f p1q2
a2 ` f paq
“ f p1q ´ a `
a ` f p1q
a ` f p1q

is a positive integer for suﬃciently large a. Since f paq ď af p1q, for all suﬃciently large a, it
p1q2
p1q2
follows that f paq`f
ď f p1q also and hence there is a positive integer k such that f paq`f
“k
a`f p1q
a`f p1q
for inﬁnitely many values of a. In other words,
f paq “ ka ` f p1q ¨ pk ´ f p1qq
for inﬁnitely many a.
Fixing an arbitrary choice of a in (˚), we have that
a2 ` bf paq
a ` kb ` f p1q ¨ pk ´ f p1qq

is an integer for inﬁnitely many b (the same b as above, maybe with ﬁnitely many exceptions).
On the other hand, for b taken suﬃciently large, this quantity becomes arbitrarily close to f paq
;
k
f paq
this is only possible if k is an integer and
a2 ` bf paq
f paq
“
a ` kb ` f p1q ¨ pk ´ f p1qq
k

for inﬁnitely many b. This rearranges to

˘
f paq `
¨ a ` f p1q ¨ pk ´ f p1qq “ a2 .
k

(˚˚)

Hence a2 is divisible by a ` f p1q ¨ pk ´ f p1qq, and hence so is f p1q2 pk ´ f p1qq2 . The only way
this can occur for all a is if k “ f p1q, in which case (˚˚) provides that f paq “ ka for all a, as
desired.
Solution 3. Fix any two distinct positive integers a and b. From (˚) it follows that the two
integers
pa2 ` cf paqq ¨ pb ` f pcqq and pb2 ` cf pbqq ¨ pa ` f pcqq

are both multiples of pa ` f pcqq ¨ pb ` f pcqq for all suﬃciently large c. Taking an appropriate
linear combination to eliminate the cf pcq term, we ﬁnd after expanding out that the integer
“ 2
‰
“
‰
“
‰
a f pbq ´ b2 f paq ¨ f pcq ` pb ´ aqf paqf pbq ¨ c ` abpaf pbq ´ bf paqq
(:)

is also a multiple of pa ` f pcqq ¨ pb ` f pcqq.
But as c varies, (:) is bounded above by a positive multiple of c while pa ` f pcqq ¨ pb ` f pcqq
is bounded below by a positive multiple of c2 . The only way that such a divisibility can hold
is if in fact
“ 2
‰
“
‰
“
‰
a f pbq ´ b2 f paq ¨ f pcq ` pb ´ aqf paqf pbq ¨ c ` abpaf pbq ´ bf paqq “ 0
(::)
for suﬃciently large c. Since the coeﬃcient of c in this linear relation is nonzero, it follows that
there are constants k, ℓ such that f pcq “ kc ` ℓ for all suﬃciently large c; the constants k and ℓ
are necessarily integers.
The value of ℓ satisﬁes
“ 2
‰
“
‰
a f pbq ´ b2 f paq ¨ ℓ ` abpaf pbq ´ bf paqq “ 0
(:::)

and hence b | ℓa2 f pbq for all a and b. Taking b suﬃciently large so that f pbq “ kb ` ℓ, we thus
have that b | ℓ2 a2 for all suﬃciently large b; this implies that ℓ “ 0. From (:::) it then follows
that f paq
“ f pbq
for all a ‰ b, so that there is a constant k such that f paq “ ka for all a (k is
a
b
equal to the constant deﬁned earlier).

Shortlisted problems – solutions

93

Solution 4. Let Γ denote the set of all points pa, f paqq, so that Γ is an inﬁnite subset of
the upper-right quadrant of the plane. For a point A “ pa, f paqq in Γ, we deﬁne a point
A1 “ p´f paq, ´f paq2 {aq in the lower-left quadrant of the plane, and let Γ1 denote the set of all
such points A1 .
C
A
B
O
B1
C1
A1
Claim. For any point A P Γ, the set Γ is contained in ﬁnitely many lines through the point A1 .
Proof. Let A “ pa, f paqq. The functional equation (with a and b interchanged) can be rewritten
as b ` f paq | af pbq ´ bf paq, so that all but ﬁnitely many points in Γ are contained in one of the
lines with equation
ay ´ f paqx “ mpx ` f paqq

for m an integer. Geometrically, these are the lines through A1 “ p´f paq, ´f paq2{aq with
. Since Γ is contained, with ﬁnitely many exceptions, in the region 0 ď y ď
gradient f paq`m
a
f p1q ¨ x and the point A1 lies strictly in the lower-left quadrant of the plane, there are only
ﬁnitely many values of m for which this line meets Γ. This concludes the proof of the claim.
l
1
1
Now consider any distinct points A, B P Γ. It is clear that A and B are distinct. A line
through A1 and a line through B 1 only meet in more than one point if these two lines are equal
to the line A1 B 1 . It then follows from the above claim that the line A1 B 1 must contain all but
ﬁnitely many points of Γ. If C is another point of Γ, then the line A1 C 1 also passes through all
but ﬁnitely many points of Γ, which is only possible if A1 C 1 “ A1 B 1 .
We have thus seen that there is a line ℓ passing through all points of Γ1 and through all
but ﬁnitely many points of Γ. We claim that this line passes through the origin O and passes
through every point of Γ. To see this, note that by construction A, O, A1 are collinear for every
point A P Γ. Since ℓ “ AA1 for all but ﬁnitely many points A P Γ, it thus follows that O P ℓ.
Thus any A P Γ lies on the line ℓ “ A1 O.
Since Γ is contained in a line through O, it follows that there is a real constant k (the
gradient of ℓ) such that f paq “ ka for all a. The number k is, of course, a positive integer.
Comment. Without the a ` b ą C condition, this problem is approachable by much more naive
methods. For instance, using the given divisibility for a, b P t1, 2, 3u one can prove by a somewhat
tedious case-check that f p2q “ 2f p1q and f p3q “ 3f p1q; this then forms the basis of an induction
establishing that f pnq “ nf p1q for all n.

94

Bath — UK, 11th–22nd July 2019

` ˘
Let a be a positive integer. We say that a positive integer b is a-good if an
´ 1 is
b
divisible by an ` 1 for all positive integers n with an ě b. Suppose b is a positive integer such
that b is a-good, but b ` 2 is not a-good. Prove that b ` 1 is prime.
(Netherlands)

N5.

Solution 1. For p a prime and n a nonzero integer, we write vp pnq for the p-adic valuation
of n: the largest integer t such that pt | n.
We ﬁrst show that b is a-good if and only `if b˘ is even, and p | a for all primes p ď b.
To start with, the condition that an ` 1 | an
´ 1 can be rewritten as saying that
b
anpan ´ 1q ¨ ¨ ¨ pan ´ b ` 1q
” 1 pmod an ` 1q.
b!

(1)

Suppose, on the one hand, there is a prime p ď b with p ∤ a. Take t “ vp pb!q. Then there
exist positive integers c such that ac ” 1 pmod pt`1 q. If we take c big enough, and then take
n “ pp ´ 1qc, then an “ app ´ 1qc ” p ´ 1 pmod pt`1 q and an ě b. Since p ď b, one of the terms
of the numerator anpan ´ 1q ¨ ¨ ¨ pan ´ b ` 1q is an ´ p ` 1, which is divisible by pt`1 . Hence
the p-adic valuation of
` the
˘ numerator
`an˘ is at least t ` 1, but that of the denominator
`an˘ is exactly t.
This means that p | an
,
so
p
∤
´
1.
As
p
|
an
`
1,
we
get
that
an
`
1
∤
, so b is not
b
b
b
a-good.
On the other hand, if for all primes p ď b we have p | a, then every factor of b! is coprime
to an ` 1, and hence invertible modulo an ` 1: hence b! is also invertible modulo an ` 1. Then
equation (1) reduces to:
anpan ´ 1q ¨ ¨ ¨ pan ´ b ` 1q ” b!

pmod an ` 1q.

However, we can rewrite the left-hand side as follows:
anpan ´ 1q ¨ ¨ ¨ pan ´ b ` 1q ” p´1qp´2q ¨ ¨ ¨ p´bq ” p´1qb b!

pmod an ` 1q.

Provided that an ą 1, if b is even we deduce p´1qb b! ” b! as needed. On the other hand, if b is
odd, and we take an ` 1 ą 2pb!q, then we will not have p´1qb b! ” b!, so b is not a-good. This
completes the claim.
To conclude from here, suppose that b is a-good, but b ` 2 is not. Then b is even, and p | a
for all primes p ď b, but there is a prime q ď b ` 2 for which q ∤ a: so q “ b ` 1 or q “ b ` 2.
We cannot have q “ b ` 2, as that is even too, so we have q “ b ` 1: in other words, b ` 1 is
prime.
Solution 2. We show only half of the claim of the previous solution: we show that if b is
a-good, then p | a for all primes p ď b. We do this with Lucas’ theorem.
Suppose that we have p ď b with p ∤ a. Then consider the expansion of b in base p; there
will be some digit (not the ﬁnal digit) which is nonzero, because p ď b. Suppose it is the pt digit
for t ě 1.
Now, as n varies over the integers, an ` 1 runs over all residue classes modulo pt`1 ; in
particular, there is a choice of n (with an ą b) such that the p0 `digit
˘ of an is p ´ 1 (so
an
t
p | an `` 1)
˘ and the p digit of an is 0. Consequently, p | an ` 1 but p | b (by Lucas’ theorem)
so p ∤ an
´ 1. Thus b is not a-good.
b
Now we show directly that if b is a-good but b ` 2 fails to be so, then there must be a prime
` an ˘
dividing an ` 1 for some n, which also divides pb ` 1qpb ` 2q. Indeed, the ratio between b`2
` ˘
and an
is pb ` 1qpb ` 2q{pan ´ bqpan ´ b ´ 1q. We know that there must be a choice of an ` 1
b
such that the former binomial coeﬃcient is 1 modulo an ` 1 but the latter is not, which means
that the given ratio must not be 1 mod an` 1. If b` 1 and b` 2 are both coprime to an` 1 then

Shortlisted problems – solutions

95

the ratio is 1, so that must not be the case. In particular, as any prime less than b divides a,
it must be the case that either b ` 1 or b ` 2 is prime.
However, we can observe that b must be` even
that an ` 1 is prime (which is
˘ by insisting
an
b
possible by Dirichlet’s theorem) and hence b ” p´1q “ 1. Thus b ` 2 cannot be prime, so
b ` 1 must be prime.

96

Bath — UK, 11th–22nd July 2019

X? \
(
Let H “ i 2 : i P Zą0 “ t1, 2, 4, 5, 7, . . .u, and let n be a positive?integer. Prove
that there exists a constant C such that, if A Ă t1, 2, . . . , nu satisﬁes |A| ě C n, then there
exist a, b P A such that a ´ b P H. (Here Zą0 is the set of positive integers, and tzu denotes the
greatest integer less than or equal to z.)
(Brazil)

N6.

Common remarks. In all solutions, we will
? assume that A is a set such that ta ´ b : a, b P Au
is disjoint from H, and prove that |A| ă C n.
Solution 1. First, observe that if n is a positive integer, then n P H exactly when
"
*
n
1
?
ą1´ ? .
(1)
2
2
?
To see why,
?observe?that n P H if and only if 0 ă i 2 ´ n ă 1 for some i P Zą0 . In other words,
0 ă i ´ n{ 2 ă 1{ 2, which is equivalent to (1).
Now, write A “ ta1 ă a2 ă ¨ ¨ ¨ ă ak u, where k “ |A|. Observe that the set of diﬀerences is
not altered by shifting A, so we?may assume ?
that A Ď t0, 1, . . . , n ´ 1u with a1 “ 0.
that
ta
{
2u
ă
1
´
1{
2 for each i ą 1 since ai ´ a1 R H. Furthermore,
From (1), we learn
i
?
?
we must have tai { 2u ă taj { 2u whenever i ă j; otherwise, we would have
˙ "
* "
*
ˆ
aj
ai
1
ă ?
´ ?
ă 0.
´ 1´ ?
2
2
2
?
?
?
?
?
Since ?
tpaj ´ ai q{ 2u “ taj { 2u ´ tai { 2u ` 1, this implies that tpaj ´ ai q{ 2u ą 1{ 2 ą
1 ´ 1{ 2, contradicting (1).
Now, we have a sequence 0 “ a1 ă a2 ă ¨ ¨ ¨ ă ak ă n, with
* "
*
"
*
"
1
a2
ak
a1
ă ?
ă ¨¨¨ ă ?
ă1´ ? .
0“ ?
2
2
2
2
We use the following fact: for any d P Z, we have
"
*
d
1
?
ą ? .
(2)
2
2d 2
? (
?
X ? \
To see why this is the case, let h “ d{ 2 , so d{ 2 “ d{ 2 ´ h. Then
*ˆ
˙
"
d
d2 ´ 2h2
1
d
?
? `h “
ě ,
2
2
2
2
?
?
inequality (2) follows.
since the numerator is a positive integer. Because?d{ 2 ` h?ă 2d{ 2, ?
Let di “ ai`1 ´ ai , for 1 ď i ă k. Then tai`1 { 2u ´ tai { 2u “ tdi { 2u, and we have
ÿ " di *
1 ÿ 1
1
pk ´ 1q2 1
pk ´ 1q2 1
? ř
?
?
ą ?
¨ .
1´ ? ą
ě
(3)
ą
d
n
d
2
2
2
2
2
2
2
2
i
i
i
i
i
?
?
Here, the ﬁrst inequality holds because tak { 2u ă 1 ´ 1{ 2, the second follows from (2), the
third follows from an easy application
ř of the AM–HM inequality (or Cauchy–Schwarz), and the
fourth follows from the fact that i di “ ak ă n.
Rearranging this, we obtain
b ?
?
2 2 ´ 2 ¨ n ą k ´ 1,
which provides the required bound on k.

Shortlisted problems – solutions

97

?
?
(
Solution 2. Let α “ 2 ` 2, so p1{αq ` p1{ 2q “ 1. Thus, J “ tiαu : i P Zą0 is the
complementary Beatty sequence to H (in other words, H and J are disjoint with H Y J “ Zą0 ).
Write A “ ta1 ă a2 ă ¨ ¨ ¨ ă ak u. Suppose that A has no diﬀerences in H, so all its diﬀerences
are in J and we can set ai ´ a1 “ tαbi u for bi P Zą0 .
For any j ą i, we have aj ´ai “ tαbj u´tαbi u. Because aj ´ai P J, we also have aj ´ai “ tαtu
for some positive integer t. Thus, tαtu “ tαbj u ´ tαbi u. The right hand side must equal either
tαpbj ´ bi qu or tαpbj ´ bi qu ´ 1, the latter of which is not a member of J as α ą 2. Therefore,
t “ bj ´ bi and so we have tαbj u ´ tαbi u “ tαpbj ´ bi qu.
For 1 ď i ă k we now put di “ bi`1 ´ bi , and we have
[
_
ÿ
ÿ
α di “ tαbk u “
tαdi u ;
i

that is,

so

ř

ř

i tαdi u ă 1. We also have

[

1` α

ÿ
i

i

_

di “ 1 ` ak ´ a1 ď ak ď n

i di ď n{α.

? the
?With the above
? inequalities, an argument similar to (3)
` (which2 uses
˘ fact that tαdu “
td 2u ą 1{p2d 2q for positive integers d) proves that 1 ą pk ´ 1q {p2 2q pα{nq, which again
rearranges to give
b ?
?
2 2 ´ 2 ¨ n ą k ´ 1.
Comment. The use of Beatty
? sequences in Solution 2 is essentially a way to bypass (1).?Both Solutions
1 and 2 use the fact that 2 ă 2; the statement in the question would still be true if 2 did not have
this property (for instance, if it were replaced with α), but any argument along the lines of Solutions
1 or 2 would be more complicated.

Solution 3. Again, deﬁne J “ Zą0 z H, so all diﬀerences between elements of A are in J. We
start by making the following observation. Suppose we have a set B Ď t1, 2, . . . , nu such that
all of the diﬀerences between elements of B are in H. Then |A| ¨ |B| ď 2n.
To see why, observe that any two sums of the form a ` b with a P A, b P B are diﬀerent;
otherwise, we would have a1 ` b1 “ a2 ` b2 , and so |a1 ´ a2 | “ |b2 ´ b1 |. However, then the left
hand side is in J whereas the right hand side is in H. Thus, ta ` b : a P A, b P Bu is a set of
size |A| ¨ |B| all of whose elements are no greater than 2n, yielding the claimed inequality.
With this in mind, it
? suﬃces to construct a1 set B, all of whose diﬀerences are in H and
1
whose size is at least C n for some constant C ą 0.
To do so, we will use well-known facts about the negative Pell equation X 2 ´ 2Y 2 “ ´1;
in particular, that there are inﬁnitely many solutions and the values of X are given by the
recurrence X1?“ 1, X2 “ 7 ?
and Xm “ 6Xm´1 ´ Xm´2 . Therefore, we may choose X to be a
solution with n{6 ă X ď n.
?
Now, we claim that we may choose B “ tX, 2X, . . . , tp1{3q nuXu. Indeed, we have
ˆ
˙ˆ
˙
X
´1
X
? ´Y
? `Y “
2
2
2
and so

ˆ

˙
X
´3
0ą ? ´Y ě ? ,
2
2n
?
?
from which it follows that tX{ 2u ą 1 ´ p3{ 2nq. Combined with (1), this shows that all
diﬀerences between elements of B are in H.

98

Bath — UK, 11th–22nd July 2019

a ?
Comment. Some of the ideas behind Solution 3 may be used to prove that the constant C “ 2 2 ´ 2
(from Solutions 1 and 2) is optimal, in the sense that there are arbitrarily large values of n and sets
?
An Ď t1, 2, . . . , nu of size roughly C n, all of whose differences are contained in J.
To
to?
the Pell equation X 2 ´2Y 2 “ 1,?so
? see why, choose
? X to come from a sufficiently large solution
?
tX{ 2u « 1{p2X 2q. In particular, tXu, t2Xu, . . . , tt2X 2p1 ´ ?
1{ 2quXu?are all less than 1 ´ 1{ 2.
positive integer
of the form iX for 1 ď i ď t2X 2p1 ´ 1{? 2qu lies in
Thus, by (1) any ?
?
? J.
Set n «?2X 2 2p1?´ 1{ 2q. We now have a set A “ tiX : i ď t2X 2p1 ´ 1{ 2quu containing
roughly 2X 2p1 ´ 1{ 2q elements lessathan or equal to n such that all of the differences lie in J, and
?
?
we can see that |A| « C n with C “ 2 2 ´ 2.

Solution 4. As in Solution 3, we will provide a construction of a large set B Ď t1, 2, . . . , nu,
all of whose diﬀerences are in H.
Choose Y to be a solution to the Pell-like equation X 2 ´ 2Y 2 “ ˘1; such solutions are given
by the
? recurrence Y?1 “ 1, Y2 “ 2 and Ym “ 2Ym´1 ` Ym´2 , and so we can choose Y such that
n{p3 2q ă Y ď n{ 2. Furthermore, it is known that for such a Y and for 1 ď x ă Y ,
?
?
?
tx 2u ` tpY ´ xq 2u “ tY { 2u
(4)
if X 2 ´ 2Y 2 “ 1, and

?
?
?
tx 2u ` tpY ´ xq 2u “ 1 ` tY { 2u

(5)

2
if X 2 ´ 2Y ?
“ ´1. Indeed, this is a statement of the fact that X{Y is a best rational approximation to 2, from below in the ?
ﬁrst case
in the second.
? and from above ?
Now, consider the sequence t 2u, t2 2u, . . . , tpY ´ 1q 2u. The Erdős–Szekeres
theorem
?
?
tells us that this sequence has a monotone subsequence with at least Y ´ 2 ` 1 ą Y
elements; if that subsequence is decreasing,
we?may reﬂect?(using (4) or
? (5)) to ensure that it
?
for t ą Y .
is increasing. Call the ?
subsequence ty1 2u, ty2 2u, . . .?, tyt 2u ?
?
Now, set B “ ttyi 2u : 1 ď i ď tu. We have tyj 2u ´ tyi 2u “ tpyj ´ yi q 2u for i ă j
(because the
? corresponding inequality for the fractional parts holds by the ordering assumption
on the tyi 2u), which
means that all diﬀerences between elements of B are indeed in H. Since
?
? a ?
|B| ą Y ą n{ 3 2, this is the required set.

?
Comment. Any solution to this problem will need to use the fact that 2 cannot be approximated
well by rationals, either
directly or implicitly (for example, by using facts about solutions to Pell?
like equations). If 2 were replaced by a value of θ with very good rational approximations (from
below), then an argument along the lines of Solution 3 would give long arithmetic progressions in
ttiθu : 0 ď i ă nu (with initial term 0) for certain values of n.

Shortlisted problems – solutions

99

N7.

Prove that there is a constant c ą 0 and inﬁnitely many positive integers n with the
following property: there are inﬁnitely many positive integers that cannot be expressed as the
sum of fewer than cn logpnq pairwise coprime nth powers.
(Canada)
Solution 1. Suppose, for an integer n, that we can ﬁnd another integer N satisfying the
following property:
n is divisible by ϕppe q for every prime power pe exactly dividing N.

(:)

This property ensures that all nth powers are congruent to 0 or 1 modulo each such prime
power pe , and hence that any sum of m pairwise coprime nth powers is congruent to m or m ´ 1
modulo pe , since at most one of the nth powers is divisible by p. Thus, if k denotes the number
of distinct prime factors of N, we ﬁnd by the Chinese Remainder Theorem at most 2k m residue
classes modulo N which are sums of at most m pairwise coprime nth powers. In particular, if
N ą 2k m then there are inﬁnitely many positive integers not expressible as a sum of at most
m pairwise coprime nth powers.
It thus suﬃces to prove that there are arbitrarily large pairs pn, Nq of integers satisfying (:)
such that
N ą c ¨ 2k n logpnq
for some positive constant c.
We construct such pairs as follows. Fix a positive integer t and choose (distinct) prime
t´1
t
numbers p | 22 ` 1 and q | 22 ` 1; we set N “ pq. It is well-known that 2t | p ´ 1 and
2t`1 | q ´ 1, hence
pp ´ 1qpq ´ 1q
n“
2t
is an integer and the pair pn, Nq satisﬁes (:).
Estimating the size of N and n is now straightforward. We have
log2 pnq ď 2t´1 ` 2t ´ t ă 2t`1 ă 2 ¨

N
,
n

which rearranges to
Ną

1 2
¨ 2 n log2 pnq
8

1
« 0.18.
and so we are done if we choose c ă 8 logp2q

Comment 1. The trick in the above solution was to find prime numbers p and q congruent to 1
modulo some d “ 2t and which are not too large. An alternative way to do this is via Linnik’s Theorem,
which says that there are absolute constants b and L ą 1 such that for any coprime integers a and d,
there is a prime congruent to a modulo d and of size ď bdL . If we choose some d not divisible by 3 and
choose two distinct primes p, q ď b ¨ p3dqL congruent to 1 modulo d (and, say, distinct modulo 3), then
. A straightforward computation
we obtain a pair pn, N q satisfying (:) with N “ pq and n “ pp´1qpq´1q
d
shows that
1
N ą Cn1` 2L´1
for some constant C, which is in particular larger than any c¨22 n logpnq for p large. Thus, the statement
of the problem is true for any constant c. More strongly, the statement of the problem is still true
when cn logpnq is replaced by n1`δ for a sufficiently small δ ą 0.

100

Bath — UK, 11th–22nd July 2019

Solution 2, obtaining better bounds. As in the preceding solution, we seek arbitrarily
large pairs of integers n and N satisfying (:) such that N ą c2k n logpnq.
This time, to construct such pairs, we ﬁx an integer x ě 4, set N to be the lowest common
multiple of 1, 2, . . . , 2x, and set n to be twice the lowest common multiple of 1, 2, . . . , x. The
pair pn, Nq does indeed satisfy the condition, since if pe is a prime power divisor of N then
ϕppe q
ď x is a factor of n2 “ lcmrďx prq.
2
Now 2N{n is the product of all primes having a power lying in the interval px, 2xs, and
hence 2N{n ą xπp2xq´πpxq . Thus for suﬃciently large x we have
ˆ
˙
2N
log
ą pπp2xq ´ πpxqq logpxq ´ logp2qπp2xq „ x,
2πp2xq n
using the Prime Number Theorem πptq „ t{ logptq.
On the other hand, n is a product of at most πpxq prime powers less than or equal to x,
and so we have the upper bound
logpnq ď πpxq logpxq „ x,
again by the Prime Number Theorem. Combined with the above inequality, we ﬁnd that for
any ǫ ą 0, the inequality
ˆ
˙
N
log
ą p1 ´ ǫq logpnq
2πp2xq n
holds for suﬃciently large x. Rearranging this shows that
N ą 2πp2xq n2´ǫ ą 2πp2xq n logpnq
for all suﬃciently large x and we are done.
Comment 2. The stronger bound N ą 2πp2xq n2´ǫ obtained in the above proof of course shows
that infinitely many positive integers cannot be written as a sum of at most n2´ǫ pairwise coprime
nth powers.
By refining the method in Solution 2, these bounds can be improved further to show that infinitely
many positive integers cannot be written as a sum of at most nα pairwise coprime nth powers for any
positive α ą 0. To do this, one fixes a positive integer d, sets N equal to the product of the primes
at most dx which are congruent to 1 modulo d, and n “ d lcmrďx prq. It follows as in Solution 2 that
pn, N q satisfies (:).
d
Now the Prime Number Theorem in arithmetic progressions provides the estimates logpN q „ ϕpdq
x,

dx
for any fixed d. Combining these provides a bound
logpnq „ x and πpdxq „ logpxq

N ą 2πpdxq nd{ϕpdq´ǫ
d
for any positive ǫ, valid for x sufficiently large. Since the ratio ϕpdq
can be made arbitrarily large by a
α
judicious choice of d, we obtain the n bound claimed.

Comment 3. While big results from analytic number theory such as the Prime Number Theorem
or Linnik’s Theorem certainly can be used in this problem, they do not seem to substantially simplify
matters: all known solutions involve first reducing to condition (:), and even then analytic results do
not make it clear how to proceed. For this reason, we regard this problem as suitable for the IMO.
Rather than simplifying the problem, what nonelementary results from analytic number theory
allow one to achieve is a strengthening of the main bound, typically replacing the n logpnq growth with
a power n1`δ . However, we believe that such stronger bounds are unlikely to be found by students in
the exam.
The strongest bound we know how to achieve using purely elementary methods is a bound of the
form N ą 2k n logpnqM for any positive integer M . This is achieved by a variant ofśthe argument
t`i´1
` 1 and setting N “
in Solution
1, choosing primes p0 , . . . , pM with pi | 22
i pi and n “
ś
´tM
2
i ppi ´ 1q.

Shortlisted problems – solutions

N8.

101

Let a and b be two positive integers. Prove that the integer
R 2V
4a
2
a `
b

is not a square. (Here rzs denotes the least integer greater than or equal to z.)
(Russia)
Solution 1. Arguing indirectly, assume that
R 2V
4a
2
a `
“ pa ` kq2 , or
b

R

V
p2aq2
“ p2a ` kqk.
b

Clearly, k ě 1. In other words, the equation
R 2V
c
“ pc ` kqk
b

p1q

has a positive integer solution pc, kq, with an even value of c.
Choose a positive integer solution of p1q with minimal possible value of k, without regard
to the parity of c. From
R 2V
c
c2
´ 1 “ ck ` k 2 ´ 1 ě ck
ą
b
b
and

R 2V
pc ´ kqpc ` kq
c2
c
“ pc ` kqk
ă
ď
b
b
b

it can be seen that c ą bk ą c ´ k, so

c “ kb ` r

with some 0 ă r ă k.

By substituting this in p1q we get
R 2V R
V
R 2V
c
pbk ` rq2
r
2
“
“ k b ` 2kr `
b
b
b
and
pc ` kqk “ pkb ` r ` kqk “ k 2 b ` 2kr ` kpk ´ rq,
so

R 2V
r
“ kpk ´ rq.
b

p2q

Notice that relation p2q provides another positive integer solution of p1q, namely c1 “ r and
k 1 “ k ´ r, with c1 ą 0 and 0 ă k 1 ă k. That contradicts the minimality of k, and hence ﬁnishes
the solution.

102

Bath — UK, 11th–22nd July 2019

Solution 2. Suppose that

with some positive integer c ą a, so

R

V
4a2
a `
“ c2
b
2

4a2
ď c2 ,
b
0 ď c2 b ´ a2 pb ` 4q ă b.
c2 ´ 1 ă a2 `

Let d “ c2 b ´ a2 pb ` 4q, x “ c ` a and y “ c ´ a; then we have c “

p3q can be re-written as follows:

´ x ` y ¯2

b´

(3)
x´y
x`y
and a “
, and
2
2

´ x ´ y ¯2

pb ` 4q “ d,
2
2
x2 ´ pb ` 2qxy ` y 2 ` d “ 0;
0 ď d ă b.

(4)

So, by the indirect assumption, the equation p4q has some positive integer solution px, yq.

Fix b and d, and take a pair px, yq of positive integers, satisfying p4q, such that x ` y is
minimal. By the symmetry in p4q we may assume that x ě y ě 1.
Now we perform a usual “Vieta jump”. Consider p4q as a quadratic equation in variable x,
and let z be its second root. By the Vieta formulas,
x ` z “ pb ` 2qy,

and zx “ y 2 ` d,

so

y2 ` d
.
x
The ﬁrst formula shows that z is an integer, and by the second formula z is positive. Hence
pz, yq is another positive integer solution of p4q. From
z “ pb ` 2qy ´ x “

px ´ 1qpz ´ 1q “ xz ´ px ` zq ` 1 “ py 2 ` dq ´ pb ` 2qy ` 1
ă py 2 ` bq ´ pb ` 2qy ` 1 “ py ´ 1q2 ´ bpy ´ 1q ď py ´ 1q2 ď px ´ 1q2
we can see that z ă x and therefore z ` y ă x ` y. But this contradicts the minimality of x ` y
among the positive integer solutions of p4q.

